{"meta":{"title":"Hexo","subtitle":"","description":"","author":"John Doe","url":"https://marblemm.github.io","root":"/"},"pages":[{"title":"å…³äº","date":"2021-08-08T09:14:53.702Z","updated":"2021-08-08T09:14:53.702Z","comments":false,"path":"about/index.html","permalink":"https://marblemm.github.io/about/index.html","excerpt":"","text":"c++å¼€å‘"},{"title":"åˆ†ç±»","date":"2021-08-08T09:12:54.798Z","updated":"2021-08-01T10:13:30.755Z","comments":false,"path":"categories/index.html","permalink":"https://marblemm.github.io/categories/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2021-08-08T08:54:09.245Z","updated":"2021-08-08T08:54:09.245Z","comments":true,"path":"links/index.html","permalink":"https://marblemm.github.io/links/index.html","excerpt":"","text":""}],"posts":[{"title":"å­—ç¬¦ä¸²BSTR","slug":"å­—ç¬¦ä¸²BSTR","date":"2021-08-29T15:57:04.000Z","updated":"2021-08-30T11:15:41.239Z","comments":true,"path":"2021/08/29/å­—ç¬¦ä¸²BSTR/","link":"","permalink":"https://marblemm.github.io/2021/08/29/%E5%AD%97%E7%AC%A6%E4%B8%B2BSTR/","excerpt":"","text":"BSTRä¸ºä»€ä¹ˆéœ€è¦BSTR COMæ˜¯ä¸€ç§è·¨ç¼–ç¨‹è¯­è¨€çš„å¹³å°ï¼Œéœ€è¦æä¾›è¯­è¨€æ— å…³çš„æ•°æ®ç±»å‹ã€‚å¤šæ•°ç¼–ç¨‹è¯­è¨€æœ‰è‡ªå·±çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ C++ å­—ç¬¦ä¸²æ˜¯ä»¥0ç»“æŸçš„ASCIIæˆ–Unicodeå­—ç¬¦æ•°ç»„ã€‚ Visual Basicå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªASCIIå­—ç¬¦æ•°ç»„åŠ ä¸Šè¡¨ç¤ºé•¿åº¦çš„å‰ç¼€ã€‚ Javaå­—ç¬¦ä¸²æ˜¯ä»¥0ç»“æŸçš„Unicodeå­—ç¬¦æ•°ç»„ã€‚ éœ€è¦å®šä¹‰ä¸€ç§é€šç”¨çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„åŒ¹é…åˆ°ä¸åŒç¼–ç¨‹è¯­è¨€ã€‚åœ¨C++ä¸­ï¼Œå°±æ˜¯BSTRã€‚ ä»€ä¹ˆæ˜¯BSTR BSTRæ˜¯â€œBasic STRingâ€çš„ç®€ç§°ï¼Œå¾®è½¯åœ¨COM/OLEä¸­å®šä¹‰çš„æ ‡å‡†å­—ç¬¦ä¸²æ•°æ®ç±»å‹ã€‚ å¯¹äºC++ï¼ŒWindowså¤´æ–‡ä»¶wtypes.hä¸­å®šä¹‰å¦‚ä¸‹ï¼š typedef wchar_t WCHAR; typedef WCHAR OLECHAR; typedef OLECHAR __RPC_FAR *BSTR;; ä½¿ç”¨ä»¥Nullç»“å°¾çš„ç®€å•å­—ç¬¦ä¸²åœ¨COM componenté—´ä¼ é€’ä¸å¤ªæ–¹ä¾¿ã€‚å› æ­¤ï¼Œæ ‡å‡†BSTRæ˜¯ä¸€ä¸ªæœ‰é•¿åº¦å‰ç¼€å’Œnullç»“æŸç¬¦çš„OLECHARæ•°ç»„ã€‚BSTRçš„å‰4å­—èŠ‚æ˜¯ä¸€ä¸ªè¡¨ç¤ºå­—ç¬¦ä¸²é•¿åº¦çš„å‰ç¼€ã€‚BSTRé•¿åº¦åŸŸçš„å€¼æ˜¯å­—ç¬¦ä¸²çš„å­—èŠ‚æ•°ï¼Œå¹¶ä¸”ä¸åŒ…æ‹¬0ç»“æŸç¬¦ã€‚ ç”±äºæ˜¯Unicodeä¸²ï¼Œæ‰€ä»¥å­—ç¬¦æ•°æ˜¯å­—èŠ‚æ•°çš„ä¸€åŠã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å…è®¸ç¨‹åºå‘˜åœ¨BSTRä¸²ä¸­é—´åµŒå…¥NULLå­—ç¬¦ã€‚ä½†æ˜¯ï¼ŒBSTRçš„å‰å››ä¸ªå­—èŠ‚è¡¨ç¤ºé•¿åº¦ï¼Œè€ŒOLECHARæ•°ç»„çš„å‰å››å­—èŠ‚è¡¨ç¤ºå‰ä¸¤ä¸ªå­—ç¬¦ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹äºC++ç¨‹åºï¼Œå¦‚ä½•å®ç°BSTRå’ŒOLECHARçš„äº¤æ¢ï¼Ÿç­”æ¡ˆæ˜¯COMæä¾›äº†ä¸¤ä¸ªBSTRåˆ†é…ç”¨çš„APIï¼šSysAllocString / SysReallocStringã€‚å‡½æ•°è¿”å›çš„æŒ‡é’ˆæŒ‡å‘BSTRçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯BSTRåœ¨å†…å­˜çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ã€‚ BSTRçš„ç‰¹æ®Šæ€§BSTRå­—ç¬¦ä¸²å¯ä»¥å†…åµŒé›¶ä¸ªæˆ–å¤šä¸ªNULLï¼Œå› ä¸ºå†³å®šå…¶é•¿åº¦çš„ä¸æ˜¯NULLï¼Œè€Œæ˜¯å…¶å‰ç¼€ä¿å­˜çš„æ•°å€¼ï¼Œæ‰€ä»¥ä¸èƒ½ä»¥NULLæ¥åˆ¤æ–­å­—ç¬¦ä¸²çš„ç»“æŸã€‚ï¼› å¿…é¡»ç”¨SysAllocString()å’ŒSysFreeStringï¼ˆï¼‰å‡½æ•°æ—æ¥åˆ†é…å’Œé‡Šæ”¾ï¼Œç”¨SysStringLen()ç­‰å–å¾—å­—ç¬¦ä¸²çš„é•¿åº¦ï¼› BSTRç›¸å…³å‡½æ•°æ—å†…å­˜åˆ†é…å’Œé‡åˆ†é…å‡½æ•° SysAllocString SysAllocStringLen SysAllocStringByteLen SysReAllocString SysReAllocStringLen æ³¨ï¼šé€šè¿‡ä»¥ä¸Šå‡½æ•°åˆ†é…ç©ºé—´çš„åŒæ—¶å°†æ ¹æ®å­—ç¬¦ä¸²å®é™…å ç”¨çš„å­—èŠ‚æ•°å¡«å†™å‰ç¼€ å­—ç¬¦ä¸²é‡Šæ”¾å‡½æ•° SysFreeString æ³¨ï¼šè¿™ä¸ªå‡½æ•°çš„å‚æ•°å¯ä»¥ä¼ å…¥NULLï¼Œå³åœ¨è°ƒç”¨æ­¤å‡½æ•°æ—¶å¯ä»¥ä¸ç”¨åˆ¤æ–­å‚æ•°æ˜¯å¦ä¸ºNULL å­—ç¬¦ä¸²ï¼ˆå ç”¨ç©ºé—´ï¼‰é•¿åº¦å‡½æ•° SysStringLen SysStringByteLen å¦‚ä½•é¿å…BSTRé€ æˆçš„å†…å­˜æ³„æ¼ å¯¹äºBSTRçš„ç®¡ç†ï¼ˆç”³è¯·ã€é‡Šæ”¾å’Œè®¡ç®—é•¿åº¦ï¼‰ä¸¥æ ¼ä½¿ç”¨ä¸Šè¿°å¯¹åº”çš„å‡½æ•°æ—ï¼Œä¸è¦ä½¿ç”¨newã€deleteã€CoTaskMemAllocã€CoTaskMemFreeã€sizeof ç­‰ã€‚ ä¸è¦åœ¨BSTRå­—ç¬¦ä¸²ä¸­åµŒå…¥NULL å®šä¹‰BSTRæ—¶è¦èµ‹åˆå€¼NULL BSTR bstr = NULL; è°ƒç”¨SysFreeStringåè¦ç»™bstrèµ‹NULL SysFreeString(bstr)ï¼› bstr = NULL; ä¸è¦ç»™BSTRç›´æ¥åˆå§‹åŒ–å­—ç¬¦ä¸² BSTR bstr = Lâ€œkkkkkkâ€;//BSTR bstr = SysAllocString (Lâ€œkkkkkkâ€); å› ä¸ºç›´æ¥åˆå§‹åŒ–å­—ç¬¦ä¸²æ—¶å‰ç¼€çš„å€¼å¯èƒ½æ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œè¿™æ ·çš„è¯ï¼Œå…¶ä»–åœ°æ–¹ä½¿ç”¨è¿™ä¸ªBSTRæ—¶å°†æ— æ³•å†³å®šå‡ºå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç‰¹åˆ«åœ¨è·¨è¿›ç¨‹ä¼ é€æ•°æ®æ—¶å°†ä¼šå‡ºç°è‡´å‘½é”™è¯¯ã€‚ åœ¨ç»™ä¸€ä¸ªBSTRèµ‹å€¼å‰ï¼Œå¦‚æœä¸èƒ½ç¡®å®šå®ƒç›®å‰æ˜¯å¦æŒ‡å‘ä¸€ä¸ªæœ‰æ•ˆçš„ç©ºé—´ï¼Œæœ€å¥½å…ˆè°ƒä¸€ä¸‹SysFreeStringï¼Œå¦‚ï¼š SysFreeStringï¼ˆbstrï¼‰; bstr = SysAllocString(Lâ€œkkkkkkâ€); ä¸è¦å°†ä¸€ä¸ªBSTRé€šè¿‡â€œ=â€èµ‹ç»™å¦ä¸€ä¸ªBSTR bstr1 = bstr2;//bstr1 = SysAllocString(bstr2); é¿å…è°ƒç”¨SysFreeStringï¼ˆbstr1ï¼‰å’ŒSysFreeStringï¼ˆbstr2ï¼‰å¯¹åŒä¸€å—å†…å­˜ç©ºé—´é‡Šæ”¾ä¸¤æ¬¡ã€‚ å‚æ•°ä¸º[out]çš„BSTRæ³¨æ„ç‚¹æ¯”å¦‚å‡½æ•°GetBSTR([out] BSTR* bstr) å¯¹äºå®¢æˆ·ç«¯ BSTR bstr = NULLï¼›// ä¼ å…¥çš„bstrå¿…é¡»ä¸ºNULL GetBSTR(&amp;bstr); ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ SysFreeStringï¼ˆbstrï¼‰ï¼›// ä½¿ç”¨å®Œbstrååˆ«å¿˜äº†é‡Šæ”¾ bstr = NULL; å¯¹äºæœåŠ¡ç«¯ HRESULT GetBSTR(BSTR* bstr) &#123; // ä¸€èˆ¬æ¥è¯´ï¼Œä¼ å…¥çš„bsträ¸æŒ‡å‘ä»»ä½•ç©ºé—´åº”è¯¥ç”±å®¢æˆ·ç«¯ä¿è¯çš„ï¼Œæ‰€ä»¥ä¸‹é¢çš„åˆ¤æ–­å’Œé‡Šæ”¾ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æœ‰çš„è¯å¯èƒ½æ›´å®‰å…¨ã€‚ if ( NULL != *bstr ) SysFreeStringï¼ˆ*bstrï¼‰ï¼› // åˆ›å»ºæˆå‘˜å˜é‡çš„æ‹·è´ï¼Œä¸è¦å°†å…¶å€¼ç›´æ¥ç»™å‡ºå»ï¼ˆç‰¹åˆ«å¯¹äºè¿›ç¨‹å†…ç»„ä»¶ï¼‰ *bstr = m_bstr;// *bstr = SysAllocString( m_str ); &#125; å‚æ•°ä¸º[in]çš„BSTRæ³¨æ„ç‚¹HRESULT SetBSTR(/*[in]*/ BSTR bstr)&#123; // å¦‚æœæœåŠ¡å™¨éœ€è¦ä¿å­˜ä¼ å…¥çš„bsträ¾›ä»¥åä½¿ç”¨ï¼Œå¿…é¡»å°†æˆå‘˜å˜é‡é‡Šæ”¾ï¼Œç„¶åé‡æ–°åˆ†é…ã€‚ SysFreeString(m_bstr); m_bstr = bstr; // m_bstr = SysAllocString( bstr ); &#125; å‚æ•°ä¸º[out]çš„æ•°æ®ç»“æ„ä¸­åŒ…å«BSTRçš„æ³¨æ„ç‚¹typedef struct kk&#123; long i; BSTR bstr; &#125; KK; KK param; param.bstr = NULL; GetKK(&amp;param); ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ SysFreeStringï¼ˆparam .bstrï¼‰ï¼›// è¿™ç§å†…åµŒåœ¨ç»“æ„ä½“å†…çš„BSTRéå¸¸å®¹æ˜“å¿½ç•¥é‡Šæ”¾ param .bstr = NULL; BSTRä½œä¸ºSysAllocStringæˆ–SysReAllocStringçš„å‚æ•°æ—¶çš„æ³¨æ„ç‚¹å¦‚æœbsträ½œä¸ºSysAllocStringæˆ–SysReAllocStringçš„å‚æ•°ä¼ å…¥ï¼Œå¹¶ä¸”ä¸ç¡®å®šè¿™ä¸ªä¼ å…¥çš„bstræ˜¯å¦åŒ…å«å†…åµŒNULLæ—¶ï¼Œä¸ºä¿é™©èµ·è§ï¼Œè¯·åŠ¡å¿…æ”¹ç”¨ä¸‹é¢ä¸¤å‡½æ•°ã€‚ SysAllocStringLen SysReAllocStringLen åŸå› ï¼šå› ä¸ºä¸Šè¿°4ä¸ªå‡½æ•°çš„å‚æ•°ç±»å‹éƒ½æ˜¯OLECHAR FAR* è€Œä¸æ˜¯BSTRï¼Œä½†åä¸¤ä¸ªå‡½æ•°å¤šäº†ä¼ å…¥æ•°é‡çš„å‚æ•°ã€‚ BSTRçš„ATLå°è£…ç±»CCOMBSTR å»ºè®®ï¼šå¿…é¡»åœ¨éå¸¸æ¸…æ¥šCComBSTRå„ä¸ªå‡½æ•°ï¼ˆç‰¹åˆ«æ˜¯èµ‹å€¼æ“ä½œç¬¦å’Œæ„é€ å‡½æ•°ï¼‰å¦‚ä½•ä½¿ç”¨å’Œæ³¨æ„äº‹é¡¹çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨å®ƒï¼Œå¦åˆ™å»ºè®®ä½¿ç”¨BSTRï¼Œå› ä¸ºä½¿ç”¨ä¸æ…éå¸¸å®¹æ˜“é€ æˆå†…å­˜æ³„æ¼ã€‚ BSTRæ˜¯ä¸€ä¸ªå¸¦é•¿åº¦å‰ç¼€çš„å­—ç¬¦ä¸²,ä¸»è¦ç”±æ“ä½œç³»ç»Ÿæ¥ç®¡ç†çš„,æ‰€ä»¥è¦ç”¨api.ä¸»è¦ç”¨æ¥å’ŒVBæ‰“äº¤é“çš„(VBé‡Œçš„stringå°±æ˜¯æŒ‡å®ƒ)è¦æ“ä½œå®ƒçš„APIå‡½æ•°æœ‰å¾ˆå¤š.æ¯”å¦‚SysAllocString,SysFreeStringç­‰ç­‰. vcé‡Œå°è£…å®ƒçš„ç±»å¦‚_bstr_t,åŠATLä¸­çš„CComBSTRç­‰. ä¸€ä¸ª BSTR ç”±å¤´éƒ¨å’Œå­—ç¬¦ä¸²ç»„æˆï¼Œå¤´éƒ¨åŒ…å«äº†å­—ç¬¦ä¸²çš„é•¿åº¦ä¿¡æ¯ï¼Œå­—ç¬¦ä¸²ä¸­å¯ä»¥åŒ…å«åµŒå…¥çš„ null å€¼ã€‚ BSTR æ˜¯ä»¥æŒ‡é’ˆçš„å½¢å¼è¿›è¡Œä¼ é€’çš„ã€‚(æŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼ŒåŒ…å«å¦å¤–ä¸€ä¸ªå˜é‡çš„å†…å­˜åœ°å€ï¼Œè€Œä¸æ˜¯æ•°æ®ã€‚) BSTR æ˜¯ Unicode çš„ï¼Œå³æ¯ä¸ªå­—ç¬¦éœ€è¦ä¸¤ä¸ªå­—èŠ‚ã€‚ BSTR é€šå¸¸ä»¥ä¸¤å­—èŠ‚çš„ null å­—ç¬¦ç»“æŸã€‚ wstræ˜¯å®½å­—ç¬¦ï¼Œä»¥åŒå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ bstræ˜¯ä¸ºäº†ä¸åŸå…ˆçš„basicå­—ç¬¦å…¼å®¹ï¼Œå®ƒçš„æœ€å‰é¢çš„4ä¸ªå­—èŠ‚ä¸ºå…¶é•¿åº¦ï¼Œä»¥â€™\\0â€™ç»“æŸ. ATLåŸºç¡€BSTR CComBSTR SysAllocStringATLæä¾›äº† BSTR å’Œ CComBSTR ï¼Œè¿˜æœ‰OLEAUTO32.DLLå¯¼å‡ºä¸€ä¸ªAPIå«SysAllocStringã€‚è¿™äº›ä¸œè¥¿æœ‰ä»€ä¹ˆæ„æ€ï¼Ÿæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ BSTR æ˜¯ä¸€ä¸ªtypedefï¼Œä½ å¯ä»¥ç†è§£ä¸º typedef WCHAR* BSTRå®ƒå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚æ‰€ä»¥ BSTR p = Lâ€helloâ€;ç¼–è¯‘æ˜¯æ²¡é—®é¢˜çš„ã€‚ä¸è¿‡ä¸æ¨èè¿™ä¹ˆåšã€‚å› ä¸ºæŒ‰MSDNï¼ŒBSTRåº”è¯¥åªæ¥æ”¶ SysAllocString çš„è¿”å›å€¼ã€‚ å°±æ˜¯è¯´ï¼Œç¬¬ä¸€ï¼ŒSysAllocString çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª BSTR ç¬¬äºŒï¼Œå¦‚æœæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªBSTRï¼Œé‚£å®ƒåº”è¯¥æ€»ä»ç”±ä¸€ä¸ª SysAllocString å¾—åˆ°çš„ï¼Œå®ƒæ€»æ˜¯åº”è¯¥ç”¨ SysFreeString é‡Šæ”¾ã€‚ æˆ‘ä»¬å¯ä»¥æƒ³åƒï¼ŒSysAllocString å®é™…ä¸Šåšäº†ä¸€ä¸ªmallocåˆ†é…äº†ä¸€å—å†…å­˜ï¼Œç„¶åæŠŠå†…å­˜é•¿åº¦æ”¾ç¬¬ä¸€ä¸ªDWORDï¼ŒæŠŠè¿™ä¸ªDWORDåé¢ä½ç½®ä½œä¸ºBSTRè¿”å›ã€‚å› ä¸ºåœ¨BSTRå‡4çš„ä½ç½®å·²ç»ä¿å­˜äº†å—é•¿åº¦ï¼Œæ‰€ä»¥å¯¹BSTRä¸åº”è¯¥ç”¨ wcslen ä¹‹ç±»çš„æ–¹æ³•æ¥å¾—åˆ°å®ƒçš„é•¿åº¦ï¼Œè¦ç”¨ SysStringLenã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸æ¨èç”¨ BSTR p = Lâ€helloâ€è¿™ç§æ–¹æ³•ç›´æ¥ç»™BSTRèµ‹å€¼ï¼Œå› ä¸ºè¿™æ ·å¾—åˆ°åˆ°BSTRä¸ç¬¦åˆå‡4ä½ç½®æœ‰å—é•¿åº¦çš„è§„èŒƒï¼Œä¹Ÿä¸èƒ½ç”¨ SysStringLen å¾—åˆ°é•¿åº¦ï¼Œä¹Ÿä¸èƒ½ç”¨ SysFreeString æ¥é‡Šæ”¾ã€‚ä¹±äº†è§„çŸ©ã€‚ åˆä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆéœ€è¦ SysAllocString ? æˆ‘ç”¨ new æˆ– malloc ä¸è¡Œå—ï¼Ÿå› ä¸ºç”¨ATLå¸¸å¸¸æ˜¯ä¸ºäº†å†™COMã€‚è€ŒCOMæ§ä»¶æ˜¯è·¨è¯­è¨€çš„ã€‚ä½ ç”¨C++å†™ä¸€ä¸ªCOMæ§ä»¶ï¼Œå¯èƒ½è¢«HTMLä¸­çš„ä¸€ä¸ªVBSCRIPTæˆ–PHPè°ƒç”¨ã€‚ä½ è¿”å›çš„é‚£ä¸ªBSTRå­—ä¸²å¯èƒ½éœ€è¦åœ¨VBSCRIPTä¸­é‡Šæ”¾ã€‚è€Œ new æˆ– malloc ç­‰å¸¸è§„çš„C++åˆ†é…å†…å­˜å‡½æ•°ï¼Œéƒ½è¦æ±‚å†…å­˜åœ¨æœ¬æ¨¡å—å†…é‡Šæ”¾ã€‚æ‰€ä»¥ï¼ŒSysAllocString åˆ†æçš„å†…å­˜ï¼Œæ˜¯ä¸ºäº†æ”¯æŒè·¨æ¨¡å—ä½¿ç”¨ï¼Œå¹¶åœ¨å¤–åœ°freeçš„ã€‚ é‚£ä¹ˆ CComBSTR åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸Šé¢è®²äº†ï¼ŒBSTRåªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒå¤ªç®€å•äº†ã€‚å¦‚æœæˆ‘è¦å®ç°å­—ä¸²æŸ¥æ‰¾ï¼Œå­—ä¸²åˆå¹¶ç­‰å¤æ‚çš„æ“ä½œå°±è¦è‡ªå·±å†™ä»£ç äº†ã€‚äºæ˜¯å°±æœ‰äº† CComBSTRè¿™ä¸ªç±»ã€‚å®ƒåªæœ‰ä¸€ä¸ªæˆå‘˜ BSTR m_str ä½†å®ƒæœ‰å¤§é‡çš„æ–¹æ³•å‡½æ•°ï¼Œè¶³å¤Ÿä½ æ‰€å¯èƒ½éœ€è¦çš„æ‰€æœ‰å­—ä¸²æ“ä½œã€‚ æœ€åç»“è®ºï¼š * BSTR åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè¦å°å¿ƒä½¿ç”¨ï¼Œé™¤äº† SysAllocString ä¸è¦å¯¹å®ƒèµ‹å€¼ã€‚ * å¦‚æœå‘ç°ä¸€ä¸ª BSTRï¼Œ é‚£å®ƒä¸€å®šæ˜¯ç”¨ SysAllocString å¾—åˆ°çš„ã€‚ä¸€å®šè¦ç”¨ SysStringLen æ¥å¾—åˆ°é•¿åº¦ã€‚ä¸€å®šè¦ç”¨ SysFreeString æ¥é‡Šæ”¾å®ƒ * å¦‚æœéœ€è¦å¯¹ BSTR åšå­—ä¸²æ“ä½œï¼ŒæŠŠå®ƒå˜æˆ CComBSTR ï¼Œæ€»æœ‰ä¸€ä¸ªç°æˆçš„å‡½æ•°ç›´æ¥ä½¿ç”¨ã€‚ * è¿™ä¸€ç³»åˆ—ä¸œè¥¿ï¼Œéƒ½æ˜¯ä¸ºäº†COMè·¨æ¨¡å—æŠŠå­—ä¸²å½“ä½œè¿”å›å€¼ä½¿ç”¨çš„ã€‚å¦‚æœä¸€ä¸ªå­—ä¸²åªåœ¨æœ¬æ¨¡å—å†…æœ‰æ•ˆï¼Œè¿˜æ˜¯ç”¨ new æˆ– malloc æˆ– CString æ¥å¾—ç®€å•ã€‚ SysAllocString,SysFreeStringå¤§è‡´ä¼ªé€»è¾‘å¦‚ä¸‹ 1234567891011121314WCHAR* SysAllocString(WCHAR *str)&#123; size_t sz = 4 + wcslen(str)*sizeof(WCHAR); WCHAR *lpstart = malloc(); *(int*)lpstart = sz; wcscpy(lpstart+2,str); return lpstart + 2;&#125;void SysFreeString(WCHAR *str)&#123; str -= 2; free(str);&#125; å‚è€ƒï¼š https://blog.csdn.net/shihuaguo/article/details/8541172 https://bbs.pediy.com/thread-125705.htm https://www.cnblogs.com/qinfengxiaoyue/p/3428540.html https://blog.csdn.net/weixin_30478757/article/details/97589060","categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"}],"tags":[]},{"title":"cpp11è®¡æ—¶å™¨-chrono","slug":"cpp11è®¡æ—¶å™¨-chrono","date":"2021-08-23T15:21:16.000Z","updated":"2021-08-23T15:55:27.187Z","comments":true,"path":"2021/08/23/cpp11è®¡æ—¶å™¨-chrono/","link":"","permalink":"https://marblemm.github.io/2021/08/23/cpp11%E8%AE%A1%E6%97%B6%E5%99%A8-chrono/","excerpt":"","text":"è®¡æ—¶æœ‰å¾ˆå¤šç”¨é€”ï¼Œæ¯”å¦‚ï¼šæµ‹è¯•æŸä¸€æ®µä»£ç çš„è¿è¡Œæ—¶é—´ï¼Œæ—¶é—´è¶ŠçŸ­ï¼Œåˆ™æ€§èƒ½ç›¸å¯¹è¶Šé«˜ã€‚è®¡æ—¶æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæˆ‘å°†é¦–å…ˆç»™å‡ºæˆ‘ä»¥å‰å¸¸ç”¨çš„ä¸€ç§è®¡æ—¶æ–¹æ³•ï¼Œç„¶åç»™å‡ºæˆ‘è®¤ä¸ºçš„æœ€ä½³æ–¹æ³•ï¼ˆé‡‡ç”¨äº†C++11çš„æ ‡å‡†æŠ€æœ¯ï¼‰ã€‚ é¦–å…ˆç»™å‡ºæˆ‘ä»¥å‰å¸¸ç”¨çš„ä¸€ç§â€œä¼ ç»Ÿâ€çš„è®¡æ—¶æ–¹æ³•ï¼š 12345678910111213#include &lt;ctime&gt;#include &lt;iostream&gt;using namespace std;int main()&#123; clock_t start = clock(); // do something... clock_t end = clock(); cout &lt;&lt; &quot;èŠ±è´¹äº†&quot; &lt;&lt; (double)(end - start) / CLOCKS_PER_SEC &lt;&lt; &quot;ç§’&quot; &lt;&lt; endl;&#125; æ­¤æ–¹æ³•å¯ä»¥ç²¾ç¡®åˆ°æ¯«ç§’ï¼Œè¾“å‡ºæ ·ä¾‹ï¼šèŠ±è´¹äº†0.123ç§’ c++11è®¡æ—¶å™¨C++11æœ‰äº†chronoåº“ï¼Œå¯ä»¥åœ¨ä¸åŒç³»ç»Ÿä¸­å¾ˆå®¹æ˜“çš„å®ç°å®šæ—¶åŠŸèƒ½ã€‚ è¦ä½¿ç”¨chronoåº“ï¼Œéœ€è¦#includeï¼Œå…¶æ‰€æœ‰å®ç°å‡åœ¨std::chrono namespaceä¸‹ã€‚æ³¨æ„æ ‡å‡†åº“é‡Œé¢çš„æ¯ä¸ªå‘½åç©ºé—´ä»£è¡¨äº†ä¸€ä¸ªç‹¬ç«‹çš„æ¦‚å¿µã€‚ chronoæ˜¯ä¸€ä¸ªæ¨¡ç‰ˆåº“ï¼Œä½¿ç”¨ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œåªéœ€è¦ç†è§£ä¸‰ä¸ªæ¦‚å¿µï¼šdurationã€time_pointã€clock æ—¶é’Ÿchronoåº“å®šä¹‰äº†ä¸‰ç§ä¸åŒçš„æ—¶é’Ÿ: std::chrono::system_clock: ä¾æ®ç³»ç»Ÿçš„å½“å‰æ—¶é—´ (ä¸ç¨³å®š) std::chrono::steady_clock: ä»¥ç»Ÿä¸€çš„é€Ÿç‡è¿è¡Œ(ä¸èƒ½è¢«è°ƒæ•´) std::chrono::high_resolution_clock: æä¾›æœ€é«˜ç²¾åº¦çš„è®¡æ—¶å‘¨æœŸ(å¯èƒ½æ˜¯steady_clockæˆ–è€…system_clockçš„typedef) system_clockå°±ç±»ä¼¼Windowsç³»ç»Ÿå³ä¸‹è§’é‚£ä¸ªæ—¶é’Ÿï¼Œæ˜¯ç³»ç»Ÿæ—¶é—´ã€‚æ˜æ˜¾é‚£ä¸ªæ—¶é’Ÿæ˜¯å¯ä»¥ä¹±è®¾ç½®çš„ã€‚æ˜æ˜æ˜¯æ—©ä¸Š10ç‚¹ï¼Œå´å¯ä»¥è®¾ç½®æˆä¸‹åˆ3ç‚¹ã€‚ steady_clockåˆ™é’ˆå¯¹system_clockå¯ä»¥éšæ„è®¾ç½®è¿™ä¸ªç¼ºé™·è€Œæå‡ºæ¥çš„ï¼Œä»–è¡¨ç¤ºæ—¶é’Ÿæ˜¯ä¸èƒ½è®¾ç½®çš„ã€‚ high_resolution_clockåˆ™æ˜¯ä¸€ä¸ªé«˜åˆ†è¾¨ç‡æ—¶é’Ÿã€‚ è¿™ä¸‰ä¸ªæ—¶é’Ÿç±»éƒ½æä¾›äº†ä¸€ä¸ªé™æ€æˆå‘˜å‡½æ•°now()ç”¨äºè·å–å½“å‰æ—¶é—´ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªtime_pointç±»å‹ï¼Œ æ—¶é—´ç²¾åº¦å…¶å®ä¹Ÿå°±æ˜¯æ—¶é—´åˆ†è¾¨ç‡ã€‚æŠ›å¼€æ—¶é—´é‡çº²å•è®ºåˆ†è¾¨ç‡ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæ¯”ç‡ã€‚å¦‚ï¼š1000110001ã€101101ã€1111 ã€110110ã€1100011000ã€‚è¿™äº›æ¯”ç‡åŠ ä¸Šè·ç¦»é‡çº²å°±å˜æˆè·ç¦»åˆ†è¾¨ç‡ï¼ŒåŠ ä¸Šæ—¶é—´é‡çº²å°±å˜æˆæ—¶é—´åˆ†è¾¨ç‡äº†ã€‚ä¸ºæ­¤ï¼ŒC++11å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ¨¡æ¿ç±»ratioï¼Œç”¨äºè¡¨ç¤ºæ¯”ç‡ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š 123//#include&lt;ration&gt;template&lt;std::intmax_t Num, std::intmax_t Denom = 1&gt; //å‰è€…æ˜¯åˆ†å­ï¼Œåè€…æ˜¯åˆ†æ¯class ratio; ä¸ºäº†æ–¹ä¾¿ï¼ŒC++æ ‡å‡†å§”å‘˜ä¼šè¿˜é¢„å®šä¹‰äº†ä¸‹é¢è¿™äº›åˆ†è¾¨ç‡ï¼Œä¾›ç”¨æˆ·ä½¿ç”¨ã€‚ 1234567//#include&lt;ratio&gt;typedef ratio&lt;1, 1000000000000000000&gt; atto;typedef ratio&lt;1, 1000000000000000&gt; femto;typedef ratio&lt;1, 1000000000000&gt; pico;typedef ratio&lt;1, 1000000000&gt; nano;typedef ratio&lt;1, 1000000&gt; micro;typedef ratio&lt;1, 1000&gt; milli; 1234567891011121314#include &lt;chrono&gt; #include &lt;iostream&gt;using namespace std;using namespace chrono;int main()&#123; auto start = system_clock::now(); // do something... auto end = system_clock::now(); auto duration = duration_cast&lt;microseconds&gt;(end - start); cout &lt;&lt; &quot;èŠ±è´¹äº†&quot; &lt;&lt; double(duration.count()) * microseconds::period::num / microseconds::period::den &lt;&lt; &quot;ç§’&quot; &lt;&lt; endl;&#125; æ­¤æ–¹æ³•å¯ä»¥ç²¾ç¡®åˆ°å¾®å¦™ï¼Œè¾“å‡ºæ ·ä¾‹ï¼šèŠ±è´¹äº†0.123456ç§’ microseconds è¡¨ç¤ºå¾®å¦™ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰äº”ç§æ—¶é—´å•ä½ï¼šhours, minutes, seconds, milliseconds, nanosecondsnum å’Œ denåˆ†åˆ«è¡¨ç¤ºåˆ†å­(numerator)å’Œåˆ†æ¯(denominator)ã€‚åœ¨æˆ‘ç»™å‡ºçš„ä»£ç ä¸­ï¼Œnumç­‰äº1ï¼Œ denç­‰äº1,000,000 system_clocké™¤äº†now()å‡½æ•°å¤–ï¼Œè¿˜æä¾›äº†to_time_t()é™æ€æˆå‘˜å‡½æ•°ã€‚ç”¨äºå°†ç³»ç»Ÿæ—¶é—´è½¬æ¢æˆç†Ÿæ‚‰çš„std::time_tç±»å‹ï¼Œ å¾—åˆ°äº†time_tç±»å‹çš„å€¼ï¼Œåœ¨ä½¿ç”¨ctime()å‡½æ•°å°†æ—¶é—´è½¬æ¢æˆå­—ç¬¦ä¸²æ ¼å¼ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰“å°å½“å‰æ—¶é—´äº†ã€‚ 123456789101112131415161718192021#include&lt;iostream&gt;#include&lt;vector&gt;#include&lt;string&gt;#include&lt;ctime&gt;//å°†æ—¶é—´æ ¼å¼çš„æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²#include&lt;chrono&gt;using namespace std::chrono;using namespace std;int main()&#123; //è·å–ç³»ç»Ÿçš„å½“å‰æ—¶é—´ auto t = system_clock::now(); //å°†è·å–çš„æ—¶é—´è½¬æ¢æˆtime_tç±»å‹ auto tNow = system_clock::to_time_t(t); //ctime()å‡½æ•°å°†time_tç±»å‹çš„æ—¶é—´è½¬åŒ–æˆå­—ç¬¦ä¸²æ ¼å¼,è¿™ä¸ªå­—ç¬¦ä¸²è‡ªå¸¦æ¢è¡Œç¬¦ string str_time = std::ctime(&amp;tNow); cout&lt;&lt;str_time; return 0;&#125; äºŒã€æŒç»­çš„æ—¶é—´ - durationstd::chrono::duration&lt;int,ratio&lt;60,1&gt;&gt; ,è¡¨ç¤ºæŒç»­çš„ä¸€æ®µæ—¶é—´,è¿™æ®µæ—¶é—´çš„å•ä½æ˜¯ç”±ratio&lt;60,1&gt;å†³å®šçš„,intè¡¨ç¤ºè¿™æ®µæ—¶é—´çš„å€¼çš„ç±»å‹,å‡½æ•°è¿”å›çš„ç±»å‹è¿˜æ˜¯ä¸€ä¸ªæ—¶é—´æ®µduration std::chrono::duration&lt;double,ratio&lt;60,1&gt;&gt; ç”±äºå„ç§æ—¶é—´æ®µ(duration)è¡¨ç¤ºä¸åŒï¼Œchronoåº“æä¾›äº†duration_castç±»å‹è½¬æ¢å‡½æ•°ã€‚ duration_castç”¨äºå°†durationè¿›è¡Œè½¬æ¢æˆå¦ä¸€ä¸ªç±»å‹çš„durationã€‚ durationè¿˜æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°count(),ç”¨æ¥è¡¨ç¤ºè¿™ä¸€æ®µæ—¶é—´çš„é•¿åº¦ 1234567891011121314151617#include&lt;iostream&gt;#include&lt;string.h&gt;#include&lt;chrono&gt;using namespace std::chrono;using namespace std;int main()&#123; auto start = steady_clock::now(); for(int i=0;i&lt;100;i++) cout&lt;&lt;&quot;nice&quot;&lt;&lt;endl; auto end = steady_clock::now(); auto tt = duration_cast&lt;microseconds&gt;(end - start); cout&lt;&lt;&quot;ç¨‹åºç”¨æ—¶=&quot;&lt;&lt;tt.count()&lt;&lt;&quot;å¾®ç§’&quot;&lt;&lt;endl; return 0;&#125; ä¸‰ã€æ—¶é—´ç‚¹ - time_point123//#include&lt;chrono&gt;template&lt; class Clock, class Duration = typename Clock::duration &gt; class time_point; std::chrono::time_point è¡¨ç¤ºä¸€ä¸ªå…·ä½“æ—¶é—´ï¼Œå¦‚ä¸Šä¸ªä¸–çºª80å¹´ä»£ã€ä»Šå¤©ä¸‹åˆ3ç‚¹ã€ç«è½¦å‡ºå‘æ—¶é—´ç­‰ï¼Œåªè¦å®ƒèƒ½ç”¨è®¡ç®—æœºæ—¶é’Ÿè¡¨ç¤ºã€‚ç¬¬ä¸€ä¸ªæ¨¡æ¿å‚æ•°Clockç”¨æ¥æŒ‡å®šæ‰€è¦ä½¿ç”¨çš„æ—¶é’Ÿï¼ˆæ ‡å‡†åº“ä¸­æœ‰ä¸‰ç§æ—¶é’Ÿï¼Œsystem_clockï¼Œsteady_clockå’Œhigh_resolution_clockã€‚è§4æ—¶é’Ÿè¯¦è§£ï¼‰ï¼Œç¬¬äºŒä¸ªæ¨¡æ¿å‡½æ•°å‚æ•°ç”¨æ¥è¡¨ç¤ºæ—¶é—´çš„è®¡é‡å•ä½(ç‰¹åŒ–çš„std::chrono::duration&lt;&gt; ) æ—¶é—´ç‚¹éƒ½æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå³æ—¶é—´åŸç‚¹ã€‚chronoåº“ä¸­é‡‡ç”¨çš„æ˜¯Unixçš„æ—¶é—´æˆ³1970å¹´1æœˆ1æ—¥ 00:00ã€‚æ‰€ä»¥time_pointä¹Ÿå°±æ˜¯è·ç¦»æ—¶é—´æˆ³(epoch)çš„æ—¶é—´é•¿åº¦ï¼ˆdurationï¼‰ã€‚ æ—¶é—´ç‚¹æœ‰ä¸ªé‡è¦çš„å‡½æ•°ï¼šduration time_since_epoch() (ç”¨äºè·å–å½“å‰æ—¶é—´ç‚¹è·ç¦»æ—¶é—´æˆ³çš„æ—¶é—´é•¿åº¦)å³ç»å¸¸ç”¨æ¥å¾—åˆ°å½“å‰æ—¶é—´ç‚¹åˆ°1970å¹´1æœˆ1æ—¥00:00çš„æ—¶é—´è·ç¦»ã€è¯¥å‡½æ•°è¿”å›çš„durationçš„ç²¾åº¦å’Œæ„é€ time_pointçš„æ—¶é’Ÿ(Clock)æœ‰å…³(è§4æ—¶é’Ÿè¯¦è§£)ã€‚ 1234567891011121314151617#include &lt;iostream&gt;#include &lt;chrono&gt;#include &lt;ctime&gt;using namespace std;int main()&#123; //è·ç¦»æ—¶é—´æˆ³2ä¸¤ç§’ chrono::time_point&lt;chrono::system_clock, chrono::seconds&gt; tp(chrono::seconds(2)); cout &lt;&lt; &quot;to epoch : &quot; &lt;&lt;tp.time_since_epoch().count() &lt;&lt; &quot;s&quot; &lt;&lt;endl; //è½¬åŒ–ä¸ºctimeï¼Œæ‰“å°è¾“å‡ºæ—¶é—´ç‚¹ time_t tt = chrono::system_clock::to_time_t(tp); char a[50]; ctime_s(a, sizeof(a), &amp;tt); cout &lt;&lt; a; system(&quot;pause&quot;); return 0;&#125;","categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"}],"tags":[]},{"title":"cppå•ä¾‹æ¨¡å¼æ€»ç»“","slug":"cppå•ä¾‹æ¨¡å¼æ€»ç»“","date":"2021-08-22T08:40:01.000Z","updated":"2021-08-27T16:40:45.739Z","comments":true,"path":"2021/08/22/cppå•ä¾‹æ¨¡å¼æ€»ç»“/","link":"","permalink":"https://marblemm.github.io/2021/08/22/cpp%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93/","excerpt":"","text":"C++ å•ä¾‹æ¨¡å¼æ€»ç»“ä¸å‰–æå•ä¾‹å¯èƒ½æ˜¯æœ€å¸¸ç”¨çš„ç®€å•çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ç°æ–¹æ³•å¤šæ ·ï¼Œæ ¹æ®ä¸åŒçš„éœ€æ±‚æœ‰ä¸åŒçš„å†™æ³•; åŒæ—¶å•ä¾‹ä¹Ÿæœ‰å…¶å±€é™æ€§ï¼Œå› æ­¤æœ‰å¾ˆå¤šäººæ˜¯åå¯¹ä½¿ç”¨å•ä¾‹çš„ã€‚æœ¬æ–‡å¯¹C++ å•ä¾‹çš„å¸¸è§å†™æ³•è¿›è¡Œäº†ä¸€ä¸ªæ€»ç»“, åŒ…æ‹¬æ‡’æ±‰å¼ã€çº¿ç¨‹å®‰å…¨ã€å•ä¾‹æ¨¡æ¿ç­‰ï¼› æŒ‰ç…§ä»ç®€å•åˆ°å¤æ‚ï¼Œæœ€ç»ˆå›å½’ç®€å•çš„çš„æ–¹å¼å¾ªåºæ¸è¿›åœ°ä»‹ç»ï¼Œå¹¶ä¸”å¯¹å„ç§å®ç°æ–¹æ³•çš„å±€é™è¿›è¡Œäº†ç®€å•çš„é˜è¿°ï¼Œå¤§é‡ç”¨åˆ°äº†C++ 11çš„ç‰¹æ€§å¦‚æ™ºèƒ½æŒ‡é’ˆ, magic staticï¼Œçº¿ç¨‹é”; ä»å¤´åˆ°å°¾ç†è§£ä¸‹æ¥ï¼Œå¯¹äºå­¦ä¹ å’Œå·©å›ºC++è¯­è¨€ç‰¹æ€§è¿˜æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚æœ¬æ–‡çš„å…¨éƒ¨ä»£ç åœ¨ g++ 5.4.0 ç¼–è¯‘å™¨ä¸‹ç¼–è¯‘è¿è¡Œé€šè¿‡ï¼Œå¯ä»¥åœ¨è¿™ä¸ªgithub ä»“åº“ä¸­æ‰¾åˆ°ã€‚ ä¸€ã€ä»€ä¹ˆæ˜¯å•ä¾‹å•ä¾‹ Singleton æ˜¯è®¾è®¡æ¨¡å¼çš„ä¸€ç§ï¼Œå…¶ç‰¹ç‚¹æ˜¯åªæä¾›å”¯ä¸€ä¸€ä¸ªç±»çš„å®ä¾‹,å…·æœ‰å…¨å±€å˜é‡çš„ç‰¹ç‚¹ï¼Œåœ¨ä»»ä½•ä½ç½®éƒ½å¯ä»¥é€šè¿‡æ¥å£è·å–åˆ°é‚£ä¸ªå”¯ä¸€å®ä¾‹;å…·ä½“è¿ç”¨åœºæ™¯å¦‚ï¼š è®¾å¤‡ç®¡ç†å™¨ï¼Œç³»ç»Ÿä¸­å¯èƒ½æœ‰å¤šä¸ªè®¾å¤‡ï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªè®¾å¤‡ç®¡ç†å™¨ï¼Œç”¨äºç®¡ç†è®¾å¤‡é©±åŠ¨; æ•°æ®æ± ï¼Œç”¨æ¥ç¼“å­˜æ•°æ®çš„æ•°æ®ç»“æ„ï¼Œéœ€è¦åœ¨ä¸€å¤„å†™ï¼Œå¤šå¤„è¯»å–æˆ–è€…å¤šå¤„å†™ï¼Œå¤šå¤„è¯»å–; äºŒã€C++å•ä¾‹çš„å®ç°2.1 åŸºç¡€è¦ç‚¹ å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼šstatic ç‰¹æ€§ï¼ŒåŒæ—¶ç¦æ­¢ç”¨æˆ·è‡ªå·±å£°æ˜å¹¶å®šä¹‰å®ä¾‹ï¼ˆæŠŠæ„é€ å‡½æ•°è®¾ä¸º privateï¼‰ çº¿ç¨‹å®‰å…¨ ç¦æ­¢èµ‹å€¼å’Œæ‹·è´ ç”¨æˆ·é€šè¿‡æ¥å£è·å–å®ä¾‹ï¼šä½¿ç”¨ static ç±»æˆå‘˜å‡½æ•° 2.2 C++ å®ç°å•ä¾‹çš„å‡ ç§æ–¹å¼2.2.1 æœ‰ç¼ºé™·çš„æ‡’æ±‰å¼æ‡’æ±‰å¼(Lazy-Initialization)çš„æ–¹æ³•æ˜¯ç›´åˆ°ä½¿ç”¨æ—¶æ‰å®ä¾‹åŒ–å¯¹è±¡ï¼Œä¹Ÿå°±è¯´ç›´åˆ°è°ƒç”¨get_instance() æ–¹æ³•çš„æ—¶å€™æ‰ new ä¸€ä¸ªå•ä¾‹çš„å¯¹è±¡ï¼Œ å¦‚æœä¸è¢«è°ƒç”¨å°±ä¸ä¼šå ç”¨å†…å­˜ã€‚ 12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;// version1:// with problems below:// 1. thread is not safe// 2. memory leakclass Singleton&#123;private: Singleton()&#123; std::cout&lt;&lt;&quot;constructor called!&quot;&lt;&lt;std::endl; &#125; Singleton(Singleton&amp;)=delete; Singleton&amp; operator=(const Singleton&amp;)=delete; static Singleton* m_instance_ptr;public: ~Singleton()&#123; std::cout&lt;&lt;&quot;destructor called!&quot;&lt;&lt;std::endl; &#125; static Singleton* get_instance()&#123; if(m_instance_ptr==nullptr)&#123; m_instance_ptr = new Singleton; &#125; return m_instance_ptr; &#125; void use() const &#123; std::cout &lt;&lt; &quot;in use&quot; &lt;&lt; std::endl; &#125;&#125;;Singleton* Singleton::m_instance_ptr = nullptr;int main()&#123; Singleton* instance = Singleton::get_instance(); Singleton* instance_2 = Singleton::get_instance(); return 0;&#125; è¿è¡Œçš„ç»“æœæ˜¯ 1constructor called! å¯ä»¥çœ‹åˆ°ï¼Œè·å–äº†ä¸¤æ¬¡ç±»çš„å®ä¾‹ï¼Œå´åªæœ‰ä¸€æ¬¡ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨ï¼Œè¡¨æ˜åªç”Ÿæˆäº†å”¯ä¸€å®ä¾‹ï¼Œè¿™æ˜¯ä¸ªæœ€åŸºç¡€ç‰ˆæœ¬çš„å•ä¾‹å®ç°ï¼Œä»–æœ‰å“ªäº›é—®é¢˜å‘¢ï¼Ÿ çº¿ç¨‹å®‰å…¨çš„é—®é¢˜,å½“å¤šçº¿ç¨‹è·å–å•ä¾‹æ—¶æœ‰å¯èƒ½å¼•å‘ç«æ€æ¡ä»¶ï¼šç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨ifä¸­åˆ¤æ–­ m_instance_ptræ˜¯ç©ºçš„ï¼Œäºæ˜¯å¼€å§‹å®ä¾‹åŒ–å•ä¾‹;åŒæ—¶ç¬¬2ä¸ªçº¿ç¨‹ä¹Ÿå°è¯•è·å–å•ä¾‹ï¼Œè¿™ä¸ªæ—¶å€™åˆ¤æ–­m_instance_ptrè¿˜æ˜¯ç©ºçš„ï¼Œäºæ˜¯ä¹Ÿå¼€å§‹å®ä¾‹åŒ–å•ä¾‹;è¿™æ ·å°±ä¼šå®ä¾‹åŒ–å‡ºä¸¤ä¸ªå¯¹è±¡,è¿™å°±æ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ç”±æ¥; è§£å†³åŠæ³•:åŠ é” å†…å­˜æ³„æ¼. æ³¨æ„åˆ°ç±»ä¸­åªè´Ÿè´£newå‡ºå¯¹è±¡ï¼Œå´æ²¡æœ‰è´Ÿè´£deleteå¯¹è±¡ï¼Œå› æ­¤åªæœ‰æ„é€ å‡½æ•°è¢«è°ƒç”¨ï¼Œææ„å‡½æ•°å´æ²¡æœ‰è¢«è°ƒç”¨;å› æ­¤ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚è§£å†³åŠæ³•ï¼š ä½¿ç”¨å…±äº«æŒ‡é’ˆ;å› æ­¤ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªæ”¹è¿›çš„ï¼Œçº¿ç¨‹å®‰å…¨çš„ã€ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆçš„å®ç°; 2.2.2 çº¿ç¨‹å®‰å…¨ã€å†…å­˜å®‰å…¨çš„æ‡’æ±‰å¼å•ä¾‹ ï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼Œé”ï¼‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#include &lt;iostream&gt;#include &lt;memory&gt; // shared_ptr#include &lt;mutex&gt; // mutex// version 2:// with problems below fixed:// 1. thread is safe now// 2. memory doesn&#x27;t leakclass Singleton&#123;public: typedef std::shared_ptr&lt;Singleton&gt; Ptr; ~Singleton()&#123; std::cout&lt;&lt;&quot;destructor called!&quot;&lt;&lt;std::endl; &#125; Singleton(Singleton&amp;)=delete; Singleton&amp; operator=(const Singleton&amp;)=delete; static Ptr get_instance()&#123; // &quot;double checked lock&quot; if(m_instance_ptr==nullptr)&#123; std::lock_guard&lt;std::mutex&gt; lk(m_mutex); if(m_instance_ptr == nullptr)&#123; m_instance_ptr = std::shared_ptr&lt;Singleton&gt;(new Singleton); &#125; &#125; return m_instance_ptr; &#125;private: Singleton()&#123; std::cout&lt;&lt;&quot;constructor called!&quot;&lt;&lt;std::endl; &#125; static Ptr m_instance_ptr; static std::mutex m_mutex;&#125;;// initialization static variables out of classSingleton::Ptr Singleton::m_instance_ptr = nullptr;std::mutex Singleton::m_mutex;int main()&#123; Singleton::Ptr instance = Singleton::get_instance(); Singleton::Ptr instance2 = Singleton::get_instance(); return 0;&#125; è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå‘ç°ç¡®å®åªæ„é€ äº†ä¸€æ¬¡å®ä¾‹ï¼Œå¹¶ä¸”å‘ç”Ÿäº†ææ„ã€‚ 12constructor called!destructor called! shared_ptrå’Œmutexéƒ½æ˜¯C++11çš„æ ‡å‡†ï¼Œä»¥ä¸Šè¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ åŸºäº shared_ptr, ç”¨äº†C++æ¯”è¾ƒå€¡å¯¼çš„ RAIIæ€æƒ³ï¼Œç”¨å¯¹è±¡ç®¡ç†èµ„æº,å½“ shared_ptr ææ„çš„æ—¶å€™ï¼Œnew å‡ºæ¥çš„å¯¹è±¡ä¹Ÿä¼šè¢« deleteæ‰ã€‚ä»¥æ­¤é¿å…å†…å­˜æ³„æ¼ã€‚ åŠ äº†é”ï¼Œä½¿ç”¨äº’æ–¥é‡æ¥è¾¾åˆ°çº¿ç¨‹å®‰å…¨ã€‚è¿™é‡Œä½¿ç”¨äº†ä¸¤ä¸ª ifåˆ¤æ–­è¯­å¥çš„æŠ€æœ¯ç§°ä¸ºåŒæ£€é”ï¼›å¥½å¤„æ˜¯ï¼Œåªæœ‰åˆ¤æ–­æŒ‡é’ˆä¸ºç©ºçš„æ—¶å€™æ‰åŠ é”ï¼Œé¿å…æ¯æ¬¡è°ƒç”¨ get_instanceçš„æ–¹æ³•éƒ½åŠ é”ï¼Œé”çš„å¼€é”€æ¯•ç«Ÿè¿˜æ˜¯æœ‰ç‚¹å¤§çš„ã€‚ ä¸è¶³ä¹‹å¤„åœ¨äºï¼š ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆä¼šè¦æ±‚ç”¨æˆ·ä¹Ÿå¾—ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œéå¿…è¦ä¸åº”è¯¥æå‡ºè¿™ç§çº¦æŸ; ä½¿ç”¨é”ä¹Ÿæœ‰å¼€é”€; åŒæ—¶ä»£ç é‡ä¹Ÿå¢å¤šäº†ï¼Œå®ç°ä¸Šæˆ‘ä»¬å¸Œæœ›è¶Šç®€å•è¶Šå¥½ã€‚ è¿˜æœ‰æ›´åŠ ä¸¥é‡çš„é—®é¢˜ï¼Œåœ¨æŸäº›å¹³å°ï¼ˆä¸ç¼–è¯‘å™¨å’ŒæŒ‡ä»¤é›†æ¶æ„æœ‰å…³ï¼‰ï¼ŒåŒæ£€é”ä¼šå¤±æ•ˆï¼å…·ä½“å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼Œè§£é‡Šäº†ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™æ ·çš„äº‹æƒ…ã€‚ å› æ­¤è¿™é‡Œè¿˜æœ‰ç¬¬ä¸‰ç§çš„åŸºäº Magic Staicçš„æ–¹æ³•è¾¾åˆ°çº¿ç¨‹å®‰å…¨ 2.2.3 æœ€æ¨èçš„æ‡’æ±‰å¼å•ä¾‹(magic static )â€”â€”å±€éƒ¨é™æ€å˜é‡123456789101112131415161718192021222324252627#include &lt;iostream&gt;class Singleton&#123;public: ~Singleton()&#123; std::cout&lt;&lt;&quot;destructor called!&quot;&lt;&lt;std::endl; &#125; Singleton(const Singleton&amp;)=delete; Singleton&amp; operator=(const Singleton&amp;)=delete; static Singleton&amp; get_instance()&#123; static Singleton instance; return instance; &#125;private: Singleton()&#123; std::cout&lt;&lt;&quot;constructor called!&quot;&lt;&lt;std::endl; &#125;&#125;;int main(int argc, char *argv[])&#123; Singleton&amp; instance_1 = Singleton::get_instance(); Singleton&amp; instance_2 = Singleton::get_instance(); return 0;&#125; è¿è¡Œç»“æœ 12constructor called!destructor called! è¿™ç§æ–¹æ³•åˆå«åš Meyersâ€™ SingletonMeyerâ€™sçš„å•ä¾‹ï¼Œ æ˜¯è‘—åçš„å†™å‡ºã€ŠEffective C++ã€‹ç³»åˆ—ä¹¦ç±çš„ä½œè€… Meyers æå‡ºçš„ã€‚æ‰€ç”¨åˆ°çš„ç‰¹æ€§æ˜¯åœ¨C++11æ ‡å‡†ä¸­çš„Magic Staticç‰¹æ€§ï¼š 12If control enters the declaration concurrently while the variable is being initialized, the concurrent execution shall wait for completion of the initialization.å¦‚æœå½“å˜é‡åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¹¶å‘åŒæ—¶è¿›å…¥å£°æ˜è¯­å¥ï¼Œå¹¶å‘çº¿ç¨‹å°†ä¼šé˜»å¡ç­‰å¾…åˆå§‹åŒ–ç»“æŸã€‚ è¿™æ ·ä¿è¯äº†å¹¶å‘çº¿ç¨‹åœ¨è·å–é™æ€å±€éƒ¨å˜é‡çš„æ—¶å€™ä¸€å®šæ˜¯åˆå§‹åŒ–è¿‡çš„ï¼Œæ‰€ä»¥å…·æœ‰çº¿ç¨‹å®‰å…¨æ€§ã€‚ C++é™æ€å˜é‡çš„ç”Ÿå­˜æœŸ æ˜¯ä»å£°æ˜åˆ°ç¨‹åºç»“æŸï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§æ‡’æ±‰å¼ã€‚ è¿™æ˜¯æœ€æ¨èçš„ä¸€ç§å•ä¾‹å®ç°æ–¹å¼ï¼š é€šè¿‡å±€éƒ¨é™æ€å˜é‡çš„ç‰¹æ€§ä¿è¯äº†çº¿ç¨‹å®‰å…¨ (C++11, GCC &gt; 4.3, VS2015æ”¯æŒè¯¥ç‰¹æ€§); ä¸éœ€è¦ä½¿ç”¨å…±äº«æŒ‡é’ˆï¼Œä»£ç ç®€æ´ï¼› æ³¨æ„åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦å£°æ˜å•ä¾‹çš„å¼•ç”¨ Single&amp; æ‰èƒ½è·å–å¯¹è±¡ã€‚å¦å¤–ç½‘ä¸Šæœ‰äººçš„å®ç°è¿”å›æŒ‡é’ˆè€Œä¸æ˜¯è¿”å›å¼•ç”¨1234static Singleton* get_instance()&#123; static Singleton instance; return &amp;instance;&#125; è¿™æ ·åšå¹¶ä¸å¥½ï¼Œç†ç”±ä¸»è¦æ˜¯æ— æ³•é¿å…ç”¨æˆ·ä½¿ç”¨delete instanceå¯¼è‡´å¯¹è±¡è¢«æå‰é”€æ¯ã€‚è¿˜æ˜¯å»ºè®®å¤§å®¶ä½¿ç”¨è¿”å›å¼•ç”¨çš„æ–¹å¼ã€‚ 2.2.4 å‡½æ•°è¿”å›å¼•ç”¨æœ‰äººåœ¨ç½‘ä¸Šæä¾›äº†è¿™æ ·ä¸€ç§å•ä¾‹çš„å®ç°æ–¹å¼ï¼› 12345678910111213141516171819202122232425#include &lt;iostream&gt;class A&#123;public: A() &#123; std::cout&lt;&lt;&quot;constructor&quot; &lt;&lt;std::endl; &#125; ~A()&#123; std::cout&lt;&lt;&quot;destructor&quot;&lt;&lt;std::endl; &#125;&#125;;A&amp; ret_singleton()&#123; static A instance; return instance;&#125;int main(int argc, char *argv[])&#123; A&amp; instance_1 = ret_singleton(); A&amp; instance_2 = ret_singleton(); return 0;&#125; ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸å±äºå•ä¾‹äº†ï¼Œå› ä¸ºç±»Aåªæ˜¯ä¸ªå¯»å¸¸çš„ç±»ï¼Œå¯ä»¥è¢«å®šä¹‰å‡ºå¤šä¸ªå®ä¾‹ï¼Œä½†æ˜¯äº®ç‚¹åœ¨äºæä¾›äº†ret_singletonçš„æ–¹æ³•ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªå…¨å±€ï¼ˆé™æ€ï¼‰å˜é‡ï¼Œèµ·åˆ°ç±»ä¼¼å•ä¾‹çš„æ•ˆæœï¼Œè¿™è¦æ±‚ç”¨æˆ·å¿…é¡»ä¿è¯æƒ³è¦è·å– å…¨å±€å˜é‡A ï¼Œåªé€šè¿‡ret_singleton()çš„æ–¹æ³•ã€‚ ä»¥ä¸Šæ˜¯å„ç§æ–¹æ³•å®ç°å•ä¾‹çš„ä»£ç å’Œè¯´æ˜ï¼Œè§£é‡Šäº†å„ç§æŠ€æœ¯å®ç°çš„åˆè¡·å’ŒåŸå› ã€‚è¿™é‡Œä¼šæ¯”è¾ƒæ¨è C++11 æ ‡å‡†ä¸‹çš„ 2.2.3 çš„æ–¹å¼ï¼Œå³ä½¿ç”¨static localçš„æ–¹æ³•ï¼Œç®€å•çš„ç†ç”±æ¥è¯´æ˜¯å› ä¸ºå…¶è¶³å¤Ÿç®€å•å´æ»¡è¶³æ‰€æœ‰éœ€æ±‚å’Œé¡¾è™‘ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç³»ç»Ÿä¸­å¯èƒ½æœ‰å¤šä¸ªå•ä¾‹ï¼Œå¦‚æœéƒ½æŒ‰ç…§è¿™ç§æ–¹å¼çš„è¯ï¼Œå®é™…ä¸Šæ˜¯ä¸€ç§é‡å¤ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥åªå®ç°ä¸€æ¬¡å•ä¾‹è€Œèƒ½å¤Ÿå¤ç”¨å…¶ä»£ç ä»è€Œå®ç°å¤šä¸ªå•ä¾‹å‘¢ï¼Ÿ å¾ˆè‡ªç„¶çš„æˆ‘ä»¬ä¼šè€ƒè™‘ä½¿ç”¨æ¨¡æ¿æŠ€æœ¯æˆ–è€…ç»§æ‰¿çš„æ–¹æ³•ï¼Œåœ¨æˆ‘çš„åšå®¢ä¸­æœ‰ä»‹ç»è¿‡å¦‚ä½•ä½¿ç”¨å•ä¾‹çš„æ¨¡æ¿ã€‚ 2.3 å•ä¾‹çš„æ¨¡æ¿2.3.1 CRTP å¥‡å¼‚é€’å½’æ¨¡æ¿æ¨¡å¼å®ç°ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344// brief: a singleton base class offering an easy way to create singleton#include &lt;iostream&gt;template&lt;typename T&gt;class Singleton&#123;public: static T&amp; get_instance()&#123; static T instance; return instance; &#125; virtual ~Singleton()&#123; std::cout&lt;&lt;&quot;destructor called!&quot;&lt;&lt;std::endl; &#125; Singleton(const Singleton&amp;)=delete; Singleton&amp; operator =(const Singleton&amp;)=delete;protected: Singleton()&#123; std::cout&lt;&lt;&quot;constructor called!&quot;&lt;&lt;std::endl; &#125;&#125;;/********************************************/// Example:// 1.friend class declaration is requiered!// 2.constructor should be privateclass DerivedSingle:public Singleton&lt;DerivedSingle&gt;&#123; // !!!! attention!!! // needs to be friend in order to // access the private constructor/destructor friend class Singleton&lt;DerivedSingle&gt;;public: DerivedSingle(const DerivedSingle&amp;)=delete; DerivedSingle&amp; operator =(const DerivedSingle&amp;)= delete;private: DerivedSingle()=default;&#125;;int main(int argc, char* argv[])&#123; DerivedSingle&amp; instance1 = DerivedSingle::get_instance(); DerivedSingle&amp; instance2 = DerivedSingle::get_instance(); return 0;&#125; ä»¥ä¸Šå®ç°ä¸€ä¸ªå•ä¾‹çš„æ¨¡æ¿åŸºç±»ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¾‹å­æ‰€ç¤ºæ„ï¼Œå­ç±»éœ€è¦å°†è‡ªå·±ä½œä¸ºæ¨¡æ¿å‚æ•°T ä¼ é€’ç»™ Singleton æ¨¡æ¿; åŒæ—¶éœ€è¦å°†åŸºç±»å£°æ˜ä¸ºå‹å…ƒï¼Œè¿™æ ·æ‰èƒ½è°ƒç”¨å­ç±»çš„ç§æœ‰æ„é€ å‡½æ•°ã€‚ åŸºç±»æ¨¡æ¿çš„å®ç°è¦ç‚¹æ˜¯ï¼š æ„é€ å‡½æ•°éœ€è¦æ˜¯ protectedï¼Œè¿™æ ·å­ç±»æ‰èƒ½ç»§æ‰¿ï¼› ä½¿ç”¨äº†å¥‡å¼‚é€’å½’æ¨¡æ¿æ¨¡å¼CRTP(Curiously recurring template pattern) get instance æ–¹æ³•å’Œ 2.2.3 çš„static localæ–¹æ³•ä¸€ä¸ªåŸç†ã€‚ åœ¨è¿™é‡ŒåŸºç±»çš„ææ„å‡½æ•°å¯ä»¥ä¸éœ€è¦ virtual ï¼Œå› ä¸ºå­ç±»åœ¨åº”ç”¨ä¸­åªä¼šç”¨ Derived ç±»å‹ï¼Œä¿è¯äº†ææ„æ—¶å’Œæ„é€ æ—¶çš„ç±»å‹ä¸€è‡´2.3.2 ä¸éœ€è¦åœ¨å­ç±»å£°æ˜å‹å…ƒçš„å®ç°æ–¹æ³•åœ¨ stackoverflowä¸Šï¼Œ æœ‰å¤§ç¥ç»™å‡ºäº†ä¸éœ€è¦åœ¨å­ç±»ä¸­å£°æ˜å‹å…ƒçš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œä¸€å¹¶æ”¾å‡º;ç²¾é«“åœ¨äºä½¿ç”¨ä¸€ä¸ªä»£ç†ç±» tokenï¼Œå­ç±»æ„é€ å‡½æ•°éœ€è¦ä¼ é€’tokenç±»æ‰èƒ½æ„é€ ï¼Œä½†æ˜¯æŠŠ tokenä¿æŠ¤å…¶èµ·æ¥ï¼Œ ç„¶åå­ç±»çš„æ„é€ å‡½æ•°å°±å¯ä»¥æ˜¯å…¬æœ‰çš„äº†ï¼Œè¿™ä¸ªå­ç±»åªæœ‰ Derived(token)çš„è¿™æ ·çš„æ„é€ å‡½æ•°ï¼Œè¿™æ ·ç”¨æˆ·å°±æ— æ³•è‡ªå·±å®šä¹‰ä¸€ä¸ªç±»çš„å®ä¾‹äº†ï¼Œèµ·åˆ°æ§åˆ¶å…¶å”¯ä¸€æ€§çš„ä½œç”¨ã€‚ä»£ç å¦‚ä¸‹ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142// brief: a singleton base class offering an easy way to create singleton#include &lt;iostream&gt;template&lt;typename T&gt;class Singleton&#123;public: static T&amp; get_instance() noexcept(std::is_nothrow_constructible&lt;T&gt;::value)&#123; static T instance&#123;token()&#125;; return instance; &#125; virtual ~Singleton() =default; Singleton(const Singleton&amp;)=delete; Singleton&amp; operator =(const Singleton&amp;)=delete;protected: struct token&#123;&#125;; // helper class Singleton() noexcept=default;&#125;;/********************************************/// Example:// constructor should be public because protected `token` control the accessclass DerivedSingle:public Singleton&lt;DerivedSingle&gt;&#123;public: DerivedSingle(token)&#123; std::cout&lt;&lt;&quot;destructor called!&quot;&lt;&lt;std::endl; &#125; ~DerivedSingle()&#123; std::cout&lt;&lt;&quot;constructor called!&quot;&lt;&lt;std::endl; &#125; DerivedSingle(const DerivedSingle&amp;)=delete; DerivedSingle&amp; operator =(const DerivedSingle&amp;)= delete;&#125;;int main(int argc, char* argv[])&#123; DerivedSingle&amp; instance1 = DerivedSingle::get_instance(); DerivedSingle&amp; instance2 = DerivedSingle::get_instance(); return 0;&#125; 2.3.3 å‡½æ•°æ¨¡æ¿è¿”å›å¼•ç”¨åœ¨ 2.2.4 ä¸­æä¾›äº†ä¸€ç§ç±»å‹çš„å…¨å±€å˜é‡çš„æ–¹æ³•ï¼Œå¯ä»¥æŠŠä¸€ä¸ªä¸€èˆ¬çš„ç±»ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æä¾›ä¸€ä¸ªç±»ä¼¼å•ä¾‹çš„å…¨å±€æ€§æ•ˆæœï¼ˆä½†æ˜¯ä¸èƒ½é˜»æ­¢ç”¨æˆ·è‡ªå·±å£°æ˜å®šä¹‰è¿™æ ·çš„ç±»çš„å¯¹è±¡ï¼‰;åœ¨è¿™é‡Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ–¹æ³•å˜æˆä¸€ä¸ª template æ¨¡æ¿å‡½æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°ä»»ä½•ä¸€ä¸ªç±»çš„å…¨å±€å˜é‡ã€‚12345678910111213141516171819202122232425#include &lt;iostream&gt;class A&#123;public: A() &#123; std::cout&lt;&lt;&quot;constructor&quot; &lt;&lt;std::endl; &#125; ~A()&#123; std::cout&lt;&lt;&quot;destructor&quot;&lt;&lt;std::endl; &#125;&#125;;template&lt;typename T&gt;T&amp; get_global()&#123; static T instance; return instance;&#125;int main(int argc, char *argv[])&#123; A&amp; instance_1 = get_global&lt;A&gt;(); A&amp; instance_2 = get_global&lt;A&gt;(); return 0;&#125; å¯ä»¥çœ‹åˆ°è¿™ç§æ–¹å¼ç¡®å®éå¸¸ç®€æ´ï¼ŒåŒæ—¶ç±»ä»ç„¶å…·æœ‰ä¸€èˆ¬ç±»çš„ç‰¹ç‚¹è€Œä¸å—é™åˆ¶ï¼Œå½“ç„¶ä¹Ÿå› æ­¤å¤±å»äº†å•ä¾‹é‚£ä¹ˆå¼ºçš„çº¦æŸï¼ˆç¦æ­¢èµ‹å€¼ã€æ„é€ å’Œæ‹·è´æ„é€ ï¼‰ã€‚è¿™é‡ŒæŠŠå‡½æ•°å‘½åä¸º get_global() æ˜¯ä¸ºäº†å¼ºè°ƒï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è·å–å¾—åˆ°å•ä¾‹æœ€é‡è¦çš„å…¨å±€å˜é‡ç‰¹æ€§ï¼›ä½†æ˜¯å¹¶ä¸æ˜¯å•ä¾‹çš„æ¨¡å¼ã€‚ ä¸‰ã€ä½•æ—¶åº”è¯¥ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨å•ä¾‹æ ¹æ®stackoverflowä¸Šçš„ä¸€ä¸ªé«˜ç¥¨ç­”æ¡ˆ singleton-how-should-it-be-usedï¼š 12You need to have one and only one object of a type in systemä½ éœ€è¦ç³»ç»Ÿä¸­åªæœ‰å”¯ä¸€ä¸€ä¸ªå®ä¾‹å­˜åœ¨çš„ç±»çš„å…¨å±€å˜é‡çš„æ—¶å€™æ‰ä½¿ç”¨å•ä¾‹ã€‚ å¦‚æœä½¿ç”¨å•ä¾‹ï¼Œåº”è¯¥ç”¨ä»€ä¹ˆæ ·å­çš„1234567891011How to create the best singleton:The smaller, the better. I am a minimalistMake sure it is thread safeMake sure it is never nullMake sure it is created only onceLazy or system initialization? Up to your requirementsSometimes the OS or the JVM creates singletons for you (e.g. in Java every class definition is a singleton)Provide a destructor or somehow figure out how to dispose resourcesUse little memoryè¶Šå°è¶Šå¥½ï¼Œè¶Šç®€å•è¶Šå¥½ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå†…å­˜ä¸æ³„éœ² åå¯¹å•ä¾‹çš„ç†ç”±å½“ç„¶ç¨‹åºå‘˜æ˜¯åˆ†æµæ´¾çš„ï¼Œæœ‰äº›æ˜¯åå¯¹å•ä¾‹çš„ï¼Œæœ‰äº›äººæ˜¯åå¯¹è®¾è®¡æ¨¡å¼çš„ï¼Œæœ‰äº›äººç”šè‡³è¿é¢å‘å¯¹è±¡éƒ½åå¯¹ ğŸ˜ƒ. åå¯¹å•ä¾‹çš„ç†ç”±æœ‰å“ªäº›ï¼š å‚è€ƒæ–‡ç« åœ¨æœ¬æ–‡å†™ä½œçš„è¿‡ç¨‹ä¸­å‚è€ƒäº†ä¸€äº›åšå®¢å’Œstackoverflow çš„å›ç­”ï¼Œä»¥è¶…é“¾æ¥çš„æ–¹å¼ä½“ç°åœ¨æ–‡ä¸­ã€‚å¦å¤–è¿˜æœ‰ä¸€äº›æˆ‘è§‰å¾—éå¸¸ç²¾å½©çš„å›ç­”ï¼Œæ”¾åœ¨ä¸‹é¢ä¾›è¯»è€…æ‹“å±•é˜…è¯» æ¨èé˜…è¯»ï¼š é«˜ç¥¨å›ç­”ä¸­æä¾›äº†ä¸€ç³»åˆ—æœ‰ç›Šçš„é“¾æ¥(https://stackoverflow.com/questions/1008019/c-singleton-design-pattern/1008289#1008289) é¢è¯•ä¸­çš„å•ä¾‹(http://www.cnblogs.com/loveis715/archive/2012/07/18/2598409.html) ä¸€äº›è§‚ç‚¹(https://segmentfault.com/q/1010000000593968) https://www.cnblogs.com/sunchaothu/p/10389842.html","categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"}],"tags":[]},{"title":"cppä¸­std::ref","slug":"cppä¸­std-ref","date":"2021-08-22T07:07:29.000Z","updated":"2021-08-22T07:09:20.535Z","comments":true,"path":"2021/08/22/cppä¸­std-ref/","link":"","permalink":"https://marblemm.github.io/2021/08/22/cpp%E4%B8%ADstd-ref/","excerpt":"","text":"C++æœ¬èº«æœ‰å¼•ç”¨ï¼ˆ&amp;ï¼‰ï¼Œä¸ºä»€ä¹ˆC++11åˆå¼•å…¥äº†std::refï¼ˆæˆ–è€…std::crefï¼‰ï¼Ÿä½¿ç”¨std::refå¯ä»¥åœ¨æ¨¡æ¿ä¼ å‚çš„æ—¶å€™ä¼ å…¥å¼•ç”¨ï¼Œå¦åˆ™åªèƒ½ä¼ å€¼ã€‚ä¸»è¦æ˜¯è€ƒè™‘å‡½æ•°å¼ç¼–ç¨‹ï¼ˆå¦‚std::bindï¼‰åœ¨ä½¿ç”¨æ—¶ï¼Œæ˜¯å¯¹å‚æ•°ç›´æ¥æ‹·è´ï¼Œè€Œä¸æ˜¯å¼•ç”¨ã€‚å¦‚ä¸‹ä¾‹å­ï¼š 12345678910111213141516171819202122#include &lt;functional&gt;#include &lt;iostream&gt; void f(int&amp; n1, int&amp; n2, const int&amp; n3)&#123; std::cout &lt;&lt; &quot;In function: &quot; &lt;&lt; n1 &lt;&lt; &#x27; &#x27; &lt;&lt; n2 &lt;&lt; &#x27; &#x27; &lt;&lt; n3 &lt;&lt; &#x27;\\n&#x27;; ++n1; // increments the copy of n1 stored in the function object ++n2; // increments the main()&#x27;s n2 // ++n3; // compile error&#125; int main()&#123; int n1 = 1, n2 = 2, n3 = 3; std::function&lt;void()&gt; bound_f = std::bind(f, n1, std::ref(n2), std::cref(n3)); n1 = 10; n2 = 11; n3 = 12; std::cout &lt;&lt; &quot;Before function: &quot; &lt;&lt; n1 &lt;&lt; &#x27; &#x27; &lt;&lt; n2 &lt;&lt; &#x27; &#x27; &lt;&lt; n3 &lt;&lt; &#x27;\\n&#x27;; bound_f(); std::cout &lt;&lt; &quot;After function: &quot; &lt;&lt; n1 &lt;&lt; &#x27; &#x27; &lt;&lt; n2 &lt;&lt; &#x27; &#x27; &lt;&lt; n3 &lt;&lt; &#x27;\\n&#x27;;&#125; è¾“å‡ºï¼š 1234Output:Before function: 10 11 12In function: 1 11 12After function: 10 12 12 ä¸Šè¿°ä»£ç åœ¨æ‰§è¡Œstd::bindåï¼Œåœ¨å‡½æ•°f()ä¸­n1çš„å€¼ä»ç„¶æ˜¯1ï¼Œn2å’Œn3æ”¹æˆäº†ä¿®æ”¹çš„å€¼ã€‚è¯´æ˜std::bindä½¿ç”¨çš„æ˜¯å‚æ•°çš„æ‹·è´è€Œä¸æ˜¯å¼•ç”¨ã€‚å…·ä½“ä¸ºä»€ä¹ˆstd::bindä¸ä½¿ç”¨å¼•ç”¨ï¼Œå¯èƒ½ç¡®å®æœ‰ä¸€äº›éœ€æ±‚ï¼Œä½¿å¾—C++11çš„è®¾è®¡è€…è®¤ä¸ºé»˜è®¤åº”è¯¥é‡‡ç”¨æ‹·è´ï¼Œå¦‚æœä½¿ç”¨è€…æœ‰éœ€æ±‚ï¼ŒåŠ ä¸Šstd::refå³å¯ã€‚ &amp;æ˜¯ç±»å‹è¯´æ˜ç¬¦ï¼Œ std::ref æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å› std::reference_wrapperç±»å‹ã€‚å¦å¤–std::cref() ç”¨äºconstå¼•ç”¨çš„ç‰ˆæœ¬ã€‚ å‚è€ƒï¼š https://www.cnblogs.com/chen-cs/p/13059896.html","categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"}],"tags":[]},{"title":"cppä¸­çš„RAIIæœºåˆ¶","slug":"cppä¸­çš„RAIIæœºåˆ¶","date":"2021-08-20T15:52:47.000Z","updated":"2021-08-22T16:36:28.839Z","comments":true,"path":"2021/08/20/cppä¸­çš„RAIIæœºåˆ¶/","link":"","permalink":"https://marblemm.github.io/2021/08/20/cpp%E4%B8%AD%E7%9A%84RAII%E6%9C%BA%E5%88%B6/","excerpt":"","text":"ä»€ä¹ˆæ˜¯RAIIï¼ŸRAIIæ˜¯Resource Acquisition Is Initializationï¼ˆwikiä¸Šé¢ç¿»è¯‘æˆ â€œèµ„æºè·å–å°±æ˜¯åˆå§‹åŒ–â€ï¼‰çš„ç®€ç§°ï¼Œæ˜¯C++è¯­è¨€çš„ä¸€ç§ç®¡ç†èµ„æºã€é¿å…æ³„æ¼çš„æƒ¯ç”¨æ³•ã€‚åˆ©ç”¨çš„å°±æ˜¯C++æ„é€ çš„å¯¹è±¡æœ€ç»ˆä¼šè¢«é”€æ¯çš„åŸåˆ™ã€‚RAIIçš„åšæ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨å…¶æ„é€ æ—¶è·å–å¯¹åº”çš„èµ„æºï¼Œåœ¨å¯¹è±¡ç”Ÿå‘½æœŸå†…æ§åˆ¶å¯¹èµ„æºçš„è®¿é—®ï¼Œä½¿ä¹‹å§‹ç»ˆä¿æŒæœ‰æ•ˆï¼Œæœ€ååœ¨å¯¹è±¡ææ„çš„æ—¶å€™ï¼Œé‡Šæ”¾æ„é€ æ—¶è·å–çš„èµ„æºã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RAIIï¼Ÿä¸Šé¢è¯´åˆ°RAIIæ˜¯ç”¨æ¥ç®¡ç†èµ„æºã€é¿å…èµ„æºæ³„æ¼çš„æ–¹æ³•ã€‚é‚£ä¹ˆï¼Œç”¨äº†è¿™ä¹ˆä¹…äº†ï¼Œä¹Ÿå†™äº†è¿™ä¹ˆå¤šç¨‹åºäº†ï¼Œå£å¤´ä¸Šç»å¸¸ä¼šè¯´èµ„æºï¼Œé‚£ä¹ˆèµ„æºæ˜¯å¦‚ä½•å®šä¹‰çš„ï¼Ÿåœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œèµ„æºæ˜¯æ•°é‡æœ‰é™ä¸”å¯¹ç³»ç»Ÿæ­£å¸¸è¿è¡Œå…·æœ‰ä¸€å®šä½œç”¨çš„å…ƒç´ ã€‚æ¯”å¦‚ï¼šç½‘ç»œå¥—æ¥å­—ã€äº’æ–¥é”ã€æ–‡ä»¶å¥æŸ„å’Œå†…å­˜ç­‰ç­‰ï¼Œå®ƒä»¬å±äºç³»ç»Ÿèµ„æºã€‚ç”±äºç³»ç»Ÿçš„èµ„æºæ˜¯æœ‰é™çš„ï¼Œå°±å¥½æ¯”è‡ªç„¶ç•Œçš„çŸ³æ²¹ï¼Œé“çŸ¿ä¸€æ ·ï¼Œä¸æ˜¯å–ä¹‹ä¸å°½ï¼Œç”¨ä¹‹ä¸ç«­çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨ç¼–ç¨‹ä½¿ç”¨ç³»ç»Ÿèµ„æºæ—¶ï¼Œéƒ½å¿…é¡»éµå¾ªä¸€ä¸ªæ­¥éª¤ï¼š1 ç”³è¯·èµ„æºï¼›2 ä½¿ç”¨èµ„æºï¼›3 é‡Šæ”¾èµ„æºã€‚ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥ç¼ºä¸€ä¸å¯ï¼Œå› ä¸ºèµ„æºå¿…é¡»è¦ç”³è¯·æ‰èƒ½ä½¿ç”¨çš„ï¼Œä½¿ç”¨å®Œæˆä»¥åï¼Œå¿…é¡»è¦é‡Šæ”¾ï¼Œå¦‚æœä¸é‡Šæ”¾çš„è¯ï¼Œå°±ä¼šé€ æˆèµ„æºæ³„æ¼ã€‚ ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š12345678910111213#include &lt;iostream&gt; using namespace std; int main() &#123; int *testArray = new int [10]; // Here, you can use the array delete [] testArray; testArray = NULL ; return 0; &#125; å°ç»“ï¼šä½†æ˜¯å¦‚æœç¨‹åºå¾ˆå¤æ‚çš„æ—¶å€™ï¼Œéœ€è¦ä¸ºæ‰€æœ‰çš„new åˆ†é…çš„å†…å­˜deleteæ‰ï¼Œå¯¼è‡´æåº¦è‡ƒè‚¿ï¼Œæ•ˆç‡ä¸‹é™ï¼Œæ›´å¯æ€•çš„æ˜¯ï¼Œç¨‹åºçš„å¯ç†è§£æ€§å’Œå¯ç»´æŠ¤æ€§æ˜æ˜¾é™ä½äº†ï¼Œå½“æ“ä½œå¢å¤šæ—¶ï¼Œå¤„ç†èµ„æºé‡Šæ”¾çš„ä»£ç å°±ä¼šè¶Šæ¥è¶Šå¤šï¼Œè¶Šæ¥è¶Šä¹±ã€‚å¦‚æœæŸä¸€ä¸ªæ“ä½œå‘ç”Ÿäº†å¼‚å¸¸è€Œå¯¼è‡´é‡Šæ”¾èµ„æºçš„è¯­å¥æ²¡æœ‰è¢«è°ƒç”¨ï¼Œæ€ä¹ˆåŠï¼Ÿè¿™ä¸ªæ—¶å€™ï¼ŒRAIIæœºåˆ¶å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ã€‚ å¦‚ä½•ä½¿ç”¨RAIIï¼Ÿå½“æˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œå½“é€€å‡ºäº†è¿™ä¸ªå±€éƒ¨å˜é‡çš„ä½œç”¨åŸŸæ—¶ï¼Œè¿™ä¸ªå˜é‡ä¹Ÿå°±åˆ«é”€æ¯äº†ï¼›å½“è¿™ä¸ªå˜é‡æ˜¯ç±»å¯¹è±¡æ—¶ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªç±»çš„ææ„å‡½æ•°ï¼Œè€Œè¿™ä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨å‘ç”Ÿçš„ï¼Œä¸è¦ç¨‹åºå‘˜æ˜¾ç¤ºçš„å»è°ƒç”¨å®Œæˆã€‚è¿™ä¸ªä¹Ÿå¤ªå¥½äº†ï¼ŒRAIIå°±æ˜¯è¿™æ ·å»å®Œæˆçš„ã€‚ ç”±äºç³»ç»Ÿçš„èµ„æºä¸å…·æœ‰è‡ªåŠ¨é‡Šæ”¾çš„åŠŸèƒ½ï¼Œè€ŒC++ä¸­çš„ç±»å…·æœ‰è‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°çš„åŠŸèƒ½ã€‚å¦‚æœæŠŠèµ„æºç”¨ç±»è¿›è¡Œå°è£…èµ·æ¥ï¼Œå¯¹èµ„æºæ“ä½œéƒ½å°è£…åœ¨ç±»çš„å†…éƒ¨ï¼Œåœ¨ææ„å‡½æ•°ä¸­è¿›è¡Œé‡Šæ”¾èµ„æºã€‚å½“å®šä¹‰çš„å±€éƒ¨å˜é‡çš„ç”Ÿå‘½ç»“æŸæ—¶ï¼Œå®ƒçš„ææ„å‡½æ•°å°±ä¼šè‡ªåŠ¨çš„è¢«è°ƒç”¨ï¼Œå¦‚æ­¤ï¼Œå°±ä¸ç”¨ç¨‹åºå‘˜æ˜¾ç¤ºçš„å»è°ƒç”¨é‡Šæ”¾èµ„æºçš„æ“ä½œäº†ã€‚ ä½¿ç”¨RAII æœºåˆ¶çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#include &lt;iostream&gt; using namespace std; class ArrayOperation &#123; public : ArrayOperation() &#123; m_Array = new int [10]; &#125; void InitArray() &#123; for (int i = 0; i &lt; 10; ++i) &#123; *(m_Array + i) = i; &#125; &#125; void ShowArray() &#123; for (int i = 0; i &lt;10; ++i) &#123; cout&lt;&lt;m_Array[i]&lt;&lt;endl; &#125; &#125; ~ArrayOperation() &#123; cout&lt;&lt; &quot;~ArrayOperation is called&quot; &lt;&lt;endl; if (m_Array != NULL ) &#123; delete[] m_Array; // éå¸¸æ„Ÿè°¢ç›Šå¯è¾¾éå¸¸çŠ€åˆ©çš„reviewï¼Œè¯¦ç»†å¯ä»¥å‚åŠ ç›Šå¯è¾¾åœ¨æœ¬æ–‡çš„è¯„è®º 2014.04.13 m_Array = NULL ; &#125; &#125; private : int *m_Array; &#125;; bool OperationA(); bool OperationB(); int main() &#123; ArrayOperation arrayOp; arrayOp.InitArray(); arrayOp.ShowArray(); return 0;&#125; ä¸ä½¿ç”¨RAIIï¼ˆæ²¡æœ‰ä½¿ç”¨ç±»çš„æ€æƒ³ï¼‰çš„ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546#include &lt;iostream&gt; using namespace std; bool OperationA(); bool OperationB(); int main() &#123; int *testArray = new int [10]; // Here, you can use the array if (!OperationA()) &#123; // If the operation A failed, we should delete the memory delete [] testArray; testArray = NULL ; return 0; &#125; if (!OperationB()) &#123; // If the operation A failed, we should delete the memory delete [] testArray; testArray = NULL ; return 0; &#125; // All the operation succeed, delete the memory delete [] testArray; testArray = NULL ; return 0; &#125; bool OperationA() &#123; // Do some operation, if the operate succeed, then return true, else return false return false ; &#125; bool OperationB() &#123; // Do some operation, if the operate succeed, then return true, else return false return true ; &#125; ä¸Šé¢è¿™ä¸ªä¾‹å­æ²¡æœ‰å¤šå¤§çš„å®é™…æ„ä¹‰ï¼Œåªæ˜¯ä¸ºäº†è¯´æ˜RAIIçš„æœºåˆ¶é—®é¢˜ã€‚ä¸‹é¢è¯´ä¸€ä¸ªå…·æœ‰å®é™…æ„ä¹‰çš„ä¾‹å­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#include &lt;iostream&gt;#include &lt;windows.h&gt;#include &lt;process.h&gt;using namespace std;CRITICAL_SECTION cs;int gGlobal = 0;class MyLock&#123;public: MyLock() &#123; EnterCriticalSection(&amp;cs); &#125; ~MyLock() &#123; LeaveCriticalSection(&amp;cs); &#125;private: MyLock( const MyLock &amp;); MyLock operator =(const MyLock &amp;);&#125;;void DoComplex(MyLock &amp;lock ) // éå¸¸æ„Ÿè°¢ç›Šå¯è¾¾çŠ€åˆ©çš„review 2014.04.13&#123;&#125;unsigned int __stdcall ThreadFun(PVOID pv) &#123; MyLock lock; int *para = (int *) pv; // I need the lock to do some complex thing DoComplex(lock); for (int i = 0; i &lt; 10; ++i) &#123; ++gGlobal; cout&lt;&lt; &quot;Thread &quot; &lt;&lt;*para&lt;&lt;endl; cout&lt;&lt;gGlobal&lt;&lt;endl; &#125; return 0;&#125;int main()&#123; InitializeCriticalSection(&amp;cs); int thread1, thread2; thread1 = 1; thread2 = 2; HANDLE handle[2]; handle[0] = ( HANDLE )_beginthreadex(NULL , 0, ThreadFun, ( void *)&amp;thread1, 0, NULL ); handle[1] = ( HANDLE )_beginthreadex(NULL , 0, ThreadFun, ( void *)&amp;thread2, 0, NULL ); WaitForMultipleObjects(2, handle, TRUE , INFINITE ); return 0;&#125; è¿™ä¸ªä¾‹å­å¯ä»¥è¯´æ˜¯å®é™…é¡¹ç›®çš„ä¸€ä¸ªæ¨¡å‹ï¼Œå½“å¤šä¸ªè¿›ç¨‹è®¿é—®ä¸´ç•Œå˜é‡æ—¶ï¼Œä¸ºäº†ä¸å‡ºç°é”™è¯¯çš„æƒ…å†µï¼Œéœ€è¦å¯¹ä¸´ç•Œå˜é‡è¿›è¡ŒåŠ é”ï¼›ä¸Šé¢çš„ä¾‹å­å°±æ˜¯ä½¿ç”¨çš„Windowsçš„ä¸´ç•ŒåŒºåŸŸå®ç°çš„åŠ é”ã€‚ ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨CRITICAL_SECTIONæ—¶ï¼ŒEnterCriticalSectionå’ŒLeaveCriticalSectionå¿…é¡»æˆå¯¹ä½¿ç”¨ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œç»å¸¸ä¼šå¿˜äº†è°ƒç”¨LeaveCriticalSectionï¼Œæ­¤æ—¶å°±ä¼šå‘ç”Ÿæ­»é”çš„ç°è±¡ã€‚å½“æˆ‘å°†å¯¹CRITICAL_SECTIONçš„è®¿é—®å°è£…åˆ°MyLockç±»ä¸­æ—¶ï¼Œä¹‹åï¼Œæˆ‘åªéœ€è¦å®šä¹‰ä¸€ä¸ªMyLockå˜é‡ï¼Œè€Œä¸å¿…æ‰‹åŠ¨çš„å»æ˜¾ç¤ºè°ƒç”¨LeaveCriticalSectionå‡½æ•°ã€‚ ä¸Šè¿°çš„ä¸¤ä¸ªä¾‹å­éƒ½æ˜¯RAIIæœºåˆ¶çš„åº”ç”¨ï¼Œç†è§£äº†ä¸Šé¢çš„ä¾‹å­ï¼Œå°±åº”è¯¥èƒ½ç†è§£äº†RAIIæœºåˆ¶çš„ä½¿ç”¨äº†ã€‚ å‚è€ƒï¼š https://www.jianshu.com/p/b7ffe79498be","categories":[],"tags":[]},{"title":"cpp11å¤šçº¿ç¨‹5-atomic","slug":"cpp11å¤šçº¿ç¨‹5-atomic","date":"2021-08-19T14:08:01.000Z","updated":"2021-08-30T15:46:34.630Z","comments":true,"path":"2021/08/19/cpp11å¤šçº¿ç¨‹5-atomic/","link":"","permalink":"https://marblemm.github.io/2021/08/19/cpp11%E5%A4%9A%E7%BA%BF%E7%A8%8B5-atomic/","excerpt":"","text":"å¯¹ç®€å•ä¸´ç•Œèµ„æºçš„è®¿é—®ï¼Œå¦‚æœä½¿ç”¨mutexå¼€é”€è¾ƒå¤§ã€‚ å¦‚æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œå¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œæ“ä½œï¼Œä¸€ä¸ªçº¿ç¨‹è¯»è¿™ä¸ªå˜é‡çš„å€¼ï¼Œä¸€ä¸ªçº¿ç¨‹å¾€è¿™ä¸ªå˜é‡ä¸­å†™å€¼ã€‚å³ä½¿æ˜¯ä¸€ä¸ªç®€å•å˜é‡çš„è¯»å–å’Œå†™å…¥æ“ä½œï¼Œå¦‚æœä¸åŠ é”ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šå¯¼è‡´è¯»å†™å€¼æ··ä¹±ï¼ˆä¸€æ¡è¯­å¥å¯èƒ½ä¼šè¢«æ‹†æˆ3ã€4æ¡æ±‡ç¼–è¯­å¥æ¥æ‰§è¡Œï¼Œæ‰€ä»¥ä»ç„¶æœ‰å¯èƒ½æ··ä¹±ï¼‰ 1234567891011121314151617181920212223242526272829303132333435#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;chrono&gt;using namespace std;using namespace std::chrono;int g_count = 0;void mythread()&#123; for (int i = 0; i &lt; 1000000; i++) &#123; g_count++; &#125;&#125;int main()&#123; std::thread t1(mythread); std::thread t2(mythread); auto start = steady_clock::now(); t1.join(); t2.join(); auto end = steady_clock::now(); auto tt = duration_cast&lt;milliseconds&gt;(end - start); cout &lt;&lt; &quot;ç¨‹åºç”¨æ—¶=&quot; &lt;&lt; tt.count() &lt;&lt; &quot;æ¯«ç§’&quot; &lt;&lt; endl; cout &lt;&lt; &quot;æ­£å¸¸æƒ…å†µä¸‹ç»“æœåº”è¯¥æ˜¯200 0000æ¬¡ï¼Œå®é™…æ˜¯&quot; &lt;&lt; g_count &lt;&lt; endl; return 0;&#125;/*ç»“æœï¼šç¨‹åºç”¨æ—¶=16æ¯«ç§’æ­£å¸¸æƒ…å†µä¸‹ç»“æœåº”è¯¥æ˜¯200 0000æ¬¡ï¼Œå®é™…æ˜¯1303733*/ ä½¿ç”¨std::mutexæ¥è§£å†³ä¸Šè¿°å¯¹ä¸´ç•Œèµ„æºè®¿é—®çš„é—®é¢˜ã€‚ç»“æœæ­£å¸¸ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡å¾ªç¯éƒ½è¦åŠ é”è§£é”æ˜¯çš„ç¨‹åºå¼€é”€å¾ˆå¤§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;chrono&gt;#include &lt;mutex&gt;using namespace std;using namespace std::chrono;int g_count = 0;std::mutex mymutex;void mythread()&#123; for (int i = 0; i &lt; 1000000; i++) &#123; std::unique_lock&lt;std::mutex&gt; u1(mymutex); g_count++; &#125;&#125;int main()&#123; std::thread t1(mythread); std::thread t2(mythread); auto start = steady_clock::now(); t1.join(); t2.join(); auto end = steady_clock::now(); auto tt = duration_cast&lt;milliseconds&gt;(end - start); cout &lt;&lt; &quot;ç¨‹åºç”¨æ—¶=&quot; &lt;&lt; tt.count() &lt;&lt; &quot;æ¯«ç§’&quot; &lt;&lt; endl; cout &lt;&lt; &quot;æ­£å¸¸æƒ…å†µä¸‹ç»“æœåº”è¯¥æ˜¯200 0000æ¬¡ï¼Œå®é™…æ˜¯&quot; &lt;&lt; g_count &lt;&lt; endl; return 0;&#125;/*ç»“æœï¼šç¨‹åºç”¨æ—¶=349æ¯«ç§’æ­£å¸¸æƒ…å†µä¸‹ç»“æœåº”è¯¥æ˜¯200 0000æ¬¡ï¼Œå®é™…æ˜¯2000000*/ std::atomic std::atomicåŒ…å«åœ¨å¤´æ–‡ä»¶ä¸­ã€‚å¯ä»¥æŠŠåŸå­æ“ä½œç†è§£æˆä¸€ç§ï¼šä¸éœ€è¦ç”¨åˆ°äº’æ–¥é‡åŠ é”ï¼ˆæ— é”ï¼‰æŠ€æœ¯çš„å¤šçº¿ç¨‹å¹¶å‘ç¼–ç¨‹æ–¹å¼ã€‚åŸå­æ“ä½œï¼šåœ¨å¤šçº¿ç¨‹ä¸­ä¸ä¼šè¢«æ‰“æ–­çš„ç¨‹åºæ‰§è¡Œç‰‡æ®µã€‚ä»æ•ˆç‡ä¸Šæ¥è¯´ï¼ŒåŸå­æ“ä½œè¦æ¯”äº’æ–¥é‡çš„æ–¹å¼æ•ˆç‡è¦é«˜ã€‚äº’æ–¥é‡çš„åŠ é”ä¸€èˆ¬æ˜¯é’ˆå¯¹ä¸€ä¸ªä»£ç æ®µï¼Œè€ŒåŸå­æ“ä½œé’ˆå¯¹çš„ä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå˜é‡ã€‚åŸå­æ“ä½œï¼Œä¸€èˆ¬éƒ½æ˜¯æŒ‡â€œä¸å¯åˆ†å‰²çš„æ“ä½œâ€ï¼›ä¹Ÿå°±æ˜¯è¯´è¿™ç§æ“ä½œçŠ¶æ€è¦ä¹ˆæ˜¯å®Œæˆçš„ï¼Œè¦ä¹ˆæ˜¯æ²¡å®Œæˆçš„ï¼Œä¸å¯èƒ½å‡ºç°åŠå®ŒæˆçŠ¶æ€ã€‚std::atomicæ¥ä»£è¡¨åŸå­æ“ä½œï¼Œæ˜¯ä¸ªç±»æ¨¡æ¿ã€‚å…¶å®std::atomicæ˜¯ç”¨æ¥å°è£…æŸä¸ªç±»å‹çš„å€¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;atomic&gt;#include &lt;chrono&gt;using namespace std;using namespace std::chrono;std::atomic&lt;int&gt; g_count = 0; //å°è£…äº†ä¸€ä¸ªç±»å‹ä¸ºintçš„ å¯¹è±¡ï¼ˆå€¼ï¼‰void mythread()&#123; for (int i = 0; i &lt; 1000000; i++) &#123; g_count++; &#125;&#125;int main()&#123; std::thread t1(mythread); std::thread t2(mythread); auto start = steady_clock::now(); t1.join(); t2.join(); auto end = steady_clock::now(); auto tt = duration_cast&lt;milliseconds&gt;(end - start); cout &lt;&lt; &quot;ç¨‹åºç”¨æ—¶=&quot; &lt;&lt; tt.count() &lt;&lt; &quot;æ¯«ç§’&quot; &lt;&lt; endl; cout &lt;&lt; &quot;æ­£å¸¸æƒ…å†µä¸‹ç»“æœåº”è¯¥æ˜¯200 0000æ¬¡ï¼Œå®é™…æ˜¯&quot; &lt;&lt; g_count &lt;&lt; endl; return 0;&#125;/*ç¨‹åºç”¨æ—¶=51æ¯«ç§’æ­£å¸¸æƒ…å†µä¸‹ç»“æœåº”è¯¥æ˜¯200 0000æ¬¡ï¼Œå®é™…æ˜¯2000000*/ ä¸€èˆ¬atomicåŸå­æ“ä½œï¼Œé’ˆå¯¹++ï¼Œâ€“ï¼Œ+=ï¼Œ-=ï¼Œ&amp;=ï¼Œ|=ï¼Œ^=æ˜¯æ”¯æŒçš„ï¼Œå…¶ä»–æ“ä½œä¸ä¸€å®šæ”¯æŒã€‚å¦‚ä¸‹ä½¿ç”¨g_count = g_count + 1å°±ä¼šäº§ç”Ÿé”™è¯¯ã€‚ 123456789101112131415161718192021#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;atomic&gt;using namespace std;std::atomic&lt;int&gt; g_count = 0; //å°è£…äº†ä¸€ä¸ªç±»å‹ä¸ºintçš„ å¯¹è±¡ï¼ˆå€¼ï¼‰void mythread1() &#123; for (int i = 0; i &lt; 1000000; i++) &#123; //è™½ç„¶g_countä½¿ç”¨äº†åŸå­æ“ä½œæ¨¡æ¿ï¼Œä½†æ˜¯è¿™ç§å†™æ³•æ—¢è¯»åˆå†™ï¼Œ //ä¼šå¯¼è‡´è®¡æ•°é”™è¯¯ g_count = g_count + 1; &#125;&#125;int main() &#123; std::thread t1(mythread1); std::thread t2(mythread1); t1.join(); t2.join(); cout &lt;&lt; &quot;æ­£å¸¸æƒ…å†µä¸‹ç»“æœåº”è¯¥æ˜¯200 0000æ¬¡ï¼Œå®é™…æ˜¯&quot; &lt;&lt; g_count &lt;&lt; endl;&#125; å…¶ä»–éœ€è¦æ³¨æ„çš„åœ°æ–¹12std::atomic&lt;int&gt; atm = 0; cout &lt;&lt; atm &lt;&lt; endl; è¿™é‡Œåªæœ‰è¯»å–atmæ˜¯åŸå­æ“ä½œï¼Œä½†æ˜¯æ•´ä¸ªè¿™ä¸€è¡Œä»£ç  cout &lt;&lt; atm &lt;&lt; endl; å¹¶ä¸æ˜¯åŸå­æ“ä½œï¼Œå¯¼è‡´æœ€ç»ˆæ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„å€¼æ˜¯ä¸€ä¸ªâ€œæ›¾ç»å€¼â€ã€‚ 12std::atomic&lt;int&gt; atm = 0;auto atm2 = atm; //ä¸å¯ä»¥ è¿™ç§æ‹·è´åˆå§‹åŒ–ä¸å¯ä»¥ï¼Œä¼šæŠ¥é”™ã€‚ 1atomic&lt;int&gt; atm2(atm.load()); load()ï¼šä»¥åŸå­æ–¹å¼è¯»atomicå¯¹è±¡çš„å€¼ã€‚ 1atm2.store(12); store()ï¼šä»¥åŸå­æ–¹å¼å†™ã€‚ å‚è€ƒï¼š https://www.cnblogs.com/chen-cs/p/13254219.html","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://marblemm.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"}],"tags":[]},{"title":"cpp11å¤šçº¿ç¨‹4-condition","slug":"cpp11å¤šçº¿ç¨‹4-condition","date":"2021-08-18T13:44:18.000Z","updated":"2021-08-27T16:44:57.259Z","comments":true,"path":"2021/08/18/cpp11å¤šçº¿ç¨‹4-condition/","link":"","permalink":"https://marblemm.github.io/2021/08/18/cpp11%E5%A4%9A%E7%BA%BF%E7%A8%8B4-condition/","excerpt":"","text":"std::condition_variableæ¡ä»¶å˜é‡æ˜¯C++11æä¾›çš„å¦å¤–ä¸€ç§çº¿ç¨‹åŒæ­¥æœºåˆ¶ï¼Œé€šè¿‡åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œå†³å®šæ˜¯å¦é˜»å¡çº¿ç¨‹ï¼Œå½“çº¿ç¨‹æ‰§è¡Œæ¡ä»¶æ»¡è¶³çš„æ—¶å€™å°±ä¼šå”¤é†’é˜»å¡çš„çº¿ç¨‹ï¼Œå¸¸ä¸std::mutexé…åˆä½¿ç”¨ï¼ŒC++11æä¾›äº†ä¸¤ç§æ¡ä»¶å˜é‡ã€‚ 123std::condition_variableï¼Œé…åˆstd::unique_lock&lt;std::mutex&gt;ä½¿ç”¨ï¼Œé€šè¿‡wait()å‡½æ•°é˜»å¡çº¿ç¨‹ï¼›std::condition_variable_anyï¼Œå¯ä»¥å’Œä»»æ„å¸¦æœ‰lock()ã€unlock()è¯­ä¹‰çš„std::mutexæ­é…ä½¿ç”¨ï¼Œæ¯”è¾ƒçµæ´»ï¼Œä½†æ˜¯å…¶æ•ˆç‡ä¸åŠstd::condition_variableï¼›std::unique_lockï¼šC++11æä¾›çš„ std::unique_lock æ˜¯é€šç”¨äº’æ–¥åŒ…è£…å™¨ï¼Œå…è®¸å»¶è¿Ÿé”å®šã€é”å®šçš„æœ‰æ—¶é™å°è¯•ã€é€’å½’é”å®šã€æ‰€æœ‰æƒè½¬ç§»å’Œä¸æ¡ä»¶å˜é‡ä¸€åŒä½¿ç”¨ã€‚std::unique_lockæ¯”std::lock_guardä½¿ç”¨æ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½æ›´åŠ å¼ºå¤§ã€‚ä½¿ç”¨std::unique_lockéœ€è¦ä»˜å‡ºæ›´å¤šçš„æ—¶é—´ã€æ€§èƒ½æˆæœ¬ã€‚ äº’æ–¥é”std::mutexæ˜¯ä¸€ç§æœ€å¸¸è§çš„çº¿ç¨‹é—´åŒæ­¥çš„æ‰‹æ®µï¼Œä½†æ˜¯åœ¨æœ‰äº›æƒ…å†µä¸‹ä¸å¤ªé«˜æ•ˆã€‚ å‡è®¾æƒ³å®ç°ä¸€ä¸ªç®€å•çš„æ¶ˆè´¹è€…ç”Ÿäº§è€…æ¨¡å‹ï¼Œä¸€ä¸ªçº¿ç¨‹å¾€é˜Ÿåˆ—ä¸­æ”¾å…¥æ•°æ®ï¼Œä¸€ä¸ªçº¿ç¨‹å¾€é˜Ÿåˆ—ä¸­å–æ•°æ®ï¼Œå–æ•°æ®å‰éœ€è¦åˆ¤æ–­ä¸€ä¸‹é˜Ÿåˆ—ä¸­ç¡®å®æœ‰æ•°æ®ï¼Œç”±äºè¿™ä¸ªé˜Ÿåˆ—æ˜¯çº¿ç¨‹é—´å…±äº«çš„ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä½¿ç”¨äº’æ–¥é”è¿›è¡Œä¿æŠ¤ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨å¾€é˜Ÿåˆ—æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½å–ï¼Œåä¹‹äº¦ç„¶ã€‚ç”¨äº’æ–¥é”å®ç°å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#include &lt;iostream&gt;#include &lt;deque&gt;#include &lt;thread&gt;#include &lt;mutex&gt;std::deque&lt;int&gt; q;std::mutex mu;void function_1() &#123; int count = 10; while (count &gt; 0) &#123; std::unique_lock&lt;std::mutex&gt; locker(mu); q.push_front(count); locker.unlock(); std::this_thread::sleep_for(std::chrono::seconds(1)); count--; &#125;&#125;void function_2() &#123; int data = 0; while ( data != 1) &#123; std::unique_lock&lt;std::mutex&gt; locker(mu); if (!q.empty()) &#123; data = q.back(); q.pop_back(); locker.unlock(); std::cout &lt;&lt; &quot;t2 got a value from t1: &quot; &lt;&lt; data &lt;&lt; std::endl; &#125; else &#123; locker.unlock(); &#125; &#125;&#125;int main() &#123; std::thread t1(function_1); std::thread t2(function_2); t1.join(); t2.join(); return 0;&#125;//è¾“å‡ºç»“æœ//t2 got a value from t1: 10//t2 got a value from t1: 9//t2 got a value from t1: 8//t2 got a value from t1: 7//t2 got a value from t1: 6//t2 got a value from t1: 5//t2 got a value from t1: 4//t2 got a value from t1: 3//t2 got a value from t1: 2//t2 got a value from t1: 1 â€‹å¯ä»¥çœ‹åˆ°ï¼Œäº’æ–¥é”å…¶å®å¯ä»¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œä½†æ˜¯å´å­˜åœ¨ç€æ€§èƒ½é—®é¢˜ã€‚ é¦–å…ˆï¼Œfunction_1å‡½æ•°æ˜¯ç”Ÿäº§è€…ï¼Œåœ¨ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œstd::this_thread::sleep_for(std::chrono::seconds(1));è¡¨ç¤ºå»¶æ—¶1sï¼Œæ‰€ä»¥è¿™ä¸ªç”Ÿäº§çš„è¿‡ç¨‹æ˜¯å¾ˆæ…¢çš„ï¼›function_2å‡½æ•°æ˜¯æ¶ˆè´¹è€…ï¼Œå­˜åœ¨ç€ä¸€ä¸ªwhileå¾ªç¯ï¼Œåªæœ‰åœ¨æ¥æ”¶åˆ°è¡¨ç¤ºç»“æŸçš„æ•°æ®çš„æ—¶å€™ï¼Œæ‰ä¼šåœæ­¢ï¼Œæ¯æ¬¡å¾ªç¯å†…éƒ¨ï¼Œéƒ½æ˜¯å…ˆåŠ é”ï¼Œåˆ¤æ–­é˜Ÿåˆ—ä¸ç©ºï¼Œç„¶åå°±å–å‡ºä¸€ä¸ªæ•°ï¼Œæœ€åè§£é”ã€‚æ‰€ä»¥è¯´ï¼Œåœ¨1så†…ï¼Œåšäº†å¾ˆå¤šæ— ç”¨åŠŸï¼è¿™æ ·çš„è¯ï¼ŒCPUå ç”¨ç‡ä¼šå¾ˆé«˜ï¼Œå¯èƒ½è¾¾åˆ°100%ï¼ˆå•æ ¸ï¼‰ã€‚å¦‚å›¾ï¼š è§£å†³åŠæ³•ä¹‹ä¸€æ˜¯ç»™æ¶ˆè´¹è€…ä¹ŸåŠ ä¸€ä¸ªå°å»¶æ—¶ï¼Œå¦‚æœä¸€æ¬¡åˆ¤æ–­åï¼Œå‘ç°é˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œå°±æƒ©ç½šä¸€ä¸‹è‡ªå·±ï¼Œå»¶æ—¶500msï¼Œè¿™æ ·å¯ä»¥å‡å°CPUçš„å ç”¨ç‡ã€‚ 123456789101112131415void function_2() &#123; int data = 0; while ( data != 1) &#123; std::unique_lock&lt;std::mutex&gt; locker(mu); if (!q.empty()) &#123; data = q.back(); q.pop_back(); locker.unlock(); std::cout &lt;&lt; &quot;t2 got a value from t1: &quot; &lt;&lt; data &lt;&lt; std::endl; &#125; else &#123; locker.unlock(); std::this_thread::sleep_for(std::chrono::milliseconds(500)); &#125; &#125;&#125; å¦‚å›¾ï¼š ç„¶åå›°éš¾ä¹‹å¤„åœ¨äºï¼Œå¦‚ä½•ç¡®å®šè¿™ä¸ªå»¶æ—¶æ—¶é—´å‘¢ï¼Œå‡å¦‚ç”Ÿäº§è€…ç”Ÿäº§çš„å¾ˆå¿«ï¼Œæ¶ˆè´¹è€…å´å»¶æ—¶500msï¼Œä¹Ÿä¸æ˜¯å¾ˆå¥½ï¼Œå¦‚æœç”Ÿäº§è€…ç”Ÿäº§çš„æ›´æ…¢ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…å»¶æ—¶500msï¼Œè¿˜æ˜¯ä¸å¿…è¦çš„å ç”¨äº†CPUã€‚ è¿™å°±å¼•å‡ºäº†æ¡ä»¶å˜é‡ï¼ˆcondition variableï¼‰,c++11ä¸­æä¾›äº†#include å¤´æ–‡ä»¶ï¼Œå…¶ä¸­çš„std::condition_variableå¯ä»¥å’Œstd::mutexç»“åˆä¸€èµ·ä½¿ç”¨ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¥å£ï¼Œnotify_one()å’Œwait()ï¼Œwait()å¯ä»¥è®©çº¿ç¨‹é™·å…¥ä¼‘çœ çŠ¶æ€ï¼Œåœ¨æ¶ˆè´¹è€…ç”Ÿäº§è€…æ¨¡å‹ä¸­ï¼Œå¦‚æœç”Ÿäº§è€…å‘ç°é˜Ÿåˆ—ä¸­æ²¡æœ‰ä¸œè¥¿ï¼Œå°±å¯ä»¥è®©è‡ªå·±ä¼‘çœ ï¼Œä½†æ˜¯ä¸èƒ½ä¸€ç›´ä¸å¹²æ´»å•Šï¼Œnotify_one()å°±æ˜¯å”¤é†’å¤„äºwaitä¸­çš„å…¶ä¸­ä¸€ä¸ªæ¡ä»¶å˜é‡ï¼ˆå¯èƒ½å½“æ—¶æœ‰å¾ˆå¤šæ¡ä»¶å˜é‡éƒ½å¤„äºwaitçŠ¶æ€ï¼‰ã€‚é‚£ä»€ä¹ˆæ—¶åˆ»ä½¿ç”¨notify_one()æ¯”è¾ƒå¥½å‘¢ï¼Œå½“ç„¶æ˜¯åœ¨ç”Ÿäº§è€…å¾€é˜Ÿåˆ—ä¸­æ”¾æ•°æ®çš„æ—¶å€™äº†ï¼Œé˜Ÿåˆ—ä¸­æœ‰æ•°æ®ï¼Œå°±å¯ä»¥èµ¶ç´§å«é†’ç­‰å¾…ä¸­çš„çº¿ç¨‹èµ·æ¥å¹²æ´»äº†ã€‚ ä½¿ç”¨æ¡ä»¶å˜é‡ä¿®æ”¹åå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041#include &lt;iostream&gt;#include &lt;deque&gt;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;condition_variable&gt;std::deque&lt;int&gt; q;std::mutex mu;std::condition_variable cond;void function_1() &#123; int count = 10; while (count &gt; 0) &#123; std::unique_lock&lt;std::mutex&gt; locker(mu); q.push_front(count); locker.unlock(); cond.notify_one(); // Notify one waiting thread, if there is one. std::this_thread::sleep_for(std::chrono::seconds(1)); count--; &#125;&#125;void function_2() &#123; int data = 0; while ( data != 1) &#123; std::unique_lock&lt;std::mutex&gt; locker(mu); while(q.empty()) cond.wait(locker); // Unlock mu and wait to be notified data = q.back(); q.pop_back(); locker.unlock(); std::cout &lt;&lt; &quot;t2 got a value from t1: &quot; &lt;&lt; data &lt;&lt; std::endl; &#125;&#125;int main() &#123; std::thread t1(function_1); std::thread t2(function_2); t1.join(); t2.join(); return 0;&#125; æ­¤æ—¶CPUçš„å ç”¨ç‡ä¹Ÿå¾ˆä½ã€‚ ä¸Šé¢çš„ä»£ç æœ‰ä¸‰ä¸ªæ³¨æ„äº‹é¡¹ï¼š åœ¨function_2ä¸­ï¼Œåœ¨åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºçš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯while(q.empty())ï¼Œè€Œä¸æ˜¯if(q.empty())ï¼Œè¿™æ˜¯å› ä¸ºwait()ä»é˜»å¡åˆ°è¿”å›ï¼Œä¸ä¸€å®šå°±æ˜¯ç”±äºnotify_one()å‡½æ•°é€ æˆçš„ï¼Œè¿˜æœ‰å¯èƒ½ç”±äºç³»ç»Ÿçš„ä¸ç¡®å®šåŸå› å”¤é†’ï¼ˆå¯èƒ½å’Œæ¡ä»¶å˜é‡çš„å®ç°æœºåˆ¶æœ‰å…³ï¼‰ï¼Œè¿™ä¸ªçš„æ—¶æœºå’Œé¢‘ç‡éƒ½æ˜¯ä¸ç¡®å®šçš„ï¼Œè¢«ç§°ä½œä¼ªå”¤é†’ï¼Œå¦‚æœåœ¨é”™è¯¯çš„æ—¶å€™è¢«å”¤é†’äº†ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥å°±ä¼šé”™è¯¯ï¼Œæ‰€ä»¥éœ€è¦å†æ¬¡åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœè¿˜æ˜¯ä¸ºç©ºï¼Œå°±ç»§ç»­wait()é˜»å¡ã€‚ åœ¨ç®¡ç†äº’æ–¥é”çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯std::unique_lockè€Œä¸æ˜¯std::lock_guardï¼Œè€Œä¸”äº‹å®ä¸Šä¹Ÿä¸èƒ½ä½¿ç”¨std::lock_guardï¼Œè¿™éœ€è¦å…ˆè§£é‡Šä¸‹wait()å‡½æ•°æ‰€åšçš„äº‹æƒ…ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨wait()å‡½æ•°ä¹‹å‰ï¼Œä½¿ç”¨äº’æ–¥é”ä¿æŠ¤äº†ï¼Œå¦‚æœwaitçš„æ—¶å€™ä»€ä¹ˆéƒ½æ²¡åšï¼Œå²‚ä¸æ˜¯ä¸€ç›´æŒæœ‰äº’æ–¥é”ï¼Ÿé‚£ç”Ÿäº§è€…ä¹Ÿä¼šä¸€ç›´å¡ä½ï¼Œä¸èƒ½å¤Ÿå°†æ•°æ®æ”¾å…¥é˜Ÿåˆ—ä¸­äº†ã€‚æ‰€ä»¥ï¼Œwait()å‡½æ•°ä¼šå…ˆè°ƒç”¨äº’æ–¥é”çš„unlock()å‡½æ•°ï¼Œç„¶åå†å°†è‡ªå·±ç¡çœ ï¼Œåœ¨è¢«å”¤é†’åï¼Œåˆä¼šç»§ç»­æŒæœ‰é”ï¼Œä¿æŠ¤åé¢çš„é˜Ÿåˆ—æ“ä½œã€‚è€Œlock_guardæ²¡æœ‰lockå’Œunlockæ¥å£ï¼Œè€Œunique_lockæä¾›äº†ã€‚è¿™å°±æ˜¯å¿…é¡»ä½¿ç”¨unique_lockçš„åŸå› ã€‚ ä½¿ç”¨ç»†ç²’åº¦é”ï¼Œå°½é‡å‡å°é”çš„èŒƒå›´ï¼Œåœ¨notify_one()çš„æ—¶å€™ï¼Œä¸éœ€è¦å¤„äºäº’æ–¥é”çš„ä¿æŠ¤èŒƒå›´å†…ï¼Œæ‰€ä»¥åœ¨å”¤é†’æ¡ä»¶å˜é‡ä¹‹å‰å¯ä»¥å°†é”unlock()ã€‚ è¿˜å¯ä»¥å°†cond.wait(locker);æ¢ä¸€ç§å†™æ³•ï¼Œwait()çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°è¡¨ç¤ºæ£€æŸ¥æ¡ä»¶ï¼Œè¿™é‡Œä½¿ç”¨lambdaå‡½æ•°æœ€ä¸ºç®€å•ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯trueï¼Œwait()å‡½æ•°ä¸ä¼šé˜»å¡ä¼šç›´æ¥è¿”å›ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯falseï¼Œwait()å‡½æ•°å°±ä¼šé˜»å¡ç€ç­‰å¾…å”¤é†’ï¼Œå¦‚æœè¢«ä¼ªå”¤é†’ï¼Œä¼šç»§ç»­åˆ¤æ–­å‡½æ•°è¿”å›å€¼ã€‚ 1234567891011void function_2() &#123; int data = 0; while ( data != 1) &#123; std::unique_lock&lt;std::mutex&gt; locker(mu); cond.wait(locker, []()&#123; return !q.empty();&#125; ); // Unlock mu and wait to be notified data = q.back(); q.pop_back(); locker.unlock(); std::cout &lt;&lt; &quot;t2 got a value from t1: &quot; &lt;&lt; data &lt;&lt; std::endl; &#125;&#125; é™¤äº†notify_one()å‡½æ•°ï¼Œc++è¿˜æä¾›äº†notify_all()å‡½æ•°ï¼Œå¯ä»¥åŒæ—¶å”¤é†’æ‰€æœ‰å¤„äºwaitçŠ¶æ€çš„æ¡ä»¶å˜é‡ã€‚ å‚è€ƒï¼š https://www.jianshu.com/p/c1dfa1d40f53","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://marblemm.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"}],"tags":[]},{"title":"cpp11å¤šçº¿ç¨‹3-mutex","slug":"cpp11å¤šçº¿ç¨‹3-mutex","date":"2021-08-17T13:22:05.000Z","updated":"2021-08-27T16:44:52.294Z","comments":true,"path":"2021/08/17/cpp11å¤šçº¿ç¨‹3-mutex/","link":"","permalink":"https://marblemm.github.io/2021/08/17/cpp11%E5%A4%9A%E7%BA%BF%E7%A8%8B3-mutex/","excerpt":"","text":"std::mutexè¿›å…¥å¤šçº¿ç¨‹ç¼–ç¨‹çš„ä¸–ç•Œï¼Œé™¤äº†è¦ç‰¢ç‰¢æŒæ¡std::threadä½¿ç”¨æ–¹æ³•ï¼Œè¿˜è¦æŒæ¡äº’æ–¥é‡ï¼ˆé”ï¼‰çš„ä½¿ç”¨ï¼Œè¿™æ˜¯ä¸€ç§çº¿ç¨‹åŒæ­¥æœºåˆ¶ï¼Œåœ¨C++11ä¸­æä¾›äº†4ä¸­äº’æ–¥é‡ã€‚ 1234std::mutex; //éé€’å½’çš„äº’æ–¥é‡std::timed_mutex; //å¸¦è¶…æ—¶çš„éé€’å½’äº’æ–¥é‡std::recursive_mutex; //é€’å½’äº’æ–¥é‡std::recursive_timed_mutex; //å¸¦è¶…æ—¶çš„é€’å½’äº’æ–¥é‡ ä»å„ç§äº’æ–¥é‡çš„åå­—å¯ä»¥çœ‹å‡ºå…¶å…·æœ‰çš„ç‰¹æ€§ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¸¸ç”¨å°±æ˜¯std::mutexï¼Œå®ƒå°±åƒæ˜¯ä¸€æŠŠé”ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å¯¹å®ƒè¿›è¡ŒåŠ é”ä¸è§£é”ã€‚ 12345678910111213141516171819202122232425262728#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;chrono&gt;â€‹std::mutex g_mutex;void func()&#123; std::cout &lt;&lt; &quot;entry func test thread ID is : &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; std::this_thread::sleep_for(std::chrono::microseconds(1000)); std::cout &lt;&lt; &quot;leave func test thread ID is : &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl;&#125;int main()&#123; std::thread t1(func); std::thread t2(func); std::thread t3(func); std::thread t4(func); std::thread t5(func); t1.join(); t2.join(); t3.join(); t4.join(); t5.join(); return 0;&#125; åˆ›å»ºäº†5ä¸ªçº¿ç¨‹ï¼Œç„¶ååˆ†åˆ«è°ƒç”¨func()å‡½æ•°ï¼Œå¾—åˆ°ç»“æœï¼š 12345678910entry func test thread ID is : entry func test thread ID is : 19180entry func test thread ID is : 359613632entry func test thread ID is : 9520entry func test thread ID is : 4460leave func test thread ID is : 13632leave func test thread ID is : 19180leave func test thread ID is : leave func test thread ID is : 95203596leave func test thread ID is : 4460 å¯ä»¥çœ‹å‡ºï¼Œå¹¶æ²¡æœ‰æŒ‰é¡ºåºå»æ‰§è¡Œçº¿ç¨‹å‡½æ•°ï¼Œåé¢åˆ›å»ºçš„çº¿ç¨‹å¹¶æ²¡æœ‰ç­‰å¾…å‰é¢çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œå¯¼è‡´ç»“æœæ··ä¹±ï¼Œä¸‹é¢ç”¨std::mutexè¿›è¡Œæ§åˆ¶ï¼š ä¿æŠ¤å…±äº«æ•°æ®çš„æœ€åŸºæœ¬çš„æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨C++æ ‡å‡†åº“æä¾›çš„äº’æ–¥é‡ï¼ˆå¤´æ–‡ä»¶ï¼‰ã€‚å½“è®¿é—®å…±äº«æ•°æ®å‰ï¼Œä½¿ç”¨äº’æ–¥é‡å°†ç›¸å…³æ•°æ®é”ä½ï¼Œå†å½“è®¿é—®ç»“æŸåï¼Œå†å°†æ•°æ®è§£é”ã€‚çº¿ç¨‹åº“éœ€è¦ä¿è¯ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ç‰¹å®šäº’æ–¥é‡é”ä½å…±äº«æ•°æ®æ—¶ï¼Œå…¶ä»–çš„çº¿ç¨‹æƒ³è¦è®¿é—®é”ä½çš„æ•°æ®ï¼Œéƒ½å¿…é¡»ç­‰åˆ°ä¹‹å‰é‚£ä¸ªçº¿ç¨‹å¯¹æ•°æ®è¿›è¡Œè§£é”åï¼Œæ‰èƒ½è¿›è¡Œè®¿é—®ã€‚è¿™å°±ä¿è¯äº†æ‰€æœ‰çº¿ç¨‹èƒ½çœ‹åˆ°å…±äº«æ•°æ®ï¼Œè€Œä¸ç ´åä¸å˜é‡ã€‚ C++ä¸­é€šè¿‡å®ä¾‹åŒ– std::mutex åˆ›å»ºäº’æ–¥é‡ï¼Œé€šè¿‡è°ƒç”¨æˆå‘˜å‡½æ•°lock()è¿›è¡Œä¸Šé”ï¼Œunlock()è¿›è¡Œè§£é”ã€‚ 1234567891011121314151617181920212223242526272829303132#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;chrono&gt;â€‹std::mutex g_mutex;using namespace std;void func()&#123; g_mutex.lock(); std::cout &lt;&lt; &quot;entry func test thread ID is : &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; std::this_thread::sleep_for(std::chrono::microseconds(1000)); std::cout &lt;&lt; &quot;leave func test thread ID is : &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; g_mutex.unlock();&#125;int main()&#123; std::thread t1(func); std::thread t2(func); std::thread t3(func); std::thread t4(func); std::thread t5(func); t1.join(); t2.join(); t3.join(); t4.join(); t5.join(); return 0;&#125; åªè¦çº¿ç¨‹è¿›å…¥func()å‡½æ•°å°±è¿›è¡ŒåŠ é”å¤„ç†ï¼Œå½“çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åè¿›è¡Œè§£é”ï¼Œä¿è¯æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½æŒ‰é¡ºåºæ‰§è¡Œï¼Œè¾“å‡ºç»“æœï¼š 12345678910entry func test thread ID is : 8852leave func test thread ID is : 8852entry func test thread ID is : 15464leave func test thread ID is : 15464entry func test thread ID is : 17600leave func test thread ID is : 17600entry func test thread ID is : 16084leave func test thread ID is : 16084entry func test thread ID is : 4156leave func test thread ID is : 4156 è™½ç„¶é€šè¿‡lock()ä¸unlock()å¯ä»¥è§£å†³çº¿ç¨‹ä¹‹é—´çš„èµ„æºç«äº‰é—®é¢˜ï¼Œä½†æ˜¯è¿™é‡Œä¹Ÿå­˜åœ¨ä¸è¶³ã€‚ 123456789101112func()&#123; //åŠ é” æ‰§è¡Œé€»è¾‘å¤„ç†; //å¦‚æœè¯¥è¿‡ç¨‹æŠ›å‡ºå¼‚å¸¸å¯¼è‡´ç¨‹åºé€€å‡ºäº†ï¼Œå°±æ²¡æ³•unlock //è§£é” &#125;â€‹int main()&#123; ......&#125; func()ä¸­å†æ‰§è¡Œé€»è¾‘å¤„ç†ä¸­ç¨‹åºå› ä¸ºæŸäº›åŸå› é€€å‡ºäº†ï¼Œæ­¤æ—¶å°±æ— æ³•unlock()äº†ï¼Œè¿™æ ·å…¶ä»–çº¿ç¨‹ä¹Ÿå°±æ— æ³•è·å–std::mutexï¼Œé€ æˆæ­»é”ç°è±¡ï¼Œå…¶å®åœ¨åŠ é”ä¹‹å‰å¯ä»¥é€šè¿‡trylock()å°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½åŠ é”ã€‚å®é™…å¼€å‘ä¸­ï¼Œé€šå¸¸ä¹Ÿä¸ä¼šè¿™æ ·å†™ä»£ç ï¼Œè€Œæ˜¯é‡‡ç”¨lock_guardæ¥æ§åˆ¶std::mutexã€‚ 1234567891011121314151617181920212223242526template &lt;class _Mutex&gt;class lock_guard &#123; public: using mutex_type = _Mutex;â€‹ explicit lock_guard(_Mutex&amp; _Mtx) : _MyMutex(_Mtx) &#123; _MyMutex.lock(); //æ„é€ å‡½æ•°åŠ é” &#125;â€‹ lock_guard(_Mutex&amp; _Mtx, adopt_lock_t) : _MyMutex(_Mtx) &#123; &#125;â€‹ ~lock_guard() noexcept &#123; _MyMutex.unlock(); //ææ„å‡½æ•°è§£é” &#125;â€‹ lock_guard(const lock_guard&amp;) = delete; lock_guard&amp; operator=(const lock_guard&amp;) = delete;â€‹private: _Mutex&amp; _MyMutex;&#125;;â€‹ lock_guardæ˜¯ç±»æ¨¡æ¿ï¼Œåœ¨å…¶æ„é€ å‡½æ•°ä¸­è‡ªåŠ¨ç»™std::mutexåŠ é”ï¼Œåœ¨é€€å‡ºä½œç”¨åŸŸçš„æ—¶å€™è‡ªåŠ¨è§£é”ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯std::mutexçš„æ­£ç¡®æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯RAIIï¼ˆè·å–èµ„æºä¾¿åˆå§‹åŒ–ï¼‰æŠ€æœ¯çš„ä½“ç°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;chrono&gt;â€‹std::mutex g_mutex;void func()&#123; std::lock_guard&lt;std::mutex&gt; lock(g_mutex); //åŠ é” std::cout &lt;&lt; &quot;entry func test thread ID is : &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; std::this_thread::sleep_for(std::chrono::microseconds(1000)); std::cout &lt;&lt; &quot;leave func test thread ID is : &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; //é€€å‡ºä½œç”¨åŸŸåï¼Œlock_guardå¯¹è±¡ææ„å°±è‡ªåŠ¨è§£é”&#125;int main()&#123; std::thread t1(func); std::thread t2(func); std::thread t3(func); std::thread t4(func); std::thread t5(func); t1.join(); t2.join(); t3.join(); t4.join(); t5.join(); return 0;&#125;è¿è¡Œç»“æœï¼šentry func test thread ID is : 19164leave func test thread ID is : 19164entry func test thread ID is : 15124leave func test thread ID is : 15124entry func test thread ID is : 2816leave func test thread ID is : 2816entry func test thread ID is : 17584leave func test thread ID is : 17584entry func test thread ID is : 15792leave func test thread ID is : 15792 ä½†äº’æ–¥é‡è‡ªèº«ä¹Ÿæœ‰é—®é¢˜ã€‚ å½“å…¶ä¸­ä¸€ä¸ªæˆå‘˜å‡½æ•°è¿”å›çš„æ˜¯ä¿æŠ¤æ•°æ®çš„æŒ‡é’ˆæˆ–å¼•ç”¨æ—¶ï¼Œä¼šç ´åå¯¹æ•°æ®çš„ä¿æŠ¤ã€‚å…·æœ‰è®¿é—®èƒ½åŠ›çš„æŒ‡é’ˆæˆ–å¼•ç”¨å¯ä»¥è®¿é—®(å¹¶å¯èƒ½ä¿®æ”¹)è¢«ä¿æŠ¤çš„æ•°æ®ï¼Œè€Œä¸ä¼šè¢«äº’æ–¥é”é™åˆ¶ã€‚æ‰€ä»¥åˆ‡å‹¿å°†å—ä¿æŠ¤æ•°æ®çš„æŒ‡é’ˆæˆ–å¼•ç”¨ä¼ é€’åˆ°äº’æ–¥é”ä½œç”¨åŸŸä¹‹å¤–ï¼Œæ— è®ºæ˜¯å‡½æ•°è¿”å›å€¼ï¼Œè¿˜æ˜¯å­˜å‚¨åœ¨å¤–éƒ¨å¯è§å†…å­˜ï¼Œäº¦æˆ–æ˜¯ä»¥å‚æ•°çš„å½¢å¼ä¼ é€’åˆ°ç”¨æˆ·æä¾›çš„å‡½æ•°ä¸­å»ã€‚ å¦å¤–è¿˜ä¼šé€ æˆæ­»é”ï¼Œæˆ–æ˜¯å¯¹æ•°æ®ä¿æŠ¤çš„å¤ªå¤š(æˆ–å¤ªå°‘)çš„é—®é¢˜ã€‚ å‚è€ƒï¼š https://www.cnblogs.com/chen-cs/p/13060353.html","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://marblemm.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"}],"tags":[]},{"title":"cpp11å¤šçº¿ç¨‹2-joinæ³¨æ„","slug":"cpp11å¤šçº¿ç¨‹2-joinæ³¨æ„","date":"2021-08-16T12:24:06.000Z","updated":"2021-08-27T16:42:34.270Z","comments":true,"path":"2021/08/16/cpp11å¤šçº¿ç¨‹2-joinæ³¨æ„/","link":"","permalink":"https://marblemm.github.io/2021/08/16/cpp11%E5%A4%9A%E7%BA%BF%E7%A8%8B2-join%E6%B3%A8%E6%84%8F/","excerpt":"","text":"join()å‡½æ•°çš„ä½œç”¨æ˜¯è®©ä¸»çº¿ç¨‹çš„ç­‰å¾…è¯¥å­çº¿ç¨‹å®Œæˆï¼Œç„¶åä¸»çº¿ç¨‹å†ç»§ç»­æ‰§è¡Œã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå­çº¿ç¨‹å¯ä»¥å®‰å…¨çš„è®¿é—®ä¸»çº¿ç¨‹ä¸­çš„èµ„æºã€‚å­çº¿ç¨‹ç»“æŸåç”±ä¸»çº¿ç¨‹è´Ÿè´£å›æ”¶å­çº¿ç¨‹èµ„æºã€‚ä¸€ä¸ªå­çº¿ç¨‹åªèƒ½è°ƒç”¨join()å’Œdetach()ä¸­çš„ä¸€ä¸ªï¼Œä¸”åªå…è®¸è°ƒç”¨ä¸€æ¬¡ã€‚å¯ä»¥è°ƒç”¨joinable()æ¥åˆ¤æ–­æ˜¯å¦å¯ä»¥æˆåŠŸè°ƒç”¨join()æˆ–detach()ã€‚ 123456789101112131415161718192021222324252627282930#include &lt;thread&gt;#include &lt;iostream&gt;using namespace std;void test()&#123; cout &lt;&lt; &quot;å­çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; //do something cout &lt;&lt; &quot;å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼&quot; &lt;&lt; endl;&#125;int main()&#123; cout &lt;&lt; &quot;ä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; thread t(test); cout &lt;&lt; &quot;join()æ˜¯å¦å¯è°ƒï¼š&quot; &lt;&lt; boolalpha &lt;&lt; t.joinable() &lt;&lt; endl; t.join(); //ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ cout &lt;&lt; &quot;join()æ˜¯å¦å¯è°ƒï¼š&quot; &lt;&lt; boolalpha &lt;&lt; t.joinable() &lt;&lt; endl; cout &lt;&lt; &quot;ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼&quot; &lt;&lt; endl; return 0;&#125;ç»“æœè¾“å‡ºï¼šä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼join()æ˜¯å¦å¯è°ƒï¼štrueå­çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼join()æ˜¯å¦å¯è°ƒï¼šfalseä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼ æ³¨æ„ 1ã€ä¸ºäº†ç¡®ä¿å­çº¿ç¨‹ç¨‹åºåœ¨å‘é€å¼‚å¸¸é€€å‡ºå‰å®Œæˆï¼Œå°±éœ€è¦å¯¹æ³¨æ„è°ƒç”¨join()å‡½æ•°çš„ä½ç½®ï¼Œå¦åˆ™å½“ä¸»çº¿å‘ç”Ÿå¼‚å¸¸è€Œæ­¤æ—¶è¿˜æ²¡æœ‰è°ƒç”¨åˆ°join()å‡½æ•°ï¼Œé‚£ä¹ˆå­çº¿ç¨‹éšä¸»çº¿ç¨‹ç»ˆæ­¢ã€‚è§£å†³æ–¹æ³•æ˜¯åœ¨å¼‚å¸¸å¤„ç†ä¸­è°ƒç”¨join()ã€‚ å¼‚å¸¸å‘ç”Ÿçš„æƒ…å†µï¼Œå­çº¿ç¨‹æ²¡æœ‰å®Œæˆå°±éšä¸»çº¿ç¨‹ç»ˆæ­¢ã€‚ 123456789101112131415161718192021222324#include &lt;thread&gt;#include &lt;iostream&gt;using namespace std;static void func()&#123; cout &lt;&lt; &quot;å­çº¿ç¨‹funcå¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; //do something int i = 100000; while (i--) &#123;&#125; cout &lt;&lt; &quot;å­çº¿ç¨‹funcæ‰§è¡Œç»“æŸï¼&quot; &lt;&lt; endl;&#125;int main()&#123; cout &lt;&lt; &quot;ä¸»çº¿ç¨‹mainå¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; thread t(func); throw 123; t.join(); cout &lt;&lt; &quot;ä¸»çº¿ç¨‹mainæ‰§è¡Œç»“æŸï¼&quot; &lt;&lt; endl; return 0;&#125; åœ¨å¼‚å¸¸å¤„ç†ä¸­è°ƒç”¨join() 12345678910111213141516171819202122232425262728293031323334353637#include &lt;thread&gt;#include &lt;iostream&gt;#include &lt;cstdlib&gt; //for rand()using namespace std;void func()&#123; cout &lt;&lt; &quot;å­çº¿ç¨‹funcå¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; //do something int i = 100000; while(i--) &#123; &#125; cout &lt;&lt; &quot;å­çº¿ç¨‹funcæ‰§è¡Œç»“æŸï¼&quot; &lt;&lt; endl;&#125;int main()&#123; cout &lt;&lt; &quot;ä¸»çº¿ç¨‹mainå¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; thread t(func); try &#123; //do something if (rand() % 7) //éšæœºæŠ›å‡ºå¼‚å¸¸æ¥æ¨¡æ‹Ÿå¼‚å¸¸å‘ç”Ÿ &#123; throw 123; &#125; &#125; catch(...) &#123; //do something t.join(); abort(); //ç»ˆæ­¢ä¸»çº¿ç¨‹ &#125; t.join(); //æœªå‘ç”Ÿå¼‚å¸¸æ—¶ä½¿ç”¨ cout &lt;&lt; &quot;ä¸»çº¿ç¨‹mainæ‰§è¡Œç»“æŸï¼&quot; &lt;&lt; endl; return 0;&#125; 2ã€ä¸ºäº†åº”å¯¹å¿˜è®°ä½¿ç”¨join()å’Œé€‰æ‹©ä½ç½®çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨RAIIæœºåˆ¶æ¥ç®¡ç†å­çº¿ç¨‹ï¼Œåœ¨RAIIææ„ä¸­è°ƒç”¨join()ã€‚è¿™æ ·åœ¨æˆ‘æ ¹æœ¬ä¸éœ€è¦è€ƒè™‘joinçš„ä½ç½®é—®é¢˜ï¼Œè¿˜æ˜¯æ˜¯å¦å¿˜è®°çš„é—®é¢˜ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹å¼åœ¨ç¨‹åºå¼‚å¸¸çš„æƒ…å†µä¸‹å¹¶ä¸èƒ½ä¿è¯ä¸»çº¿ç¨‹è¢«ç»ˆæ­¢æ—¶ï¼Œå­çº¿ç¨‹æ‰§è¡Œç»“æŸã€‚å› ä¸ºç¨‹åºå› å¼‚å¸¸è€Œç»ˆæ­¢æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ•è·ï¼Œå¯¹è±¡çš„ææ„ä¸ä¼šå‘ç”Ÿï¼Œåªèƒ½ç”±ç³»ç»Ÿæ¥å›æ”¶èµ„æºã€‚å…³äºRAIIï¼šcppä¸­çš„RAIIæœºåˆ¶ ä½¿ç”¨RAIIåœ¨ææ„ä¸­è°ƒç”¨join() 123456789101112131415161718192021222324252627282930313233343536373839#include &lt;thread&gt;#include &lt;iostream&gt;using namespace std;void func()&#123; cout &lt;&lt; &quot;å­çº¿ç¨‹funcå¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; //do something int i = 100000 ; while(i--) &#123; &#125; cout &lt;&lt; &quot;å­çº¿ç¨‹funcæ‰§è¡Œç»“æŸï¼&quot; &lt;&lt; endl;&#125;class RAII_thread&#123; thread&amp; t;public: explicit RAII_thread(thread&amp; t_): t(t_) &#123; &#125; ~RAII_thread()&#123; if(t.joinable()) t.join(); &#125; RAII_thread(RAII_thread const&amp;) = delete; RAII_thread&amp; operator=(RAII_thread const&amp;) = delete;&#125;;int main()&#123; //ç¡®ä¿å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•çš„æŠ€å·§2ï¼Œä½¿ç”¨RAIIç®¡ç†å­çº¿ç¨‹ cout &lt;&lt; &quot;ä¸»çº¿ç¨‹mainå¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; thread t(func); RAII_thread raii(t); //do something cout &lt;&lt; &quot;ä¸»çº¿ç¨‹mainæ‰§è¡Œç»“æŸï¼&quot; &lt;&lt; endl; return 0;&#125;","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://marblemm.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"}],"tags":[]},{"title":"cpp11å¤šçº¿ç¨‹1-thread","slug":"cpp11å¤šçº¿ç¨‹1-thread","date":"2021-08-15T12:08:58.000Z","updated":"2021-08-27T16:44:45.117Z","comments":true,"path":"2021/08/15/cpp11å¤šçº¿ç¨‹1-thread/","link":"","permalink":"https://marblemm.github.io/2021/08/15/cpp11%E5%A4%9A%E7%BA%BF%E7%A8%8B1-thread/","excerpt":"","text":"std::threadåœ¨C++11ä¹‹å‰ï¼ŒC++è¯­è¨€å±‚é¢æ˜¯ä¸æ”¯æŒå¤šçº¿ç¨‹çš„ï¼Œæƒ³åˆ©ç”¨C++å®ç°å¹¶å‘ç¨‹åºï¼Œå€ŸåŠ©æ“ä½œç³»ç»Ÿçš„APIå®ç°è·¨å¹³å°çš„å¹¶å‘ç¨‹åºå­˜åœ¨ç€è¯¸å¤šä¸ä¾¿ï¼Œå½“C++11åœ¨è¯­è¨€å±‚é¢æ”¯æŒå¤šçº¿ç¨‹åï¼Œç¼–å†™è·¨å¹³å°çš„å¤šçº¿ç¨‹ä»£ç å°±æ–¹ä¾¿äº†è®¸å¤šã€‚ C++11æä¾›çš„std::threadåœ¨å¼€å‘å¤šçº¿ç¨‹æ–¹é¢å¸¦æ¥äº†ä¾¿æ·ã€‚ 123456789101112131415#include &lt;iostream&gt;#include &lt;thread&gt;â€‹void threadfunc()&#123; std::cout &lt;&lt; &quot;thread func&quot; &lt;&lt; std::endl;&#125;â€‹â€‹int main()&#123; std::thread t1(threadfunc); t1.join(); //ç­‰å¾…threadfuncè¿è¡Œç»“æŸ return 0;&#125; é¦–å…ˆå®šä¹‰çº¿ç¨‹å¯¹è±¡t1ï¼Œçº¿ç¨‹å‡½æ•°threadfuncè¿è¡Œåœ¨çº¿ç¨‹å¯¹è±¡t1ä¸­ï¼Œå½“çº¿ç¨‹åˆ›å»ºæˆåŠŸå¹¶æ‰§è¡Œçº¿ç¨‹å‡½æ•°åï¼Œä¸€å®šè¦ä¿è¯çº¿ç¨‹å‡½æ•°è¿è¡Œç»“æŸæ‰èƒ½é€€å‡ºï¼Œè¿™é‡Œè°ƒç”¨äº†join()å‡½æ•°é˜»å¡çº¿ç¨‹ï¼Œç›´åˆ°threadfunc()è¿è¡Œç»“æŸï¼Œå›æ”¶å¯¹åº”åˆ›å»ºçº¿ç¨‹çš„èµ„æºã€‚å¦‚æœä¸é˜»å¡çº¿ç¨‹ï¼Œå°±ä¸èƒ½ä¿è¯çº¿ç¨‹å¯¹è±¡t1åœ¨threadfunc()è¿è¡ŒæœŸé—´æœ‰æ•ˆï¼Œä¸‹é¢ä¸è°ƒç”¨join()é˜»å¡çº¿ç¨‹ã€‚ 12345678910111213141516171819202122#include &lt;iostream&gt;#include &lt;thread&gt;â€‹void threadfunc()&#123; std::cout &lt;&lt; &quot;thread func&quot; &lt;&lt; std::endl;&#125;â€‹â€‹int main()&#123; std::thread t1(threadfunc); //t1.join(); //ç­‰å¾…threadfuncè¿è¡Œç»“æŸ return 0;&#125;````åœ¨è¿è¡Œæ—¶å¼•èµ·äº†ç¨‹åºå´©æºƒã€‚![error1.jpg](error1.jpg)é™¤äº†è°ƒç”¨join()é˜»å¡çº¿ç¨‹ï¼Œä¿è¯çº¿ç¨‹å¯¹è±¡åœ¨çº¿ç¨‹å‡½æ•°è¿è¡ŒæœŸé—´çš„æœ‰æ•ˆæ€§ï¼Œè¿˜å¯ä»¥é€šè¿‡çº¿ç¨‹åˆ†ç¦»çš„æ‰‹æ®µå®ç°ï¼Œè°ƒç”¨detach()å‡½æ•°ä½¿å¾—çº¿ç¨‹å¯¹è±¡ä¸çº¿ç¨‹å‡½æ•°åˆ†ç¦»ï¼Œè¿™æ ·ï¼Œåœ¨çº¿ç¨‹å‡½æ•°è¿è¡ŒæœŸé—´ï¼Œçº¿ç¨‹å¯¹è±¡ä¸çº¿ç¨‹å‡½æ•°å°±æ²¡æœ‰è”ç³»äº†ï¼Œæ­¤æ—¶çš„çº¿ç¨‹æ˜¯ä½œä¸ºåå°çº¿ç¨‹å»æ‰§è¡Œï¼Œdetach()åå°±æ— æ³•å†å’Œçº¿ç¨‹å‘ç”Ÿè”ç³»ï¼Œä¹Ÿä¸èƒ½é€šè¿‡join()æ¥ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œçº¿ç¨‹ä½•æ—¶æ‰§è¡Œå®Œæ— æ³•æ§åˆ¶ï¼Œå®ƒçš„èµ„æºä¼šè¢«initè¿›ç¨‹å›æ”¶ï¼Œæ‰€ä»¥ï¼Œé€šå¸¸ä¸é‡‡ç”¨detach()æ–¹æ³•ã€‚ #include #include â€‹void threadfunc(){ std::cout &lt;&lt; â€œ detach thread funcâ€ &lt;&lt; std::endl;}â€‹int main(){ std::thread t1(threadfunc); t1.detach(); //çº¿ç¨‹åˆ†ç¦»â€‹ return 0;} 12è¿™é‡Œè°ƒç”¨detach()å®ç°çº¿ç¨‹åˆ†ç¦»ï¼Œä½†æ˜¯è¿è¡Œåï¼Œä¸»çº¿ç¨‹é€€å‡ºçš„æ—¶å€™threadfunc()è¿˜æ²¡æœ‰è¾“å‡ºâ€œdetach thread funcâ€ï¼Œthreadfunc()ä»€ä¹ˆæ—¶å€™è¿è¡Œç»“æŸä¹Ÿæ— æ³•ç¡®å®šï¼Œä¸ºäº†çœ‹åˆ°æ‰€åˆ›å»ºçš„çº¿ç¨‹è¿è¡Œç»“æœï¼Œåœ¨ä¸»çº¿ç¨‹ç­‰å¾…ä¸€ä¸‹å†é€€å‡ºã€‚ #include #include #include //æ—¶é—´â€‹void threadfunc(){ std::cout &lt;&lt; â€œdetach thread funcâ€ &lt;&lt; std::endl;}â€‹int main(){ std::thread t1(threadfunc); t1.detach(); while (true) { std::this_thread::sleep_for(std::chrono::milliseconds(1000));//ç¡çœ 1000æ¯«ç§’ break; } return 0; } 1æ­¤æ—¶è¿è¡Œç»“æœï¼š detach thread func 1é€šè¿‡std::threadåˆ›å»ºçš„çº¿ç¨‹æ˜¯ä¸å¯ä»¥å¤åˆ¶çš„ï¼Œä½†æ˜¯å¯ä»¥ç§»åŠ¨ã€‚ #include #include #include â€‹void threadfunc(){ std::cout &lt;&lt; â€œmove thread funcâ€ &lt;&lt; std::endl;}â€‹int main(){ std::thread t1(threadfunc); std::thread t2(std::move(t1)); t2.join(); while (true) &#123; std::this_thread::sleep_for(std::chrono::milliseconds(1000));//ç¡çœ 1000æ¯«ç§’ break; &#125; return 0; } 1è¾“å‡ºç»“æœï¼š move thread func 1234567ç§»åŠ¨åt1å°±ä¸ä»£è¡¨ä»»ä½•çº¿ç¨‹äº†ï¼Œt2å¯¹è±¡ä»£è¡¨ç€çº¿ç¨‹threadfunc()ã€‚## å…¶ä»–åˆ›å»ºçº¿ç¨‹æ–¹å¼### é€šè¿‡std::bindæ¥åˆ›å»ºçº¿ç¨‹å‡½æ•°ã€‚ #include #include #include //æ—¶é—´#include //std::bindâ€‹class A {public: void threadfunc() { std::cout &lt;&lt; â€œbind thread funcâ€ &lt;&lt; std::endl; }};â€‹â€‹int main(){ A a; std::thread t1(std::bind(&amp;A::threadfunc,&amp;a)); t1.join(); while (true) { std::this_thread::sleep_for(std::chrono::milliseconds(1000));//ç¡çœ 1000æ¯«ç§’ break; } return 0; } åˆ›å»ºä¸€ä¸ªç±»Aï¼Œç„¶åå†mainå‡½æ•°ä¸­å°†ç±»Aä¸­çš„æˆå‘˜å‡½æ•°ç»‘å®šåˆ°çº¿ç¨‹å¯¹è±¡t1ä¸Šï¼Œè¿è¡Œç»“æœï¼š 1bind thread func ### ä»¿å‡½æ•°å¯¹è±¡ 1234567891011121314151617181920#include &lt;thread&gt;#include &lt;iostream&gt;using namespace std;class Test&#123;public: void operator()()&#123; cout &lt;&lt; &quot;å­çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; //do something cout &lt;&lt; &quot;å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼&quot; &lt;&lt; endl; &#125;&#125;;int main()&#123; // thread t(Test()); è¿™ç§å†™æ³•ä¼šç¼–è¯‘å™¨ä¼šè®¤ä¸ºæ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜ï¼Œè¿™ä¸ªå‡½æ•°å¸¦æœ‰ä¸€ä¸ªå‚æ•°(å‡½æ•°æŒ‡é’ˆæŒ‡å‘æ²¡æœ‰å‚æ•°å¹¶è¿”å›Testå¯¹è±¡çš„å‡½æ•°) thread t((Test())); //å¯ä»¥ä½¿ç”¨åŠ å°æ‹¬å·ï¼Œæˆ–è€…ä½¿ç”¨ä¸€åªåˆå§‹åŒ–ï¼Œæˆ–è€…ä¼ å…¥å‘½åå˜é‡ t.join(); //ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ return 0;&#125; ### lambdaè¡¨è¾¾å¼ 1234567891011121314151617#include &lt;thread&gt;#include &lt;iostream&gt;using namespace std;int main()&#123; thread t( [] () &#123; cout &lt;&lt; &quot;å­çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; //do something cout &lt;&lt; &quot;å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼&quot; &lt;&lt; endl; &#125; ); t.join(); //ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ return 0;&#125; ### éé™æ€æˆå‘˜å‡½æ•°ï¼Œé™æ€æˆå‘˜å‡½æ•° ä»¥ä¸‹çš„ä¸‹å†™æ³•ä¸­æ˜¯å°†å¯¹è±¡æ‹·è´äº†ä¸€ä»½å‰¯æœ¬æ¥åˆ›å»ºçº¿ç¨‹ã€‚å½“æˆ‘ä»¬åœ¨è¿›è¡Œå…±äº«æ•°æ®çš„ç®¡ç†æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦ä¼ å…¥å¯¹è±¡çš„æŒ‡é’ˆæˆ–è€…åœ°å€ã€‚è€Œé™æ€æˆå‘˜å‡½æ•°ï¼Œä¸éœ€è¦ä¼ å…¥å¯¹è±¡ï¼Œåªéœ€è¦ä¼ å…¥ç±»å‡½æ•°åœ°å€ã€‚æ ¹æ®C++å¯¹è±¡æ¨¡å‹ï¼Œè¿™å¾ˆå¥½ç†è§£å› ä¸ºç¼–è¯‘å™¨å¯¹éé™æ€æˆå‘˜å‡½æ•°çš„å¤„ç†éœ€è¦thisæŒ‡é’ˆï¼Œè€Œå¯¹é™æ€æˆå‘˜å‡½æ•°çš„å¤„ç†ä¸éœ€è¦ã€‚ 1234567891011121314151617181920#include &lt;thread&gt;#include &lt;iostream&gt;using namespace std;class Test&#123;public: void test()&#123; cout &lt;&lt; &quot;å­çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼&quot; &lt;&lt; endl; // do somesthing cout &lt;&lt; &quot;å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼&quot; &lt;&lt; endl; &#125;&#125;;int main()&#123; Test obj; thread t(&amp;Test::test, obj); //æ³¨æ„å†™æ³•ï¼Œä¼ å…¥æˆå‘˜å‡½æ•°åœ°å€ï¼Œè¿˜éœ€è¦ä¼ å…¥å¯¹è±¡ t.join(); //ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ return 0;&#125; ## è·å–çº¿ç¨‹id çº¿ç¨‹æ ‡è¯†ç±»å‹æ˜¯ std::thread::id ç±»å‹ã€‚æœ‰ä¸¤ç§è·å–idçš„æ–¹æ³•ã€‚ æ–¹æ³•ä¸€ï¼šå¯ä»¥é€šè¿‡è°ƒç”¨ std::thread å¯¹è±¡çš„æˆå‘˜å‡½æ•° get_id() æ¥è·å–idã€‚ æ–¹æ³•äºŒï¼šåœ¨å½“å‰çº¿ç¨‹ä¸­ä½¿ç”¨std::this_thread::get_id()æ¥è·å–çº¿ç¨‹idã€‚ 12345678910111213141516171819202122232425262728293031#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;chrono&gt;#include &lt;functional&gt;â€‹class A &#123;public: void threadfunc() &#123; std::cout &lt;&lt; &quot;bind thread func&quot; &lt;&lt; std::endl; &#125;&#125;;â€‹â€‹int main()&#123; A a; std::thread t1(std::bind(&amp;A::threadfunc,&amp;a)); std::cout &lt;&lt; &quot;main thread ID is : &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; std::cout &lt;&lt; &quot;t1 thread ID is : &quot; &lt;&lt; t1.get_id() &lt;&lt; std::endl; t1.join(); while (true) &#123; std::this_thread::sleep_for(std::chrono::milliseconds(1000));//ç¡çœ 1000æ¯«ç§’ break; &#125; return 0;&#125; std::this_thread::get_id()è·å–çš„æ˜¯å½“å‰çº¿ç¨‹çš„IDï¼Œt1.get_id()è·å–çš„æ˜¯æ‰€åˆ›å»ºçš„t1å¯¹è±¡ä¸­è¿è¡Œçš„çº¿ç¨‹IDï¼Œå¯¹åº”çš„IDåˆ†åˆ«ä¸ºï¼š 123main thread ID is : 11932t1 thread ID is : 12076bind thread func è™½ç„¶get_id()å¯ä»¥è·å–çº¿ç¨‹çš„IDï¼Œä½†æ˜¯å…¶è¿”å›ç±»å‹æ˜¯thread::idï¼Œé€šè¿‡std::coutå¯ä»¥è¾“å‡ºçº¿ç¨‹IDï¼Œä½†æ˜¯è¿™æ ·ä½¿ç”¨ä¼¼ä¹ä¸å¤ªæ–¹é¢ï¼Œè¦æ˜¯èƒ½è½¬æ¢ä¸ºæ•´å½¢å°±å¥½äº†ã€‚å…¶å®å¯ä»¥å°†å¾—åˆ°çš„çº¿ç¨‹IDå†™å…¥åˆ°ostreamstringæµä¸­ï¼Œè½¬æ¢æˆstringç±»å‹ï¼Œå†è½¬æ¢æˆæ•´å½¢ã€‚ 1234567891011121314151617181920212223242526272829303132333435#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;chrono&gt;#include &lt;functional&gt;#include &lt;sstream&gt;â€‹class A &#123;public: void threadfunc() &#123; std::cout &lt;&lt; &quot;bind thread func&quot; &lt;&lt; std::endl; &#125;&#125;;â€‹â€‹int main()&#123; A a; std::thread t1(std::bind(&amp;A::threadfunc, &amp;a));â€‹ std::ostringstream os1; os1 &lt;&lt; t1.get_id() &lt;&lt; std::endl; std::string strID = os1.str(); //è½¬æ¢æˆstringç±»å‹ int threadID = atoi(strID.c_str()); //è½¬æ¢æˆintç±»å‹ std::cout &lt;&lt; &quot;t1 thread ID is : &quot; &lt;&lt; threadID &lt;&lt; std::endl;â€‹ t1.join(); while (true) &#123; std::this_thread::sleep_for(std::chrono::milliseconds(1000));//ç¡çœ 1000æ¯«ç§’ break; &#125;â€‹ return 0;&#125; è¾“å‡ºç»“æœï¼š 123t1 thread ID is : 6956bind thread func å‚è€ƒï¼š https://zhuanlan.zhihu.com/p/157171731 https://www.cnblogs.com/chen-cs/p/13054027.html","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://marblemm.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"}],"tags":[]},{"title":"å­—ç¬¦ç±»å‹æ€»ç»“åŒºåˆ«wchar_tå’Œchar","slug":"å­—ç¬¦ç±»å‹æ€»ç»“åŒºåˆ«wchar_tå’Œchar","date":"2021-08-14T03:07:29.000Z","updated":"2021-08-30T15:46:18.123Z","comments":true,"path":"2021/08/14/å­—ç¬¦ç±»å‹æ€»ç»“åŒºåˆ«wchar_tå’Œchar/","link":"","permalink":"https://marblemm.github.io/2021/08/14/%E5%AD%97%E7%AC%A6%E7%B1%BB%E5%9E%8B%E6%80%BB%E7%BB%93%E5%8C%BA%E5%88%ABwchar_t%E5%92%8Cchar/","excerpt":"","text":"1.åŒºåˆ«wchar_t,char,WCHARANSIï¼šå³ char(8bit)ï¼Œå¯ç”¨å­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼šstrcat( ),strcpy( ), strlen( )ç­‰ä»¥stræ‰“å¤´çš„å‡½æ•°ã€‚ UNICODEï¼šwchar_t(16bit)æ˜¯Unicodeå­—ç¬¦çš„æ•°æ®ç±»å‹ï¼Œå¯ç”¨å­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼šwcscat(),wcscpy(),wcslen()ç­‰ä»¥wcsæ‰“å¤´çš„å‡½æ•°ã€‚å®ƒå®é™…å®šä¹‰åœ¨é‡Œï¼š 123 typedef unsigned short wchar_t; å¦å¤–ï¼Œåœ¨å¤´æ–‡ä»¶ä¸­æœ‰è¿™æ ·çš„å®šä¹‰ï¼štypedef wchar_t WCHAR; æ‰€ä»¥WCHARå®é™…å°±æ˜¯wchar_t ä¸ºäº†è®©ç¼–è¯‘å™¨è¯†åˆ«Unicodeå­—ç¬¦ä¸²ï¼Œå¿…é¡»ä»¥åœ¨å‰é¢åŠ ä¸€ä¸ªâ€œLâ€,ä¾‹å¦‚: wchar_t *szTest=L&quot;This is a Unicode string.&quot;; 2.TCHAR åœ¨Cè¯­è¨€é‡Œé¢æä¾›äº† _UNICODEå®ï¼ˆæœ‰ä¸‹åˆ’çº¿ï¼‰ï¼Œåœ¨Windowsé‡Œé¢æä¾›äº†UNICODEå®ï¼ˆæ— ä¸‹åˆ’çº¿ï¼‰ï¼Œåªè¦å®šäº†_UNICODEå®å’ŒUNICODEå®ï¼Œç³»ç»Ÿå°±ä¼šè‡ª åŠ¨åˆ‡æ¢åˆ°UNICODEç‰ˆæœ¬ï¼Œå¦åˆ™ï¼Œç³»ç»ŸæŒ‰ç…§ANSIçš„æ–¹å¼è¿›è¡Œç¼–è¯‘å’Œè¿è¡Œã€‚åªå®šä¹‰äº†å®å¹¶ä¸èƒ½å®ç°è‡ªåŠ¨çš„è½¬æ¢ï¼Œä»–è¿˜éœ€è¦ä¸€ç³»åˆ—çš„å­—ç¬¦å®šä¹‰æ”¯æŒã€‚ 1234567891ï¼ TCHAR å¦‚æœå®šä¹‰äº†UNICODEå®åˆ™TCHARè¢«å®šä¹‰ä¸ºwchar_tã€‚ typedef wchar_t TCHAR; å¦åˆ™TCHARè¢«å®šä¹‰ä¸ºchar typedef char TCHAR;2ï¼ LPTSTR å¦‚æœå®šä¹‰äº†UNICODEå®åˆ™LPTSTRè¢«å®šä¹‰ä¸ºLPWSTRã€‚ typedef LPTSTR LPWSTR; å¦åˆ™TCHARè¢«å®šä¹‰ä¸ºchar typedef LPTSTR LPSTR; è¯´æ˜ï¼šåœ¨ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡çš„æ—¶å€™éœ€è¦ä½¿ç”¨_TEXT(â€œMyStrâ€)æˆ–è€…_T(&quot;&quot;)æ¥æ”¯æŒç³»ç»Ÿçš„è‡ªåŠ¨è½¬æ¢ã€‚ 3.bstrå­—ç¬¦ä¸²BSTR 4.æ›´è¿›ä¸€æ­¥çš„å­—ç¬¦ä¸²ä»¥åŠå…¶æŒ‡é’ˆçš„ç±»å‹å®šä¹‰ ç”±äºWin32 APIæ–‡æ¡£çš„å‡½æ•°åˆ—è¡¨ä½¿ç”¨å‡½æ•°çš„å¸¸ç”¨åå­—ï¼ˆä¾‹å¦‚ï¼Œ â€œSetWindowTextâ€ï¼‰ï¼Œæ‰€æœ‰çš„å­—ç¬¦ä¸²éƒ½æ˜¯ç”¨TCHARæ¥å®šä¹‰çš„ã€‚ï¼ˆé™¤äº†XPä¸­å¼•å…¥çš„åªé€‚ç”¨äºUnicodeçš„APIï¼‰ã€‚ä¸‹é¢åˆ—å‡ºä¸€äº›å¸¸ç”¨çš„typedefsï¼Œä½ å¯ä»¥åœ¨msdnä¸­çœ‹åˆ°ä»–ä»¬ã€‚ 12345678910type Meaning in MBCS builds Meaning in Unicode buildsWCHAR wchar_t wchar_tLPSTR char* char*LPCSTR const char* const char*LPWSTR wchar_t* wchar_t*LPCWSTR wchar_t* wchar_t*TCHAR TCHAR char wchar_tLPTSTR TCHAR* TCHAR*LPCTSTR const TCHAR* const TCHAR* 5.ç›¸äº’è½¬æ¢wchar_t* è½¬ä¸º char*123456wchar_t* pwszUnicode = L&quot;Holle&quot;; //wcslen(pwsUnicode)=5int iSize;char* pszMultiByte;//è¿”å›æ¥å—å­—ç¬¦ä¸²æ‰€éœ€ç¼“å†²åŒºçš„å¤§å°ï¼Œå·²ç»åŒ…å«å­—ç¬¦ç»“å°¾ç¬¦&#x27;\\0&#x27;iSize = WideCharToMultiByte(CP_ACP, 0, pwszUnicode, -1, NULL, 0, NULL, NULL); //iSize =wcslen(pwsUnicode)+1=6pszMultiByte = (char*)malloc(iSize*sizeof(char)); //ä¸éœ€è¦ pszMultiByte = (char*)malloc(iSize*sizeof(char)+1);WideCharToMultiByte(CP_ACP, 0, pwszUnicode, -1, pszMultiByte, iSize, NULL, NULL); char è½¬ä¸º wchar_t123456char* pszMultiByte = &quot;Holle&quot;; //strlen(pwsUnicode)=5int iSize; wchar_t* pwszUnicode ; //è¿”å›æ¥å—å­—ç¬¦ä¸²æ‰€éœ€ç¼“å†²åŒºçš„å¤§å°ï¼Œå·²ç»åŒ…å«å­—ç¬¦ç»“å°¾ç¬¦&#x27;\\0&#x27;iSize = MultiByteToWideChar(CP_ACP, 0, pszMultiByte , -1, NULL, 0); //iSize =wcslen(pwsUnicode)+1=6pwszUnicode = (wchar_t *)malloc(iSize*sizeof(wchar_t)); //ä¸éœ€è¦ pwszUnicode = (wchar_t *)malloc((iSize+1)*sizeof(wchar_t))MultiByteToWideChar(CP_ACP, 0, pszMultiByte , -1, pwszUnicode , iSize); char*è½¬æ¢æˆCString12345678910111213141516171819202122 è‹¥å°†char*è½¬æ¢æˆCStringï¼Œé™¤äº†ç›´æ¥èµ‹å€¼å¤–ï¼Œè¿˜å¯ä½¿ç”¨CString::Formatè¿›è¡Œã€‚ä¾‹å¦‚ï¼š char chArray[] = &quot;This is a test&quot;; char * p = &quot;This is a test&quot;; æˆ– LPSTR p = &quot;This is a test&quot;; æˆ–åœ¨å·²å®šä¹‰Unicodeåº”çš„ç”¨ç¨‹åºä¸­ TCHAR * p = _T(&quot;This is a test&quot;); æˆ– LPTSTR p = _T(&quot;This is a test&quot;); CString theString = chArray; theString.Format(_T(&quot;%s&quot;), chArray); theString = p;//æ–¹æ³•ä¸€char *p = &quot;test&quot;;CString str(p);//æ–¹æ³•äºŒchar * pFileName = &quot;test&quot;; USES_CONVERSION;CString s = A2T(pFileName);//CString s = A2W(pFileName); CStringè½¬æ¢æˆchar*12345678910111213141516171819202122232425262728 è‹¥å°†CStringç±»è½¬æ¢æˆchar*(LPSTR)ç±»å‹ï¼Œå¸¸å¸¸ä½¿ç”¨ä¸‹åˆ—ä¸‰ç§æ–¹æ³•ï¼š æ–¹æ³•ä¸€ï¼Œä½¿ç”¨å¼ºåˆ¶è½¬æ¢ã€‚ä¾‹å¦‚ï¼š CString theString( &quot;This is a test&quot; ); LPTSTR lpsz =(LPTSTR)(LPCTSTR)theString; æ–¹æ³•äºŒï¼Œä½¿ç”¨strcpyã€‚ä¾‹å¦‚ï¼š CString theString( &quot;This is a test&quot; ); LPTSTR lpsz = new TCHAR[theString.GetLength()+1]; _tcscpy(lpsz, theString); éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œstrcpy(æˆ–å¯ç§»å€¼Unicode/MBCSçš„_tcscpy)çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ const wchar_t* (Unicode)æˆ–const char* (ANSI)ï¼Œç³»ç»Ÿç¼–è¯‘å™¨å°†ä¼šè‡ªåŠ¨å¯¹å…¶è¿›è¡Œè½¬æ¢ã€‚ æ–¹æ³•ä¸‰ï¼Œä½¿ç”¨CString::GetBufferã€‚ä¾‹å¦‚ï¼š CString s(_T(&quot;This is a test &quot;)); LPTSTR p = s.GetBuffer(); // åœ¨è¿™é‡Œæ·»åŠ ä½¿ç”¨pçš„ä»£ç  if(p != NULL) *p = _T(&#x27;\\0&#x27;); s.ReleaseBuffer(); // ä½¿ç”¨å®ŒååŠæ—¶é‡Šæ”¾ï¼Œä»¥ä¾¿èƒ½ä½¿ç”¨å…¶å®ƒçš„CStringæˆå‘˜å‡½æ•°//æ–¹æ³•å››CString cstr = _T(&quot;test&quot;)//å£°æ˜æ ‡è¯†USES_CONVERSION;//å‡½æ•°T2Aå’ŒW2Aå‡æ”¯æŒATLå’ŒMFCä¸­çš„å­—ç¬¦char * pFileName = T2A(cstr); //char * pFileName = W2A(cstr); //ä¹Ÿå¯å®ç°è½¬æ¢//æ³¨æ„ï¼šæœ‰æ—¶å€™å¯èƒ½è¿˜éœ€è¦æ·»åŠ å¼•ç”¨#include &lt;afxpriv.h&gt; BSTRè½¬æ¢æˆchar*123456789101112131415 æ–¹æ³•ä¸€ï¼Œä½¿ç”¨ConvertBSTRToStringã€‚ä¾‹å¦‚ï¼š #include #pragma comment(lib, &quot;comsupp.lib&quot;) int _tmain(int argc, _TCHAR* argv[])&#123; BSTR bstrText = ::SysAllocString(L&quot;Test&quot;); char* lpszText2 = _com_util::ConvertBSTRToString(bstrText); SysFreeString(bstrText); // ç”¨å®Œé‡Šæ”¾ delete[] lpszText2; return 0; &#125; æ–¹æ³•äºŒï¼Œä½¿ç”¨_bstr_tçš„èµ‹å€¼è¿ç®—ç¬¦é‡è½½ã€‚ä¾‹å¦‚ï¼š _bstr_t b = bstrText; char* lpszText2 = b;//åº•å±‚è¿˜æ˜¯è°ƒçš„_com_util::ConvertBSTRToString(bstrText);``` ### char*è½¬æ¢æˆBSTR æ–¹æ³•ä¸€ï¼Œä½¿ç”¨SysAllocStringç­‰APIå‡½æ•°ã€‚ä¾‹å¦‚ï¼š BSTR bstrText = ::SysAllocString(Lâ€Testâ€); BSTR bstrText = ::SysAllocStringLen(Lâ€Testâ€,4); BSTR bstrText = ::SysAllocStringByteLen(â€œTestâ€,4); æ–¹æ³•äºŒï¼Œä½¿ç”¨COleVariantæˆ–_variant_tã€‚ä¾‹å¦‚ï¼š //COleVariant strVar(â€œThis is a testâ€); _variant_t strVar(â€œThis is a testâ€); BSTR bstrText = strVar.bstrVal; æ–¹æ³•ä¸‰ï¼Œä½¿ç”¨_bstr_tï¼Œè¿™æ˜¯ä¸€ç§æœ€ç®€å•çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š BSTR bstrText = _bstr_t(â€œThis is a testâ€);//åº•å±‚è¿˜æ˜¯è°ƒçš„æ–¹æ³•äº” æ–¹æ³•å››ï¼Œä½¿ç”¨CComBSTRã€‚ä¾‹å¦‚ï¼š BSTR bstrText = CComBSTR(â€œThis is a testâ€); æˆ– CComBSTR bstr(â€œThis is a testâ€); BSTR bstrText = bstr.m_str; æ–¹æ³•äº”ï¼Œä½¿ç”¨ConvertStringToBSTRã€‚ä¾‹å¦‚ï¼š char* lpszText = â€œTestâ€; BSTR bstrText = _com_util::ConvertStringToBSTR(lpszText); //ä½¿ç”¨å‰éœ€è¦åŠ ä¸Šå¤´æ–‡ä»¶comutil.h åä¹‹å¯ä»¥ä½¿ç”¨char *p=_com_util::ConvertBSTRToString(b); 1### CStringè½¬æ¢æˆBSTR é€šå¸¸æ˜¯é€šè¿‡ä½¿ç”¨CStringT::AllocSysStringæ¥å®ç°ã€‚ä¾‹å¦‚ï¼š CString str(â€œThis is a testâ€); BSTR bstrText = str.AllocSysString(); â€¦ SysFreeString(bstrText); // ç”¨å®Œé‡Šæ”¾ 123 æ³¨æ„ï¼šç”¨å®Œä¹‹åå¿…é¡»ä½¿ç”¨SysFreeString é‡Šæ”¾ï¼ï¼ï¼### BSTRè½¬æ¢æˆCString æ–¹æ³•ä¸€ï¼š BSTR bstrText = ::SysAllocString(Lâ€Testâ€); CStringA str; str.Empty(); str = (LPCSTR)bstrText;æ–¹æ³•äºŒï¼š BSTR bstrText = ::SysAllocString(Lâ€Testâ€); CStringA str(bstrText); 12345### CStringè½¬_bstr_t``` _bstr_t bstr; CString strSql; bstr = (_bstr_t)strSql; _bstr_tè½¬CString123_bstr_t bstr;CString strSql; strSql = (LPCSTR)bstr; BSTR è½¬LPCTSTR1234567//æ–¹æ³•ä¸€ï¼š_bstr_t strstr = bstrtext;LPCTSTR lpctstrname = strstr;//æ–¹æ³•äºŒ:CString str = bstrtext;LPCTSTR lpctstrname = (LPCTSTR)str; LPCTSTRè½¬CString12345678910//æ–¹æ³•ä¸€ï¼šLPCTSTR lpctStr;CString cStr=lpctStr;//æ–¹æ³•äºŒï¼šLPCTSTR p; CString str=&quot;hello&quot;; p=str.GetBuffer(str.GetLength()); str.ReleaseBuffer(); CStringä¸LPCWSTR12345678910111213141516171819ä¸¤è€…çš„ä¸åŒï¼šLPCWSTR æ˜¯Unicodeå­—ç¬¦ä¸²æŒ‡é’ˆï¼Œåˆå§‹åŒ–æ—¶ä¸²æœ‰å¤šå¤§ï¼Œç”³è¯·ç©ºé—´å°±æœ‰å¤šå¤§ï¼Œä»¥åå­˜è´®è‹¥è¶…è¿‡åˆ™å‡ºç°æ— æ³•é¢„æ–™çš„ç»“æœï¼Œè¿™æ˜¯å®ƒä¸CStringçš„ä¸åŒä¹‹å¤„ã€‚è€ŒCStringæ˜¯ä¸€ä¸ªä¸²ç±»ï¼Œå†…å­˜ç©ºé—´ç±»ä¼šè‡ªåŠ¨ç®¡ç†ã€‚CStringè½¬æ¢æˆLPCWSTRæ–¹æ³•ä¸€ï¼šCString strFileName; LPCWSTR lpcwStr = strFileName.AllocSysString();æ–¹æ³•äºŒï¼šCString str=_T(&quot;TestStr&quot;); USES_CONVERSION; LPCWSTR lpcwStr = A2CW((LPCSTR)str);MFCä¸­CStringå’ŒLPSTRæ˜¯å¯ä»¥é€šç”¨ï¼Œå…¶ä¸­A2CWè¡¨ç¤º(LPCSTR) -&gt; (LPCWSTR)ï¼ŒUSER_CONVERSIONè¡¨ç¤ºç”¨æ¥å®šä¹‰ä¸€äº›ä¸­é—´å˜é‡ï¼Œåœ¨ä½¿ç”¨ATLçš„è½¬æ¢å®ä¹‹å‰å¿…é¡»å®šä¹‰è¯¥è¯­å¥ã€‚LPCWSTRè½¬æ¢æˆCStringLPCWSTR lpcwStr = L&quot;TestWStr&quot;; CString str(lpcwStr); CStringè½¬æ¢æˆLPSTR1234567891011121314151617181920æ–¹æ³•ä¸€ï¼šCString strFileName; LPSTR lpStr = strFileName.GetBuffer(); strFileName.ReleaseBuffer();æ–¹æ³•äºŒï¼šCString strFileName; LPSTR lpStr = (LPSTR)(LPCSTR)strFimeName;LPSTRè½¬æ¢æˆCString: LPSTR lpStr = L&quot;TestStr&quot;; CString str(lpStr);æ³¨æ„ï¼šCStringå’ŒLPCSTRå¯ç›´æ¥è½¬æ¢ï¼Œå¦‚ä¸‹: CString str; LPCSTR lpcStr = (LPCSTR)str; ANSIã€Unicodeå’Œå®½å­—ç¬¦ä¹‹é—´çš„è½¬æ¢123456789101112131415 æ–¹æ³•ä¸€ï¼Œä½¿ç”¨MultiByteToWideCharå°†ANSIå­—ç¬¦è½¬æ¢æˆUnicodeå­—ç¬¦ï¼Œä½¿ç”¨WideCharToMultiByteå°†Unicodeå­—ç¬¦è½¬æ¢æˆANSIå­—ç¬¦ã€‚ æ–¹æ³•äºŒï¼Œä½¿ç”¨â€œ_Tâ€å°†ANSIè½¬æ¢æˆâ€œä¸€èˆ¬â€ç±»å‹å­—ç¬¦ä¸²ï¼Œä½¿ç”¨â€œLâ€å°†ANSIè½¬æ¢æˆUnicodeï¼Œè€Œåœ¨æ‰˜ç®¡C++ç¯å¢ƒä¸­è¿˜å¯ä½¿ç”¨Så°†ANSIå­—ç¬¦ä¸²è½¬æ¢æˆString*å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š TCHAR tstr[] = _T(&quot;this is a test&quot;); wchar_t wszStr[] = L&quot;This is a test&quot;; String* str = Sâ€This is a testâ€; æ–¹æ³•ä¸‰ï¼Œä½¿ç”¨ATL 7.0çš„è½¬æ¢å®å’Œç±»ã€‚ATL7.0åœ¨åŸæœ‰3.0åŸºç¡€ä¸Šå®Œå–„å’Œå¢åŠ äº†è®¸å¤šå­—ç¬¦ä¸²è½¬æ¢å®ä»¥åŠæä¾›ç›¸åº”çš„ç±»ï¼Œå®ƒå…·æœ‰å¦‚å›¾3æ‰€ç¤ºçš„ç»Ÿä¸€å½¢å¼ï¼š å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªCè¡¨ç¤ºâ€œç±»â€ï¼Œä»¥ä¾¿äºATL 3.0å®ç›¸åŒºåˆ«ï¼Œç¬¬äºŒä¸ªCè¡¨ç¤ºå¸¸é‡ï¼Œ2è¡¨ç¤ºâ€œtoâ€ï¼ŒEXè¡¨ç¤ºè¦å¼€è¾Ÿä¸€å®šå¤§å°çš„ç¼“å†²ã€‚SourceTypeå’ŒDestinationTypeå¯ä»¥æ˜¯Aã€ Tã€Wå’ŒOLEï¼Œå…¶å«ä¹‰åˆ†åˆ«æ˜¯ANSIã€Unicodeã€â€œä¸€èˆ¬â€ç±»å‹å’ŒOLEå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼ŒCA2CTå°±æ˜¯å°†ANSIè½¬æ¢æˆä¸€èˆ¬ç±»å‹çš„å­—ç¬¦ä¸²å¸¸é‡ã€‚ä¸‹é¢ æ˜¯ä¸€äº›ç¤ºä¾‹ä»£ç ï¼š LPTSTR tstr= CA2TEX&lt;16&gt;(&quot;this is a test&quot;); LPCTSTR tcstr= CA2CT(&quot;this is a test&quot;); wchar_t wszStr[] = L&quot;This is a test&quot;; char* chstr = CW2A(wszStr); https://www.cnblogs.com/zhoug2020/archive/2012/06/13/2547463.html http://www.imkevinyang.com/2010/06/%E5%85%B3%E4%BA%8E%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%EF%BC%8C%E4%BD%A0%E6%89%80%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84.html http://cppblog.com/lizao2/articles/169250.html","categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"}],"tags":[]},{"title":"c++é¢è¯•æ€»ç»“-STL","slug":"cppé¢è¯•æ€»ç»“-STL","date":"2021-08-13T14:51:37.000Z","updated":"2021-08-27T14:41:37.811Z","comments":true,"path":"2021/08/13/cppé¢è¯•æ€»ç»“-STL/","link":"","permalink":"https://marblemm.github.io/2021/08/13/cpp%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93-STL/","excerpt":"","text":"STLå¸¸ç”¨çš„å®¹å™¨æœ‰å“ªäº›ä»¥åŠå„è‡ªçš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆ?12345678910111213141.vector:åº•å±‚æ•°æ®ç»“æ„ä¸ºæ•°ç»„ ï¼Œæ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ã€‚2.list:åº•å±‚æ•°æ®ç»“æ„ä¸ºåŒå‘é“¾è¡¨ï¼Œæ”¯æŒå¿«é€Ÿå¢åˆ ã€‚3.deque:åº•å±‚æ•°æ®ç»“æ„ä¸ºä¸€ä¸ªä¸­å¤®æ§åˆ¶å™¨å’Œå¤šä¸ªç¼“å†²åŒºï¼Œæ”¯æŒé¦–å°¾ï¼ˆä¸­é—´ä¸èƒ½ï¼‰å¿«é€Ÿå¢åˆ ï¼Œä¹Ÿæ”¯æŒéšæœºè®¿é—®ã€‚4.stack:åº•å±‚ä¸€èˆ¬ç”¨23å®ç°ï¼Œå°é—­å¤´éƒ¨å³å¯ï¼Œä¸ç”¨vectorçš„åŸå› åº”è¯¥æ˜¯å®¹é‡å¤§å°æœ‰é™åˆ¶ï¼Œæ‰©å®¹è€—æ—¶5.queue:åº•å±‚ä¸€èˆ¬ç”¨23å®ç°ï¼Œå°é—­å¤´éƒ¨å³å¯ï¼Œä¸ç”¨vectorçš„åŸå› åº”è¯¥æ˜¯å®¹é‡å¤§å°æœ‰é™åˆ¶ï¼Œæ‰©å®¹è€—æ—¶ï¼ˆstackå’Œqueueå…¶å®æ˜¯é€‚é…å™¨,è€Œä¸å«å®¹å™¨ï¼Œå› ä¸ºæ˜¯å¯¹å®¹å™¨çš„å†å°è£…ï¼‰6.priority_queue:çš„åº•å±‚æ•°æ®ç»“æ„ä¸€èˆ¬ä¸ºvectorä¸ºåº•å±‚å®¹å™¨ï¼Œå †heapä¸ºå¤„ç†è§„åˆ™æ¥ç®¡ç†åº•å±‚å®¹å™¨å®ç°7.set:åº•å±‚æ•°æ®ç»“æ„ä¸ºçº¢é»‘æ ‘ï¼Œæœ‰åºï¼Œä¸é‡å¤ã€‚8.multiset:åº•å±‚æ•°æ®ç»“æ„ä¸ºçº¢é»‘æ ‘ï¼Œæœ‰åºï¼Œå¯é‡å¤ã€‚ 9.map:åº•å±‚æ•°æ®ç»“æ„ä¸ºçº¢é»‘æ ‘ï¼Œæœ‰åºï¼Œä¸é‡å¤ã€‚10.multimap:åº•å±‚æ•°æ®ç»“æ„ä¸ºçº¢é»‘æ ‘ï¼Œæœ‰åºï¼Œå¯é‡å¤ã€‚11.hash_set:åº•å±‚æ•°æ®ç»“æ„ä¸ºhashè¡¨ï¼Œæ— åºï¼Œä¸é‡å¤ã€‚12.hash_multiset:åº•å±‚æ•°æ®ç»“æ„ä¸ºhashè¡¨ï¼Œæ— åºï¼Œå¯é‡å¤ ã€‚13.hash_map :åº•å±‚æ•°æ®ç»“æ„ä¸ºhashè¡¨ï¼Œæ— åºï¼Œä¸é‡å¤ã€‚14.hash_multimap:åº•å±‚æ•°æ®ç»“æ„ä¸ºhashè¡¨ï¼Œæ— åºï¼Œå¯é‡å¤ã€‚ ä½¿ç”¨åœºæ™¯ 1ã€å¦‚æœä½ éœ€è¦é«˜æ•ˆçš„éšæœºå­˜å–ï¼Œè€Œä¸åœ¨ä¹æ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡ï¼Œä½¿ç”¨vector 2ã€å¦‚æœä½ éœ€è¦å¤§é‡çš„æ’å…¥å’Œåˆ é™¤ï¼Œè€Œä¸å…³å¿ƒéšæœºå­˜å–ï¼Œåˆ™åº”ä½¿ç”¨list 3ã€å¦‚æœä½ éœ€è¦éšæœºå­˜å–ï¼Œè€Œä¸”å…³å¿ƒä¸¤ç«¯æ•°æ®çš„æ’å…¥å’Œåˆ é™¤ï¼Œåˆ™åº”ä½¿ç”¨dequeã€‚ 4ã€å¦‚æœä½ è¦å­˜å‚¨ä¸€ä¸ªæ•°æ®å­—å…¸ï¼Œå¹¶è¦æ±‚æ–¹ä¾¿åœ°æ ¹æ®keyæ‰¾valueï¼Œé‚£ä¹ˆmapæ˜¯è¾ƒå¥½çš„é€‰æ‹© 5ã€å¦‚æœä½ è¦æŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨æŸé›†åˆå†…å­˜ä¸­ï¼Œåˆ™ä½¿ç”¨setå­˜å‚¨è¿™ä¸ªé›†åˆæ¯”è¾ƒå¥½ è¯´è¯´ vector å’Œ list çš„åŒºåˆ«1ï¼‰ vectorï¼Œ è¿ç»­å­˜å‚¨çš„å®¹å™¨ï¼ŒåŠ¨æ€æ•°ç»„ï¼Œåœ¨å †ä¸Šåˆ†é…ç©ºé—´ ï¼› åº•å±‚å®ç°ï¼šæ•°ç»„ã€‚ å¦‚æœæ²¡æœ‰å‰©ä½™ç©ºé—´äº†ï¼Œåˆ™ä¼šé‡æ–°é…ç½®åŸæœ‰å…ƒç´ ä¸ªæ•°çš„ä¸¤å€ç©ºé—´ï¼Œç„¶åå°†åŸç©ºé—´å…ƒç´ é€šè¿‡å¤åˆ¶çš„æ–¹å¼åˆå§‹åŒ–æ–°ç©ºé—´ï¼Œå†å‘æ–°ç©ºé—´å¢åŠ å…ƒç´ ã€‚ é€‚ç”¨åœºæ™¯ï¼šç»å¸¸éšæœºè®¿é—®ï¼Œä¸”ä¸ç»å¸¸å¯¹éå°¾èŠ‚ç‚¹è¿›è¡Œæ’å…¥åˆ é™¤ã€‚ 2ï¼‰listï¼ŒåŠ¨æ€é“¾è¡¨ï¼Œåœ¨å †ä¸Šåˆ†é…ç©ºé—´ï¼Œæ¯æ’å…¥ä¸€ä¸ªå…ƒç´ éƒ½ä¼šåˆ†é…ç©ºé—´ï¼Œæ¯åˆ é™¤ä¸€ä¸ªå…ƒç´ éƒ½ä¼šé‡Šæ”¾ç©ºé—´ã€‚ åº•å±‚ï¼šåŒå‘é“¾è¡¨ è®¿é—®ï¼šéšæœºè®¿é—®æ€§èƒ½å¾ˆå·®ï¼Œåªèƒ½å¿«é€Ÿè®¿é—®å¤´å°¾èŠ‚ç‚¹ã€‚ é€‚ç”¨åœºæ™¯ï¼šç»å¸¸æ’å…¥åˆ é™¤å¤§é‡æ•°æ® 2ï¼‰ vectoråœ¨ä¸­é—´èŠ‚ç‚¹è¿›è¡Œæ’å…¥åˆ é™¤ä¼šå¯¼è‡´å†…å­˜æ‹·è´ï¼Œlistä¸ä¼šã€‚ 3ï¼‰ vectorä¸€æ¬¡æ€§åˆ†é…å¥½å†…å­˜ï¼Œä¸å¤Ÿæ—¶æ‰è¿›è¡Œ2å€æ‰©å®¹ï¼›listæ¯æ¬¡æ’å…¥æ–°èŠ‚ç‚¹éƒ½ä¼šè¿›è¡Œå†…å­˜ç”³è¯·ã€‚ 4ï¼‰ vectoræ‹¥æœ‰ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤æ”¯æŒéšæœºè®¿é—®ï¼Œå¦‚æœéœ€è¦é«˜æ•ˆçš„éšå³è®¿é—®ï¼Œè€Œä¸åœ¨ä¹æ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡ï¼Œä½¿ç”¨vectorã€‚ listæ‹¥æœ‰ä¸€æ®µä¸è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå¦‚æœéœ€è¦é«˜æ•ˆçš„æ’å…¥å’Œåˆ é™¤ï¼Œè€Œä¸å…³å¿ƒéšæœºè®¿é—®ï¼Œåˆ™åº”ä½¿ç”¨listã€‚ map å’Œ set æœ‰ä»€ä¹ˆåŒºåˆ«1ï¼‰ mapå’Œsetéƒ½æ˜¯C++çš„å…³è”å®¹å™¨ï¼Œå…¶åº•å±‚å®ç°éƒ½æ˜¯çº¢é»‘æ ‘ï¼ˆRB-Treeï¼‰ã€‚ 2ï¼‰ mapä¸­çš„å…ƒç´ æ˜¯key-valueï¼ˆå…³é”®å­—â€”å€¼ï¼‰å¯¹ï¼šå…³é”®å­—èµ·åˆ°ç´¢å¼•çš„ä½œç”¨ï¼Œå€¼åˆ™è¡¨ç¤ºä¸ç´¢å¼•ç›¸å…³è”çš„æ•°æ®ï¼›Setä¸ä¹‹ç›¸å¯¹å°±æ˜¯å…³é”®å­—çš„ç®€å•é›†åˆï¼Œsetä¸­æ¯ä¸ªå…ƒç´ åªåŒ…å«ä¸€ä¸ªå…³é”®å­—ã€‚ 3ï¼‰ setçš„è¿­ä»£å™¨æ˜¯constçš„ï¼Œä¸å…è®¸ä¿®æ”¹å…ƒç´ çš„å€¼ï¼›mapå…è®¸ä¿®æ”¹valueï¼Œä½†ä¸å…è®¸ä¿®æ”¹keyã€‚ 4ï¼‰ mapæ”¯æŒä¸‹æ ‡æ“ä½œï¼Œsetä¸æ”¯æŒä¸‹æ ‡æ“ä½œã€‚mapå¯ä»¥ç”¨keyåšä¸‹æ ‡ï¼Œ unordered_mapå’Œmap è¯´è¯´åŒºåˆ«å†…éƒ¨å®ç°æœºç† mapï¼š mapå†…éƒ¨å®ç°äº†ä¸€ä¸ªçº¢é»‘æ ‘ï¼Œè¯¥ç»“æ„å…·æœ‰è‡ªåŠ¨æ’åºçš„åŠŸèƒ½ï¼Œå› æ­¤mapå†…éƒ¨çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æœ‰åºçš„ï¼Œçº¢é»‘æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä»£è¡¨ç€mapçš„ä¸€ä¸ªå…ƒç´ ï¼Œå› æ­¤ï¼Œå¯¹äºmapè¿›è¡Œçš„æŸ¥æ‰¾ï¼Œåˆ é™¤ï¼Œæ·»åŠ ç­‰ä¸€ç³»åˆ—çš„æ“ä½œéƒ½ç›¸å½“äºæ˜¯å¯¹çº¢é»‘æ ‘è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼Œæ•…çº¢é»‘æ ‘çš„æ•ˆç‡å†³å®šäº†mapçš„æ•ˆç‡ã€‚ unordered_map: unordered_mapå†…éƒ¨å®ç°äº†ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå› æ­¤å…¶å…ƒç´ çš„æ’åˆ—é¡ºåºæ˜¯æ‚ä¹±çš„ï¼Œæ— åºçš„ä¼˜ç¼ºç‚¹ä»¥åŠé€‚ç”¨å¤„ 1234567891011121314map ä¼˜ç‚¹ï¼š æœ‰åºæ€§ï¼Œè¿™æ˜¯mapç»“æ„æœ€å¤§çš„ä¼˜ç‚¹ï¼Œå…¶å…ƒç´ çš„æœ‰åºæ€§åœ¨å¾ˆå¤šåº”ç”¨ä¸­éƒ½ä¼šç®€åŒ–å¾ˆå¤šçš„æ“ä½œçº¢é»‘æ ‘ï¼Œå†…éƒ¨å®ç°ä¸€ä¸ªçº¢é»‘ä¹¦ä½¿å¾—mapçš„å¾ˆå¤šæ“ä½œåœ¨çš„æ—¶é—´å¤æ‚åº¦ä¸‹å°±å¯ä»¥å®ç°ï¼Œå› æ­¤æ•ˆç‡éå¸¸çš„é«˜ç¼ºç‚¹ï¼š é€‚ç”¨å¤„ï¼Œå¯¹äºé‚£äº›æœ‰é¡ºåºè¦æ±‚çš„é—®é¢˜ï¼Œç”¨mapä¼šæ›´é«˜æ•ˆä¸€äº›ç©ºé—´å ç”¨ç‡é«˜ï¼Œå› ä¸ºmapå†…éƒ¨å®ç°äº†çº¢é»‘æ ‘ï¼Œè™½ç„¶æé«˜äº†è¿è¡Œæ•ˆç‡ï¼Œä½†æ˜¯å› ä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦é¢å¤–ä¿å­˜çˆ¶èŠ‚ç‚¹ï¼Œå­©å­èŠ‚ç‚¹ä»¥åŠçº¢/é»‘æ€§è´¨ï¼Œä½¿å¾—æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½å ç”¨å¤§é‡çš„ç©ºé—´unordered_map ä¼˜ç‚¹ï¼š å› ä¸ºå†…éƒ¨å®ç°äº†å“ˆå¸Œè¡¨ï¼Œå› æ­¤å…¶æŸ¥æ‰¾é€Ÿåº¦éå¸¸çš„å¿«ç¼ºç‚¹ï¼š é€‚ç”¨å¤„ï¼Œå¯¹äºæŸ¥æ‰¾é—®é¢˜ï¼Œunordered_mapä¼šæ›´åŠ é«˜æ•ˆä¸€äº›ï¼Œå› æ­¤é‡åˆ°æŸ¥æ‰¾é—®é¢˜ï¼Œå¸¸ä¼šè€ƒè™‘ä¸€ä¸‹ç”¨unordered_mapå“ˆå¸Œè¡¨çš„å»ºç«‹æ¯”è¾ƒè€—è´¹æ—¶é—´ STL ä¸­è¿­ä»£å™¨çš„ä½œç”¨ï¼Œæœ‰æŒ‡é’ˆä¸ºä½•è¿˜è¦è¿­ä»£å™¨1ï¼‰ Iteratorï¼ˆè¿­ä»£å™¨ï¼‰æ¨¡å¼åˆç§°Cursorï¼ˆæ¸¸æ ‡ï¼‰æ¨¡å¼ï¼Œç”¨äºæä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ , è€Œåˆä¸éœ€æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ 2ï¼‰ è¿­ä»£å™¨ä¸æ˜¯æŒ‡é’ˆï¼Œæ˜¯ç±»æ¨¡æ¿ï¼Œè¡¨ç°çš„åƒæŒ‡é’ˆã€‚ä»–åªæ˜¯æ¨¡æ‹Ÿäº†æŒ‡é’ˆçš„ä¸€äº›åŠŸèƒ½ï¼Œé€šè¿‡é‡è½½äº†æŒ‡é’ˆçš„ä¸€äº›æ“ä½œç¬¦ï¼Œ-&gt;ã€*ã€++ã€â€“ç­‰ï¼Œç›¸å½“äºä¸€ç§æ™ºèƒ½æŒ‡é’ˆã€‚ 3ï¼‰ è¿­ä»£å™¨äº§ç”ŸåŸå› ï¼š Iteratorç±»çš„è®¿é—®æ–¹å¼å°±æ˜¯æŠŠä¸åŒé›†åˆç±»çš„è®¿é—®é€»è¾‘æŠ½è±¡å‡ºæ¥ï¼Œä½¿å¾—ä¸ç”¨æš´éœ²é›†åˆå†…éƒ¨çš„ç»“æ„è€Œè¾¾åˆ°å¾ªç¯éå†é›†åˆçš„æ•ˆæœã€‚ STL è¿­ä»£å™¨æ˜¯æ€ä¹ˆåˆ é™¤å…ƒç´ çš„å‘¢1ï¼‰ å¯¹äºåºåˆ—å®¹å™¨vector,dequeæ¥è¯´ï¼Œä½¿ç”¨erase(itertor)åï¼Œåè¾¹çš„æ¯ä¸ªå…ƒç´ çš„è¿­ä»£å™¨éƒ½ä¼šå¤±æ•ˆï¼Œä½†æ˜¯åè¾¹æ¯ä¸ªå…ƒç´ éƒ½ä¼šå¾€å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼Œä½†æ˜¯eraseä¼šè¿”å›ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„è¿­ä»£å™¨ï¼› 2ï¼‰ å¯¹äºå…³è”å®¹å™¨map setæ¥è¯´ï¼Œä½¿ç”¨äº†erase(iterator)åï¼Œå½“å‰å…ƒç´ çš„è¿­ä»£å™¨å¤±æ•ˆï¼Œä½†æ˜¯å…¶ç»“æ„æ˜¯çº¢é»‘æ ‘ï¼Œåˆ é™¤å½“å‰å…ƒç´ çš„ï¼Œä¸ä¼šå½±å“åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨eraseä¹‹å‰ï¼Œè®°å½•ä¸‹ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨å³å¯ã€‚ 3ï¼‰ å¯¹äºlistæ¥è¯´ï¼Œå®ƒä½¿ç”¨äº†ä¸è¿ç»­åˆ†é…çš„å†…å­˜ï¼Œå¹¶ä¸”å®ƒçš„eraseæ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„iteratorï¼Œ å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLæ ‘ï¼‰å’Œçº¢é»‘æ ‘1ï¼‰å¹³è¡¡äºŒå‰æ ‘åˆç§°ä¸ºAVLæ ‘ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„äºŒå‰æ’åºæ ‘ã€‚å…¶å·¦å³å­æ ‘éƒ½æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Œä¸”å·¦å³å­æ ‘é«˜åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ã€‚ 2ï¼‰çº¢é»‘æ ‘æ˜¯ä¸€ç§äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œä½†åœ¨æ¯ä¸ªèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªå­˜å‚¨ä½è¡¨ç¤ºèŠ‚ç‚¹çš„é¢œè‰²ï¼Œå¯ä»¥æ˜¯çº¢æˆ–é»‘ï¼ˆéçº¢å³é»‘ï¼‰ï¼Œçº¢é»‘æ ‘æ˜¯ä¸€ç§å¼±å¹³è¡¡äºŒå‰æ ‘ï¼Œç›¸å¯¹äºè¦æ±‚ä¸¥æ ¼çš„AVLæ ‘æ¥è¯´ï¼Œå®ƒçš„æ—‹è½¬æ¬¡æ•°å°‘ï¼Œæ‰€ä»¥å¯¹äºæœç´¢ï¼Œæ’å…¥ï¼Œåˆ é™¤æ“ä½œè¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œé€šå¸¸ä½¿ç”¨çº¢é»‘æ ‘ã€‚ 3ï¼‰æ‰€ä»¥çº¢é»‘æ ‘åœ¨æŸ¥æ‰¾ï¼Œæ’å…¥åˆ é™¤çš„æ€§èƒ½éƒ½æ˜¯O(logn)ï¼Œä¸”æ€§èƒ½ç¨³å®šï¼Œæ‰€ä»¥STLé‡Œé¢å¾ˆå¤šç»“æ„åŒ…æ‹¬mapåº•å±‚å®ç°éƒ½æ˜¯ä½¿ç”¨çš„çº¢é»‘æ ‘ã€‚ 1234567891011121314151617è¯·ä½ å›ç­”ä¸€ä¸‹mapåº•å±‚ä¸ºä»€ä¹ˆç”¨çº¢é»‘æ ‘å®ç°1ã€çº¢é»‘æ ‘ï¼šçº¢é»‘æ ‘æ˜¯ä¸€ç§äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œä½†åœ¨æ¯ä¸ªèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªå­˜å‚¨ä½è¡¨ç¤ºèŠ‚ç‚¹çš„é¢œè‰²ï¼Œå¯ä»¥æ˜¯çº¢æˆ–é»‘ï¼ˆéçº¢å³é»‘ï¼‰ã€‚é€šè¿‡å¯¹ä»»ä½•ä¸€æ¡ä»æ ¹åˆ°å¶å­çš„è·¯å¾„ä¸Šå„ä¸ªèŠ‚ç‚¹ç€è‰²çš„æ–¹å¼çš„é™åˆ¶ï¼Œçº¢é»‘æ ‘ç¡®ä¿æ²¡æœ‰ä¸€æ¡è·¯å¾„ä¼šæ¯”å…¶å®ƒè·¯å¾„é•¿å‡ºä¸¤å€ï¼Œå› æ­¤ï¼Œçº¢é»‘æ ‘æ˜¯ä¸€ç§å¼±å¹³è¡¡äºŒå‰æ ‘ï¼Œç›¸å¯¹äºè¦æ±‚ä¸¥æ ¼çš„AVLæ ‘æ¥è¯´ï¼Œå®ƒçš„æ—‹è½¬æ¬¡æ•°å°‘ï¼Œæ‰€ä»¥å¯¹äºæœç´¢ï¼Œæ’å…¥ï¼Œåˆ é™¤æ“ä½œè¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œé€šå¸¸ä½¿ç”¨çº¢é»‘æ ‘ã€‚æ€§è´¨ï¼š1. æ¯ä¸ªèŠ‚ç‚¹éçº¢å³é»‘2. æ ¹èŠ‚ç‚¹æ˜¯é»‘çš„;3. æ¯ä¸ªå¶èŠ‚ç‚¹ï¼ˆå¶èŠ‚ç‚¹å³æ ‘å°¾ç«¯NULLæŒ‡é’ˆæˆ–NULLèŠ‚ç‚¹ï¼‰éƒ½æ˜¯é»‘çš„;4. å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œåˆ™å®ƒçš„å­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ã€‚5. å¯¹äºä»»æ„èŠ‚ç‚¹è€Œè¨€ï¼Œå…¶åˆ°å¶å­ç‚¹æ ‘NULLæŒ‡é’ˆçš„æ¯æ¡è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘èŠ‚ç‚¹;2ã€å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLæ ‘ï¼‰ï¼šçº¢é»‘æ ‘æ˜¯åœ¨AVLæ ‘çš„åŸºç¡€ä¸Šæå‡ºæ¥çš„ã€‚å¹³è¡¡äºŒå‰æ ‘åˆç§°ä¸ºAVLæ ‘ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„äºŒå‰æ’åºæ ‘ã€‚å…¶å·¦å³å­æ ‘éƒ½æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Œä¸”å·¦å³å­æ ‘é«˜åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ã€‚AVLæ ‘ä¸­æ‰€æœ‰ç»“ç‚¹ä¸ºæ ¹çš„æ ‘çš„å·¦å³å­æ ‘é«˜åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ã€‚å°†äºŒå‰æ ‘ä¸Šç»“ç‚¹çš„å·¦å­æ ‘æ·±åº¦å‡å»å³å­æ ‘æ·±åº¦çš„å€¼ç§°ä¸ºå¹³è¡¡å› å­BFï¼Œé‚£ä¹ˆå¹³è¡¡äºŒå‰æ ‘ä¸Šçš„æ‰€æœ‰ç»“ç‚¹çš„å¹³è¡¡å› å­åªå¯èƒ½æ˜¯-1ã€0å’Œ1ã€‚åªè¦äºŒå‰æ ‘ä¸Šæœ‰ä¸€ä¸ªç»“ç‚¹çš„å¹³è¡¡å› å­çš„ç»å¯¹å€¼å¤§äº1ï¼Œåˆ™è¯¥äºŒå‰æ ‘å°±æ˜¯ä¸å¹³è¡¡çš„ã€‚3ã€çº¢é»‘æ ‘è¾ƒAVLæ ‘çš„ä¼˜ç‚¹ï¼šAVL æ ‘æ˜¯é«˜åº¦å¹³è¡¡çš„ï¼Œé¢‘ç¹çš„æ’å…¥å’Œåˆ é™¤ï¼Œä¼šå¼•èµ·é¢‘ç¹çš„rebalanceï¼Œå¯¼è‡´æ•ˆç‡ä¸‹é™ï¼›çº¢é»‘æ ‘ä¸æ˜¯é«˜åº¦å¹³è¡¡çš„ï¼Œç®—æ˜¯ä¸€ç§æŠ˜ä¸­ï¼Œæ’å…¥æœ€å¤šä¸¤æ¬¡æ—‹è½¬ï¼Œåˆ é™¤æœ€å¤šä¸‰æ¬¡æ—‹è½¬ã€‚æ‰€ä»¥çº¢é»‘æ ‘åœ¨æŸ¥æ‰¾ï¼Œæ’å…¥åˆ é™¤çš„æ€§èƒ½éƒ½æ˜¯O(logn)ï¼Œä¸”æ€§èƒ½ç¨³å®šï¼Œæ‰€ä»¥STLé‡Œé¢å¾ˆå¤šç»“æ„åŒ…æ‹¬mapåº•å±‚å®ç°éƒ½æ˜¯ä½¿ç”¨çš„çº¢é»‘æ ‘ã€‚ æ ˆæº¢å‡ºçš„åŸå› æ ˆæº¢å‡ºæŒ‡çš„æ˜¯ç¨‹åºå‘æ ˆä¸­æŸä¸ªå˜é‡ä¸­å†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªå˜é‡æœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°ã€‚ 1ï¼‰ å±€éƒ¨æ•°ç»„è¿‡å¤§ã€‚å½“å‡½æ•°å†…éƒ¨çš„æ•°ç»„è¿‡å¤§æ—¶ï¼Œæœ‰å¯èƒ½å¯¼è‡´å †æ ˆæº¢å‡ºï¼Œå±€éƒ¨å˜é‡æ˜¯å­˜å‚¨åœ¨æ ˆä¸­çš„ã€‚ 2ï¼‰ é€’å½’è°ƒç”¨å±‚æ¬¡å¤ªå¤šã€‚ 3ï¼‰ æŒ‡é’ˆæˆ–æ•°ç»„è¶Šç•Œã€‚ä¾‹å¦‚è¿›è¡Œå­—ç¬¦ä¸²æ‹·è´ï¼Œæˆ–å¤„ç†ç”¨æˆ·è¾“å…¥ç­‰ç­‰ã€‚ å †å’Œæ ˆçš„åŒºåˆ«Cè¯­è¨€çš„å†…å­˜æ¨¡å‹åˆ†ä¸º5ä¸ªåŒºï¼šæ ˆåŒºã€å †åŒºã€é™æ€åŒºã€å¸¸é‡åŒºã€ä»£ç åŒºã€‚ 1ï¼‰æ ˆåŒºï¼šå­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ã€å±€éƒ¨å˜é‡ç­‰ï¼Œç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ã€‚æ ˆç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…ï¼Œé€Ÿåº¦å¿«ï¼Œä½†æ˜¯ç¨‹åºå‘˜æ— æ³•æ§åˆ¶ã€‚ 2ï¼‰ å †åŒºï¼šå°±æ˜¯é€šè¿‡newã€mallocã€reallocåˆ†é…çš„å†…å­˜å—ï¼Œç¼–è¯‘å™¨ä¸ä¼šè´Ÿè´£å®ƒä»¬çš„é‡Šæ”¾å·¥ä½œã€‚ä¸€èˆ¬æ˜¯ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œæœªè¢«é‡Šæ”¾å¯èƒ½å¼•èµ·å†…å­˜æ³„æ¼ã€‚å †æ˜¯æœ‰ç¨‹åºå‘˜è‡ªå·±åˆ†é…ï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼Œå®¹æ˜“äº§ç”Ÿç¢ç‰‡ï¼Œä¸è¿‡ç”¨èµ·æ¥æ–¹ä¾¿ã€‚ 3ï¼‰å…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„å­˜å‚¨æ˜¯æ”¾åœ¨ä¸€å—çš„ã€‚ 4ï¼‰å¸¸é‡åŒºï¼šå¸¸é‡å­˜å‚¨åœ¨è¿™é‡Œï¼Œä¸å…è®¸ä¿®æ”¹ã€‚ 5ï¼‰ ä»£ç åŒºï¼šå­˜æ”¾å‡½æ•°ä½“çš„äºŒè¿›åˆ¶ä»£ç ã€‚ å“ˆå¸Œè¡¨ï¼ˆhashè¡¨ï¼‰å“ˆå¸Œè¡¨çš„å®ç°ä¸»è¦åŒ…æ‹¬æ„é€ å“ˆå¸Œå’Œå¤„ç†å“ˆå¸Œå†²çªï¼šæ„é€ å“ˆå¸Œï¼Œä¸»è¦åŒ…æ‹¬ç›´æ¥åœ°å€æ³•ï¼Œé™¤ç•™ä½™æ•°æ³•ã€‚ å¤„ç†å“ˆå¸Œå†²çªï¼šå½“å“ˆå¸Œè¡¨å…³é”®å­—é›†åˆå¾ˆå¤§æ—¶ï¼Œå…³é”®å­—å€¼ä¸åŒçš„å…ƒç´ å¯èƒ½ä¼šæ˜ å°„åˆ°å“ˆå¸Œè¡¨çš„åŒä¸€åœ°å€ä¸Šï¼Œè¿™æ ·çš„ç°è±¡ç§°ä¸ºå“ˆå¸Œå†²çªã€‚å¸¸ç”¨çš„è§£å†³æ–¹æ³•æœ‰ï¼š 1ï¼‰ å¼€æ”¾å®šå€æ³•ï¼Œå†²çªæ—¶ï¼Œç”¨æŸç§æ–¹æ³•ç»§ç»­æ¢æµ‹å“ˆå¸Œè¡¨ä¸­çš„å…¶ä»–å­˜å‚¨å•å…ƒï¼Œç›´åˆ°æ‰¾åˆ°ç©ºä½ç½®ä¸ºæ­¢ã€‚ï¼ˆå¦‚ï¼Œçº¿æ€§æ¢æµ‹ï¼Œå¹³æ–¹æ¢æµ‹ï¼‰ 2ï¼‰ å†å“ˆå¸Œæ³•ï¼šå½“å‘ç”Ÿå†²çªæ—¶ï¼Œç”¨å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°è®¡ç®—åœ°å€å€¼ï¼Œç›´åˆ°å†²çªä¸å†å‘ç”Ÿã€‚ 3ï¼‰ é“¾åœ°å€æ³•ï¼šå°†æ‰€æœ‰å“ˆå¸Œå€¼ç›¸åŒçš„keyé€šè¿‡é“¾è¡¨å­˜å‚¨ï¼ŒkeyæŒ‰é¡ºåºæ’å…¥é“¾è¡¨ä¸­ã€‚","categories":[{"name":"c++é¢è¯•","slug":"c-é¢è¯•","permalink":"https://marblemm.github.io/categories/c-%E9%9D%A2%E8%AF%95/"}],"tags":[]},{"title":"stringå’Œchar*çš„åŒºåˆ«","slug":"stringå’Œchar-çš„åŒºåˆ«","date":"2021-08-13T12:52:19.000Z","updated":"2021-08-13T14:50:32.436Z","comments":true,"path":"2021/08/13/stringå’Œchar-çš„åŒºåˆ«/","link":"","permalink":"https://marblemm.github.io/2021/08/13/string%E5%92%8Cchar-%E7%9A%84%E5%8C%BA%E5%88%AB/","excerpt":"","text":"1ã€å®šä¹‰ï¼šstringï¼šstringæ˜¯STLå½“ä¸­çš„ä¸€ä¸ªå®¹å™¨ï¼Œå¯¹å…¶è¿›è¡Œäº†å°è£…ï¼Œæ‰€ä»¥æ“ä½œèµ·æ¥éå¸¸æ–¹ä¾¿ã€‚ char*ï¼šchar *æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥æŒ‡å‘ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè‡³äºè¿™ä¸ªæ•°ç»„å¯ä»¥åœ¨æ ˆä¸Šåˆ†é…ï¼Œä¹Ÿå¯ä»¥åœ¨å †ä¸Šåˆ†é…ï¼Œå †å¾—è¯å°±è¦ä½ æ‰‹åŠ¨é‡Šæ”¾äº†ã€‚ 2ã€åŒºåˆ«ï¼šstringçš„å†…å­˜ç®¡ç†æ˜¯ç”±ç³»ç»Ÿå¤„ç†ï¼Œé™¤éç³»ç»Ÿå†…å­˜æ± ç”¨å®Œï¼Œä¸ç„¶ä¸ä¼šå‡ºç°è¿™ç§å†…å­˜é—®é¢˜ã€‚char *çš„å†…å­˜ç®¡ç†ç”±ç”¨æˆ·è‡ªå·±å¤„ç†ï¼Œå¾ˆå®¹æ˜“å‡ºç°å†…å­˜ä¸è¶³çš„é—®é¢˜ã€‚ å½“æˆ‘ä»¬è¦å­˜ä¸€ä¸ªä¸²ï¼Œä½†æ˜¯ä¸çŸ¥é“å…¶ä»–éœ€è¦å¤šå°‘å†…å­˜æ—¶ï¼Œ ç”¨stringæ¥å¤„ç†å°±æœ€å¥½ä¸è¿‡äº†ã€‚å½“ä½ çŸ¥é“äº†å­˜å‚¨çš„å†…å­˜çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨char *ï¼Œä½†æ˜¯ä¸å¦‚ç”¨stringçš„å¥½ï¼Œç”¨æŒ‡é’ˆæ€»ä¼šæœ‰éšæ‚£ã€‚ ç”¨stringè¿˜å¯ä»¥ä½¿ç”¨å„ç§æˆå‘˜å‡½æ•°æ¥å¤„ç†ä¸²çš„æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œæ–¹ä¾¿å¤„ç†ã€‚ç”¨char *å¤„ç†ä¸²ï¼Œå°±ä¸å¦‚stringçš„æ–¹ä¾¿äº†ï¼Œæ²¡æœ‰ç›¸åº”çš„å‡½æ•°æ¥ç›´æ¥è°ƒç”¨ï¼Œè€Œæ˜¯è¦è‡ªå·±ç¼–å†™å‡½æ•°æ¥å®Œæˆä¸²çš„å¤„ç†ï¼Œè€Œä¸”å¤„ç†è¿‡ç¨‹ä¸­ç”¨æŒ‡é’ˆè¿˜å¾ˆå®¹æ˜“å‡ºç°å†…å­˜é—®é¢˜ã€‚ char *s=â€stringâ€çš„å†…å®¹æ˜¯ä¸å¯ä»¥æ”¹çš„ï¼›char s[10]=â€stringâ€çš„å†…å®¹æ˜¯å¯ä»¥æ”¹çš„ const char* c_str(); c_str()å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘Cå­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å†…å­˜å†…å®¹å’Œstring ç›¸åŒã€‚å› ä¸ºcè¯­è¨€ä¸æ”¯æŒstringç±»å‹ï¼Œæ•…ä¸ºäº†åœ¨c++å…¼å®¹Cå­—ç¬¦ä¸²ï¼Œæä¾›äº†c_str()å‡½æ•°æ¥å®ç°è½¬æ¢ã€‚æ³¨æ„ä¸€å®šè¦ä½¿ç”¨strcpy()å‡½æ•°æ¥æ“ä½œc_str()ï¼›c_str()è¿”å›çš„æ˜¯ä¸€ä¸ªä¸´æ—¶æŒ‡é’ˆï¼Œä¸èƒ½å¯¹å…¶è¿›è¡Œæ“ä½œã€‚ char ch[20]; string s=â€123456â€; strcpy(ch,s.c_str()); c_str()ä»¥char* å½¢å¼ä¼ å›stringå†…å«å­—ç¬¦ä¸² å¦‚æœä¸€ä¸ªå‡½æ•°è¦æ±‚char*å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨c_str()æ–¹æ³• 3ã€æ³¨æ„ï¼šå½“æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªstringï¼Œå°±ä¸èƒ½ç”¨scanf(â€œ%sâ€,s)å’Œprintf(â€œ%sâ€,s)è¾“å…¥è¾“å‡ºã€‚ä¸»è¦æ˜¯å› ä¸º%sè¦æ±‚åé¢æ˜¯å¯¹è±¡çš„é¦–åœ°å€ 4ã€è½¬åŒ–ï¼šå½“ string ç›´æ¥è½¬åŒ–æˆ const char *æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¸¤ä¸ªå‡½æ•°c_str()ï¼Œdataæˆå‘˜å‡½æ•°ï¼Œå…¶ä¸­c_str()å‡½æ•°è¿”å›ä¸€ä¸ªä»¥â€™\\0â€™ç»“å°¾çš„å­—ç¬¦æ•°ç»„ï¼Œè€Œdata()ä»…è¿”å›å­—ç¬¦ä¸²å†…å®¹ï¼Œè€Œä¸å«æœ‰ç»“æŸç¬¦â€™\\0â€™ã€‚","categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"}],"tags":[]},{"title":"c++ç¼–ç¨‹ä¹¦ç±æ€»ç»“","slug":"cppç¼–ç¨‹ä¹¦ç±æ€»ç»“","date":"2021-08-11T12:49:13.000Z","updated":"2021-08-27T14:43:21.847Z","comments":true,"path":"2021/08/11/cppç¼–ç¨‹ä¹¦ç±æ€»ç»“/","link":"","permalink":"https://marblemm.github.io/2021/08/11/cpp%E7%BC%96%E7%A8%8B%E4%B9%A6%E7%B1%8D%E6%80%BB%E7%BB%93/","excerpt":"","text":"1.å…¥é—¨ä¹¦ç±C++ Primer ä¸­æ–‡ç‰ˆï¼ˆç¬¬5ç‰ˆï¼‰C++ Primer (Fifth Edition)C++ Primer Plus ä¸­æ–‡ç‰ˆï¼ˆç¬¬å…­ç‰ˆï¼‰C++ Primer Plus (Sixth Edition) 2.è¿›é˜¶ä¹¦ç±Thinking in C++A Tour Of C++The C++ Standard Library: A Tutorial and ReferenceEffective STLæ³›å‹ç¼–ç¨‹ä¸STLSTLæºç å‰–æ 3.é«˜é˜¶ä¹¦ç±æ·±åº¦æ¢ç´¢Cå¯¹è±¡æ¨¡å‹Design Patterns:Elements of Reusable Object-Oriented softwareè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€STL æºç å‰–æThe C Standard : Incorporating Technical Corrigendum No. 1Preprocessor C++(More)Effective C++(More)Exceptional C++C++ TemplatesCore C++ A Software Engineering Approaché«˜è´¨é‡C++ç¼–ç¨‹æŒ‡å—â€”â€”ä¸Šæµ·è´å°”æ ‡å‡†ç¼–ç¨‹æ–‡æ¡£","categories":[{"name":"ä¹¦ç±","slug":"ä¹¦ç±","permalink":"https://marblemm.github.io/categories/%E4%B9%A6%E7%B1%8D/"}],"tags":[]},{"title":"c++é¢è¯•æ€»ç»“ï¼ˆäºŒï¼‰","slug":"cppé¢è¯•æ€»ç»“ï¼ˆäºŒï¼‰","date":"2021-08-10T13:28:09.000Z","updated":"2021-08-27T14:42:51.327Z","comments":true,"path":"2021/08/10/cppé¢è¯•æ€»ç»“ï¼ˆäºŒï¼‰/","link":"","permalink":"https://marblemm.github.io/2021/08/10/cpp%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93%EF%BC%88%E4%BA%8C%EF%BC%89/","excerpt":"","text":"1.æœ‰å“ªå‡ ç§æƒ…å†µåªèƒ½ç”¨intialization list è€Œä¸èƒ½ç”¨assignment?ç­”æ¡ˆï¼šå½“ç±»ä¸­å«æœ‰constã€reference æˆå‘˜å˜é‡ï¼›åŸºç±»çš„æ„é€ å‡½æ•°éƒ½éœ€è¦åˆå§‹åŒ–è¡¨ã€‚ 2. C++æ˜¯ä¸æ˜¯ç±»å‹å®‰å…¨çš„ï¼Ÿç­”æ¡ˆï¼šä¸æ˜¯ã€‚ä¸¤ä¸ªä¸åŒç±»å‹çš„æŒ‡é’ˆä¹‹é—´å¯ä»¥å¼ºåˆ¶è½¬æ¢ï¼ˆç”¨reinterpret cast)ã€‚C#æ˜¯ç±»å‹å®‰å…¨çš„ã€‚ 3. main å‡½æ•°æ‰§è¡Œä»¥å‰ï¼Œè¿˜ä¼šæ‰§è¡Œä»€ä¹ˆä»£ç ï¼Ÿç­”æ¡ˆï¼šå…¨å±€å¯¹è±¡çš„æ„é€ å‡½æ•°ä¼šåœ¨main å‡½æ•°ä¹‹å‰æ‰§è¡Œã€‚ 4. æè¿°å†…å­˜åˆ†é…æ–¹å¼ä»¥åŠå®ƒä»¬çš„åŒºåˆ«?1ï¼‰ ä»é™æ€å­˜å‚¨åŒºåŸŸåˆ†é…ã€‚å†…å­˜åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™å°±å·²ç»åˆ†é…å¥½ï¼Œè¿™å—å†…å­˜åœ¨ç¨‹åºçš„æ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚ä¾‹å¦‚å…¨å±€å˜é‡ï¼Œstatic å˜é‡ã€‚ 2ï¼‰ åœ¨æ ˆä¸Šåˆ›å»ºã€‚åœ¨æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå‡½æ•°å†…å±€éƒ¨å˜é‡çš„å­˜å‚¨å•å…ƒéƒ½å¯ä»¥åœ¨æ ˆä¸Šåˆ›å»ºï¼Œå‡½æ•°æ‰§è¡Œç»“æŸæ—¶è¿™äº›å­˜å‚¨å•å…ƒè‡ªåŠ¨è¢«é‡Šæ”¾ã€‚æ ˆå†…å­˜åˆ†é…è¿ç®—å†…ç½®äºå¤„ç†å™¨çš„æŒ‡ä»¤é›†ã€‚ 3ï¼‰ ä»å †ä¸Šåˆ†é…ï¼Œäº¦ç§°åŠ¨æ€å†…å­˜åˆ†é…ã€‚ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ç”¨malloc æˆ–new ç”³è¯·ä»»æ„å¤šå°‘çš„å†…å­˜ï¼Œç¨‹åºå‘˜è‡ªå·±è´Ÿè´£åœ¨ä½•æ—¶ç”¨free æˆ–delete é‡Šæ”¾å†…å­˜ã€‚åŠ¨æ€å†…å­˜çš„ç”Ÿå­˜æœŸç”±ç¨‹åºå‘˜å†³å®šï¼Œä½¿ç”¨éå¸¸çµæ´»ï¼Œä½†é—®é¢˜ä¹Ÿæœ€å¤šã€‚ 5.è¯·è¯´å‡ºconstä¸#define ç›¸æ¯”ï¼Œæœ‰ä½•ä¼˜ç‚¹ï¼Ÿç­”æ¡ˆï¼š constä½œç”¨ï¼šå®šä¹‰å¸¸é‡ã€ä¿®é¥°å‡½æ•°å‚æ•°ã€ä¿®é¥°å‡½æ•°è¿”å›å€¼ä¸‰ä¸ªä½œç”¨ã€‚è¢«Constä¿®é¥°çš„ä¸œè¥¿éƒ½å—åˆ°å¼ºåˆ¶ä¿æŠ¤ï¼Œå¯ä»¥é¢„é˜²æ„å¤–çš„å˜åŠ¨ï¼Œèƒ½æé«˜ç¨‹åºçš„å¥å£®æ€§ã€‚ 1ï¼‰ const å¸¸é‡æœ‰æ•°æ®ç±»å‹ï¼Œè€Œå®å¸¸é‡æ²¡æœ‰æ•°æ®ç±»å‹ã€‚ç¼–è¯‘å™¨å¯ä»¥å¯¹å‰è€…è¿›è¡Œç±»å‹å®‰å…¨æ£€æŸ¥ã€‚è€Œå¯¹åè€…åªè¿›è¡Œå­—ç¬¦æ›¿æ¢ï¼Œæ²¡æœ‰ç±»å‹å®‰å…¨æ£€æŸ¥ï¼Œå¹¶ä¸”åœ¨å­—ç¬¦æ›¿æ¢å¯èƒ½ä¼šäº§ç”Ÿæ„æ–™ä¸åˆ°çš„é”™è¯¯ã€‚ 2ï¼‰ æœ‰äº›é›†æˆåŒ–çš„è°ƒè¯•å·¥å…·å¯ä»¥å¯¹const å¸¸é‡è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯ä¸èƒ½å¯¹å®å¸¸é‡è¿›è¡Œè°ƒè¯•ã€‚ 6.ç®€è¿°æ•°ç»„ä¸æŒ‡é’ˆçš„åŒºåˆ«ï¼Ÿæ•°ç»„è¦ä¹ˆåœ¨é™æ€å­˜å‚¨åŒºè¢«åˆ›å»ºï¼ˆå¦‚å…¨å±€æ•°ç»„ï¼‰ï¼Œè¦ä¹ˆåœ¨æ ˆä¸Šè¢«åˆ›å»ºã€‚æŒ‡é’ˆå¯ä»¥éšæ—¶æŒ‡å‘ä»»æ„ç±»å‹çš„å†…å­˜å—ã€‚ 1234567891011121314151617181920212223242526272829(1)ä¿®æ”¹å†…å®¹ä¸Šçš„å·®åˆ«char a[] = â€œhelloâ€;a[0] = â€˜Xâ€™;char *p = â€œworldâ€; // æ³¨æ„p æŒ‡å‘å¸¸é‡å­—ç¬¦ä¸²p[0] = â€˜Xâ€™; // ç¼–è¯‘å™¨ä¸èƒ½å‘ç°è¯¥é”™è¯¯ï¼Œè¿è¡Œæ—¶é”™è¯¯(2) ç”¨è¿ç®—ç¬¦sizeof å¯ä»¥è®¡ç®—å‡ºæ•°ç»„çš„å®¹é‡ï¼ˆå­—èŠ‚æ•°ï¼‰ã€‚sizeof(p),p ä¸ºæŒ‡é’ˆå¾—åˆ°çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡çš„å­—èŠ‚æ•°ï¼Œè€Œä¸æ˜¯p æ‰€æŒ‡çš„å†…å­˜å®¹é‡ã€‚C++/C è¯­è¨€æ²¡æœ‰åŠæ³•çŸ¥é“æŒ‡é’ˆæ‰€æŒ‡çš„å†…å­˜å®¹é‡ï¼Œé™¤éåœ¨ç”³è¯·å†…å­˜æ—¶è®°ä½å®ƒã€‚æ³¨æ„å½“æ•°ç»„ä½œä¸ºå‡½æ•°çš„å‚æ•°è¿›è¡Œä¼ é€’æ—¶ï¼Œè¯¥æ•°ç»„è‡ªåŠ¨é€€åŒ–ä¸ºåŒç±»å‹çš„æŒ‡é’ˆã€‚char a[] = &quot;hello world&quot;;char *p = a;cout&lt;&lt; sizeof(a) &lt;&lt; endl; // 12 å­—èŠ‚cout&lt;&lt; sizeof(p) &lt;&lt; endl; // 4 å­—èŠ‚è®¡ç®—æ•°ç»„å’ŒæŒ‡é’ˆçš„å†…å­˜å®¹é‡void Func(char a[100])&#123;cout&lt;&lt; sizeof(a) &lt;&lt; endl; // 4 å­—èŠ‚è€Œä¸æ˜¯100 å­—èŠ‚&#125; 7ï¼š int (*s[10])(int) è¡¨ç¤ºçš„æ˜¯ä»€ä¹ˆï¼Ÿint (*s[10])(int) å‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼Œæ¯ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªint func(int param)çš„å‡½æ•°ã€‚ 8ï¼šæ ˆå†…å­˜ä¸æ–‡å­—å¸¸é‡åŒº12345678910111213141516171819char str1[] = &quot;abc&quot;; char str2[] = &quot;abc&quot;; const char str3[] = &quot;abc&quot;; const char str4[] = &quot;abc&quot;; const char *str5 = &quot;abc&quot;; const char *str6 = &quot;abc&quot;; char *str7 = &quot;abc&quot;; char *str8 = &quot;abc&quot;; cout &lt;&lt; ( str1 == str2 ) &lt;&lt; endl;//0 åˆ†åˆ«æŒ‡å‘å„è‡ªçš„æ ˆå†…å­˜ cout &lt;&lt; ( str3 == str4 ) &lt;&lt; endl;//0 åˆ†åˆ«æŒ‡å‘å„è‡ªçš„æ ˆå†…å­˜ cout &lt;&lt; ( str5 == str6 ) &lt;&lt; endl;//1æŒ‡å‘æ–‡å­—å¸¸é‡åŒºåœ°å€ç›¸åŒ cout &lt;&lt; ( str7 == str8 ) &lt;&lt; endl;//1æŒ‡å‘æ–‡å­—å¸¸é‡åŒºåœ°å€ç›¸åŒ ç»“æœæ˜¯ï¼š0 0 1 1 è§£ç­”ï¼šstr1,str2,str3,str4æ˜¯æ•°ç»„å˜é‡ï¼Œå®ƒä»¬æœ‰å„è‡ªçš„å†…å­˜ç©ºé—´ï¼›è€Œstr5,str6,str7,str8æ˜¯æŒ‡é’ˆï¼Œå®ƒä»¬æŒ‡å‘ç›¸åŒçš„å¸¸é‡åŒºåŸŸã€‚ 9ï¼šå°†ç¨‹åºè·³è½¬åˆ°æŒ‡å®šå†…å­˜åœ°å€è¦å¯¹ç»å¯¹åœ°å€0x100000èµ‹å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨(unsigned int*)0x100000 = 1234;é‚£ä¹ˆè¦æ˜¯æƒ³è®©ç¨‹åºè·³è½¬åˆ°ç»å¯¹åœ°å€æ˜¯0x100000å»æ‰§è¡Œï¼Œåº”è¯¥æ€ä¹ˆåšï¼Ÿ 123456789 *((void (*)( ))0x100000 ) ( ); é¦–å…ˆè¦å°†0x100000å¼ºåˆ¶è½¬æ¢æˆå‡½æ•°æŒ‡é’ˆ,å³: (void (*)())0x100000 ç„¶åå†è°ƒç”¨å®ƒ: *((void (*)())0x100000)(); ç”¨typedefå¯ä»¥çœ‹å¾—æ›´ç›´è§‚äº›: typedef void(*)() voidFuncPtr; *((voidFuncPtr)0x100000)(); 10ï¼šint id[sizeof(unsigned long)];è¿™ä¸ªå¯¹å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ ç­”æ¡ˆ:æ­£ç¡® è¿™ä¸ª sizeofæ˜¯ç¼–è¯‘æ—¶è¿ç®—ç¬¦ï¼Œç¼–è¯‘æ—¶å°±ç¡®å®šäº† ,å¯ä»¥çœ‹æˆå’Œæœºå™¨æœ‰å…³çš„å¸¸é‡ã€‚ å½“sizeofçš„å‚æ•°æ˜¯æ•°ç»„åæ—¶ï¼Œè®¡ç®—çš„æ˜¯æ•´ä¸ªæ•°ç»„çš„å­˜å‚¨å¤§å°ï¼›å½“sizeofçš„å‚æ•°æ˜¯æŒ‡é’ˆæ—¶ï¼Œè®¡ç®—çš„æ˜¯æŒ‡é’ˆçš„å¤§å°ï¼ˆ8å­—èŠ‚ï¼Œ64ä½ç³»ç»Ÿï¼‰ 11ï¼šå¼•ç”¨ä¸æŒ‡é’ˆæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€å‚è€ƒç­”æ¡ˆã€‘ å¼•ç”¨å¿…é¡»è¢«åˆå§‹åŒ–ï¼ŒæŒ‡é’ˆä¸å¿…ã€‚ å¼•ç”¨åˆå§‹åŒ–ä»¥åä¸èƒ½è¢«æ”¹å˜ï¼ŒæŒ‡é’ˆå¯ä»¥æ”¹å˜æ‰€æŒ‡çš„å¯¹è±¡ã€‚ ä¸å­˜åœ¨æŒ‡å‘ç©ºå€¼çš„å¼•ç”¨ï¼Œä½†æ˜¯å­˜åœ¨æŒ‡å‘ç©ºå€¼çš„æŒ‡é’ˆã€‚ 12ï¼šåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿã€å‚è€ƒç­”æ¡ˆã€‘æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ç”¨ä¸ä¸Šï¼Œä¼šé€ æˆèµ„æºçš„æ³„æ¼ã€‚ 13ï¼šå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿæ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨æ˜¯æ€ä¹ˆçŸ¥é“çš„ï¼Ÿã€å‚è€ƒç­”æ¡ˆã€‘ ç”Ÿå‘½å‘¨æœŸä¸åŒï¼š å…¨å±€å˜é‡éšä¸»ç¨‹åºåˆ›å»ºå’Œåˆ›å»ºï¼Œéšä¸»ç¨‹åºé”€æ¯è€Œé”€æ¯ï¼›å±€éƒ¨å˜é‡åœ¨å±€éƒ¨å‡½æ•°å†…éƒ¨ï¼Œç”šè‡³å±€éƒ¨å¾ªç¯ä½“ç­‰å†…éƒ¨å­˜åœ¨ï¼Œé€€å‡ºå°±ä¸å­˜åœ¨ï¼› ä½¿ç”¨æ–¹å¼ä¸åŒï¼šé€šè¿‡å£°æ˜åå…¨å±€å˜é‡ç¨‹åºçš„å„ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥ç”¨åˆ°ï¼›å±€éƒ¨å˜é‡åªèƒ½åœ¨å±€éƒ¨ä½¿ç”¨ï¼›åˆ†é…åœ¨æ ˆåŒºã€‚ æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨é€šè¿‡å†…å­˜åˆ†é…çš„ä½ç½®æ¥çŸ¥é“çš„ï¼Œå…¨å±€å˜é‡åˆ†é…åœ¨å…¨å±€æ•°æ®æ®µå¹¶ä¸”åœ¨ç¨‹åºå¼€å§‹è¿è¡Œçš„æ—¶å€™è¢«åŠ è½½ã€‚å±€éƒ¨å˜é‡åˆ™åˆ†é…åœ¨å †æ ˆé‡Œé¢ ã€‚ STLä¸­æ’åºç®—æ³•çš„å®ç°æ˜¯ä»€ä¹ˆè§£ç­”ï¼šSTLä¸­çš„sort()ï¼Œåœ¨æ•°æ®é‡å¤§æ—¶ï¼Œé‡‡ç”¨quicksortï¼Œåˆ†æ®µé€’å½’æ’åºï¼›ä¸€æ—¦åˆ†æ®µåçš„æ•°é‡å°äºæŸä¸ªé—¨é™å€¼ï¼Œæ”¹ç”¨Insertion sortï¼Œé¿å…quicksortæ·±åº¦é€’å½’å¸¦æ¥çš„è¿‡å¤§çš„é¢å¤–è´Ÿæ‹…ï¼Œå¦‚æœé€’å½’å±‚æ¬¡è¿‡æ·±ï¼Œè¿˜ä¼šæ”¹ç”¨heapsortã€‚ ä¸ºä»€ä¹ˆå‡½æ•°å‚æ•°çš„å…¥æ ˆçš„é¡ºåºæ˜¯ä»å³å¾€å·¦å› ä¸ºå¥½å¤šå‡½æ•°æ˜¯ä¸å®šå‚æ•°ä¸ªæ•°çš„ï¼Œæ¯”å¦‚æœ€å¸¸ç”¨çš„printfï¼Œæ‰€ä»¥éœ€è¦å‚æ•°çš„å…¥æ ˆé¡ºåºæ˜¯ä»å³å¾€å·¦ã€‚ 5. staticçš„ç”¨æ³•å’Œä½œç”¨ï¼Ÿ1.å…ˆæ¥ä»‹ç»å®ƒçš„ç¬¬ä¸€æ¡ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ¡ï¼šéšè—ã€‚ï¼ˆstaticå‡½æ•°ï¼Œstaticå˜é‡å‡å¯ï¼‰ å½“åŒæ—¶ç¼–è¯‘å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œæ‰€æœ‰æœªåŠ staticå‰ç¼€çš„å…¨å±€å˜é‡å’Œå‡½æ•°éƒ½å…·æœ‰å…¨å±€å¯è§æ€§ã€‚ 2.staticçš„ç¬¬äºŒä¸ªä½œç”¨æ˜¯ä¿æŒå˜é‡å†…å®¹çš„æŒä¹…ã€‚ï¼ˆstaticå˜é‡ä¸­çš„è®°å¿†åŠŸèƒ½å’Œå…¨å±€ç”Ÿå­˜æœŸï¼‰å­˜å‚¨åœ¨é™æ€æ•°æ®åŒºçš„å˜é‡ä¼šåœ¨ç¨‹åºåˆšå¼€å§‹è¿è¡Œæ—¶å°±å®Œæˆåˆå§‹åŒ–ï¼Œä¹Ÿæ˜¯å”¯ä¸€çš„ä¸€æ¬¡åˆå§‹åŒ–ã€‚å…±æœ‰ä¸¤ç§å˜é‡å­˜å‚¨åœ¨é™æ€å­˜å‚¨åŒºï¼šå…¨å±€å˜é‡å’Œstaticå˜é‡ï¼Œåªä¸è¿‡å’Œå…¨å±€å˜é‡æ¯”èµ·æ¥ï¼Œstaticå¯ä»¥æ§åˆ¶å˜é‡çš„å¯è§èŒƒå›´ï¼Œè¯´åˆ°åº•staticè¿˜æ˜¯ç”¨æ¥éšè—çš„ã€‚ 3.staticçš„ç¬¬ä¸‰ä¸ªä½œç”¨æ˜¯é»˜è®¤åˆå§‹åŒ–ä¸º0ï¼ˆstaticå˜é‡ï¼‰ å…¶å®å…¨å±€å˜é‡ä¹Ÿå…·å¤‡è¿™ä¸€å±æ€§ï¼Œå› ä¸ºå…¨å±€å˜é‡ä¹Ÿå­˜å‚¨åœ¨é™æ€æ•°æ®åŒºã€‚åœ¨é™æ€æ•°æ®åŒºï¼Œå†…å­˜ä¸­æ‰€æœ‰çš„å­—èŠ‚é»˜è®¤å€¼éƒ½æ˜¯0x00ï¼ŒæŸäº›æ—¶å€™è¿™ä¸€ç‰¹ç‚¹å¯ä»¥å‡å°‘ç¨‹åºå‘˜çš„å·¥ä½œé‡ã€‚ 4.staticçš„ç¬¬å››ä¸ªä½œç”¨ï¼šC++ä¸­çš„ç±»æˆå‘˜å£°æ˜static å‡½æ•°ä½“å†…staticå˜é‡çš„ä½œç”¨èŒƒå›´ä¸ºè¯¥å‡½æ•°ä½“ï¼Œä¸åŒäºautoå˜é‡ï¼Œè¯¥å˜é‡çš„å†…å­˜åªè¢«åˆ†é…ä¸€æ¬¡ï¼Œå› æ­¤å…¶å€¼åœ¨ä¸‹æ¬¡è°ƒç”¨æ—¶ä»ç»´æŒä¸Šæ¬¡çš„å€¼ï¼› åœ¨æ¨¡å—å†…çš„staticå…¨å±€å˜é‡å¯ä»¥è¢«æ¨¡å—å†…æ‰€ç”¨å‡½æ•°è®¿é—®ï¼Œä½†ä¸èƒ½è¢«æ¨¡å—å¤–å…¶å®ƒå‡½æ•°è®¿é—®ï¼› åœ¨æ¨¡å—å†…çš„staticå‡½æ•°åªå¯è¢«è¿™ä¸€æ¨¡å—å†…çš„å…¶å®ƒå‡½æ•°è°ƒç”¨ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨èŒƒå›´è¢«é™åˆ¶åœ¨å£°æ˜å®ƒçš„æ¨¡å—å†…ï¼› åœ¨ç±»ä¸­çš„staticæˆå‘˜å˜é‡å±äºæ•´ä¸ªç±»æ‰€æ‹¥æœ‰ï¼Œå¯¹ç±»çš„æ‰€æœ‰å¯¹è±¡åªæœ‰ä¸€ä»½æ‹·è´ï¼› åœ¨ç±»ä¸­çš„staticæˆå‘˜å‡½æ•°å±äºæ•´ä¸ªç±»æ‰€æ‹¥æœ‰ï¼Œè¿™ä¸ªå‡½æ•°ä¸æ¥æ”¶thisæŒ‡é’ˆï¼Œå› è€Œåªèƒ½è®¿é—®ç±»çš„staticæˆå‘˜å˜é‡ã€‚ ç±»å†…ï¼š staticç±»å¯¹è±¡å¿…é¡»è¦åœ¨ç±»å¤–è¿›è¡Œåˆå§‹åŒ–ï¼Œstaticä¿®é¥°çš„å˜é‡å…ˆäºå¯¹è±¡å­˜åœ¨ï¼Œæ‰€ä»¥staticä¿®é¥°çš„å˜é‡è¦åœ¨ç±»å¤–åˆå§‹åŒ–ï¼› ç”±äºstaticä¿®é¥°çš„ç±»æˆå‘˜å±äºç±»ï¼Œä¸å±äºå¯¹è±¡ï¼Œå› æ­¤staticç±»æˆå‘˜å‡½æ•°æ˜¯æ²¡æœ‰thisæŒ‡é’ˆçš„ï¼ŒthisæŒ‡é’ˆæ˜¯æŒ‡å‘æœ¬å¯¹è±¡çš„æŒ‡é’ˆã€‚æ­£å› ä¸ºæ²¡æœ‰thisæŒ‡é’ˆï¼Œæ‰€ä»¥staticç±»æˆå‘˜å‡½æ•°ä¸èƒ½è®¿é—®éstaticçš„ç±»æˆå‘˜ï¼Œåªèƒ½è®¿é—® staticä¿®é¥°çš„ç±»æˆå‘˜ï¼› staticæˆå‘˜å‡½æ•°ä¸èƒ½è¢«virtualä¿®é¥°ï¼Œstaticæˆå‘˜ä¸å±äºä»»ä½•å¯¹è±¡æˆ–å®ä¾‹ï¼Œæ‰€ä»¥åŠ ä¸Švirtualæ²¡æœ‰ä»»ä½•å®é™…æ„ä¹‰ï¼›é™æ€æˆå‘˜å‡½æ•°æ²¡æœ‰thisæŒ‡é’ˆï¼Œè™šå‡½æ•°çš„å®ç°æ˜¯ä¸ºæ¯ä¸€ä¸ªå¯¹è±¡åˆ†é…ä¸€ä¸ªvptræŒ‡é’ˆï¼Œè€Œvptræ˜¯é€šè¿‡thisæŒ‡é’ˆè°ƒç”¨çš„ï¼Œæ‰€ä»¥ä¸èƒ½ä¸ºvirtualï¼›è™šå‡½æ•°çš„è°ƒç”¨å…³ç³»ï¼Œthis-&gt;vptr-&gt;ctable-&gt;virtual function 8. constæˆå‘˜å‡½æ•°çš„ç†è§£å’Œåº”ç”¨ï¼Ÿâ‘  const Stock &amp; Stock::topval (â‘¡const Stock &amp; s) â‘¢const â‘ å¤„constï¼šç¡®ä¿è¿”å›çš„Stockå¯¹è±¡åœ¨ä»¥åçš„ä½¿ç”¨ä¸­ä¸èƒ½è¢«ä¿®æ”¹ â‘¡å¤„constï¼šç¡®ä¿æ­¤æ–¹æ³•ä¸ä¿®æ”¹ä¼ é€’çš„å‚æ•° S â‘¢å¤„constï¼šä¿è¯æ­¤æ–¹æ³•ä¸ä¿®æ”¹è°ƒç”¨å®ƒçš„å¯¹è±¡ï¼Œconstå¯¹è±¡åªèƒ½è°ƒç”¨constæˆå‘˜å‡½æ•°,ä¸èƒ½è°ƒç”¨éconstå‡½æ•° 11. externç”¨æ³•ï¼Ÿ externä¿®é¥°å˜é‡çš„å£°æ˜ å¦‚æœæ–‡ä»¶a.céœ€è¦å¼•ç”¨b.cä¸­å˜é‡int vï¼Œå°±å¯ä»¥åœ¨a.cä¸­å£°æ˜extern int vï¼Œç„¶åå°±å¯ä»¥å¼•ç”¨å˜é‡vã€‚ externä¿®é¥°å‡½æ•°çš„å£°æ˜ å¦‚æœæ–‡ä»¶a.céœ€è¦å¼•ç”¨b.cä¸­çš„å‡½æ•°ï¼Œæ¯”å¦‚åœ¨b.cä¸­åŸå‹æ˜¯int fun(int mu)ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨a.cä¸­å£°æ˜extern int funï¼ˆint muï¼‰ï¼Œç„¶åå°±èƒ½ä½¿ç”¨funæ¥åšä»»ä½•äº‹æƒ…ã€‚å°±åƒå˜é‡çš„å£°æ˜ä¸€æ ·ï¼Œextern int funï¼ˆint muï¼‰å¯ä»¥æ”¾åœ¨a.cä¸­ä»»ä½•åœ°æ–¹ï¼Œè€Œä¸ä¸€å®šéè¦æ”¾åœ¨a.cçš„æ–‡ä»¶ä½œç”¨åŸŸçš„èŒƒå›´ä¸­ã€‚ externä¿®é¥°ç¬¦å¯ç”¨äºæŒ‡ç¤ºCæˆ–è€…Cï¼‹ï¼‹å‡½æ•°çš„è°ƒç”¨è§„èŒƒã€‚ æ¯”å¦‚åœ¨Cï¼‹ï¼‹ä¸­è°ƒç”¨Cåº“å‡½æ•°ï¼Œå°±éœ€è¦åœ¨Cï¼‹ï¼‹ç¨‹åºä¸­ç”¨extern â€œCâ€å£°æ˜è¦å¼•ç”¨çš„å‡½æ•°ã€‚è¿™æ˜¯ç»™é“¾æ¥å™¨ç”¨çš„ï¼Œå‘Šè¯‰é“¾æ¥å™¨åœ¨é“¾æ¥çš„æ—¶å€™ç”¨Cå‡½æ•°è§„èŒƒæ¥é“¾æ¥ã€‚ä¸»è¦åŸå› æ˜¯Cï¼‹ï¼‹å’ŒCç¨‹åºç¼–è¯‘å®Œæˆååœ¨ç›®æ ‡ä»£ç ä¸­å‘½åè§„åˆ™ä¸åŒã€‚ 21. æ„é€ å‡½æ•°å’Œææ„å‡½æ•°å¯ä»¥è°ƒç”¨è™šå‡½æ•°å—ï¼Œä¸ºä»€ä¹ˆ åœ¨C++ä¸­ï¼Œæå€¡ä¸åœ¨æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼› æ„é€ å‡½æ•°å’Œææ„å‡½æ•°è°ƒç”¨è™šå‡½æ•°æ—¶éƒ½ä¸ä½¿ç”¨åŠ¨æ€è”ç¼–ï¼Œå¦‚æœåœ¨æ„é€ å‡½æ•°æˆ–ææ„å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œåˆ™è¿è¡Œçš„æ˜¯ä¸ºæ„é€ å‡½æ•°æˆ–ææ„å‡½æ•°è‡ªèº«ç±»å‹å®šä¹‰çš„ç‰ˆæœ¬ï¼› å› ä¸ºçˆ¶ç±»å¯¹è±¡ä¼šåœ¨å­ç±»ä¹‹å‰è¿›è¡Œæ„é€ ï¼Œæ­¤æ—¶å­ç±»éƒ¨åˆ†çš„æ•°æ®æˆå‘˜è¿˜æœªåˆå§‹åŒ–ï¼Œå› æ­¤è°ƒç”¨å­ç±»çš„è™šå‡½æ•°æ—¶ä¸å®‰å…¨çš„ï¼Œæ•…è€ŒC++ä¸ä¼šè¿›è¡ŒåŠ¨æ€è”ç¼–ï¼› ææ„å‡½æ•°æ˜¯ç”¨æ¥é”€æ¯ä¸€ä¸ªå¯¹è±¡çš„ï¼Œåœ¨é”€æ¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå…ˆè°ƒç”¨å­ç±»çš„ææ„å‡½æ•°ï¼Œç„¶åå†è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ã€‚æ‰€ä»¥åœ¨è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°æ—¶ï¼Œæ´¾ç”Ÿç±»å¯¹è±¡çš„æ•°æ®æˆå‘˜å·²ç»é”€æ¯ï¼Œè¿™ä¸ªæ—¶å€™å†è°ƒç”¨å­ç±»çš„è™šå‡½æ•°æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ å‚è€ƒï¼š https://zhuanlan.zhihu.com/p/143177919","categories":[{"name":"c++é¢è¯•","slug":"c-é¢è¯•","permalink":"https://marblemm.github.io/categories/c-%E9%9D%A2%E8%AF%95/"}],"tags":[]},{"title":"c++é¢è¯•æ€»ç»“ï¼ˆä¸€ï¼‰","slug":"cppé¢è¯•æ€»ç»“ï¼ˆä¸€ï¼‰","date":"2021-08-09T15:50:50.000Z","updated":"2021-08-27T14:42:07.081Z","comments":true,"path":"2021/08/09/cppé¢è¯•æ€»ç»“ï¼ˆä¸€ï¼‰/","link":"","permalink":"https://marblemm.github.io/2021/08/09/cpp%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%80%EF%BC%89/","excerpt":"","text":"1.newã€deleteã€mallocã€freeå…³ç³»deleteä¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°,å’Œnewå¯¹åº”freeåªä¼šé‡Šæ”¾å†…å­˜ï¼Œnewè°ƒç”¨æ„é€ å‡½æ•°ã€‚mallocä¸freeæ˜¯C++/Cè¯­è¨€çš„æ ‡å‡†åº“å‡½æ•°ï¼Œnew/deleteæ˜¯C++çš„è¿ç®—ç¬¦ã€‚å®ƒä»¬éƒ½å¯ç”¨äºç”³è¯·åŠ¨æ€å†…å­˜å’Œé‡Šæ”¾å†…å­˜ã€‚å¯¹äºéå†…éƒ¨æ•°æ®ç±»å‹çš„å¯¹è±¡è€Œè¨€ï¼Œå…‰ç”¨maloc/freeæ— æ³•æ»¡è¶³åŠ¨æ€å¯¹è±¡çš„è¦æ±‚ã€‚å¯¹è±¡åœ¨åˆ›å»ºçš„åŒæ—¶è¦è‡ªåŠ¨æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå¯¹è±¡åœ¨æ¶ˆäº¡ä¹‹å‰è¦è‡ªåŠ¨æ‰§è¡Œææ„å‡½æ•°ã€‚ç”±äºmalloc/freeæ˜¯åº“å‡½æ•°è€Œä¸æ˜¯è¿ç®—ç¬¦ï¼Œä¸åœ¨ç¼–è¯‘å™¨æ§åˆ¶æƒé™ä¹‹å†…ï¼Œä¸èƒ½å¤ŸæŠŠæ‰§è¡Œæ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„ä»»åŠ¡å¼ºåŠ äºmalloc/freeã€‚å› æ­¤C++è¯­è¨€éœ€è¦ä¸€ä¸ªèƒ½å®ŒæˆåŠ¨æ€å†…å­˜åˆ†é…å’Œåˆå§‹åŒ–å·¥ä½œçš„è¿ç®—ç¬¦newï¼Œä»¥åŠä¸€ä¸ªèƒ½å®Œæˆæ¸…ç†ä¸é‡Šæ”¾å†…å­˜å·¥ä½œçš„è¿ç®—ç¬¦deleteã€‚æ³¨æ„new/deleteä¸æ˜¯åº“å‡½æ•°ã€‚ 2.deleteä¸ delete []åŒºåˆ«deleteåªä¼šè°ƒç”¨ä¸€æ¬¡ææ„å‡½æ•°ï¼Œè€Œdelete[]ä¼šè°ƒç”¨æ¯ä¸€ä¸ªæˆå‘˜çš„ææ„å‡½æ•°ã€‚åœ¨More Effective C++ä¸­æœ‰æ›´ä¸ºè¯¦ç»†çš„è§£é‡Šï¼šâ€œå½“deleteæ“ä½œç¬¦ç”¨äºæ•°ç»„æ—¶ï¼Œå®ƒä¸ºæ¯ä¸ªæ•°ç»„å…ƒç´ è°ƒç”¨ææ„å‡½æ•°ï¼Œç„¶åè°ƒç”¨operator deleteæ¥é‡Šæ”¾å†…å­˜ã€‚â€deleteä¸newé…å¥—ï¼Œdelete []ä¸new []é…å¥— ï¼ˆ1ï¼‰. é’ˆå¯¹ç®€å•ç±»å‹ ä½¿ç”¨newåˆ†é…åçš„ä¸ç®¡æ˜¯æ•°ç»„è¿˜æ˜¯éæ•°ç»„å½¢å¼å†…å­˜ç©ºé—´ç”¨ä¸¤ç§æ–¹å¼å‡å¯ å¦‚ï¼š 123456int *a = new int[10];delete a;delete [] a;æ­¤ç§æƒ…å†µä¸­çš„é‡Šæ”¾æ•ˆæœç›¸åŒï¼ŒåŸå› åœ¨äºï¼šåˆ†é…ç®€å•ç±»å‹å†…å­˜æ—¶ï¼Œå†…å­˜å¤§å°å·²ç»ç¡®å®šï¼Œç³»ç»Ÿå¯ä»¥è®°å¿†å¹¶ä¸”è¿›è¡Œç®¡ç†ï¼Œåœ¨ææ„æ—¶ï¼Œç³»ç»Ÿå¹¶ä¸ä¼šè°ƒç”¨ææ„å‡½æ•°ï¼Œå®ƒç›´æ¥é€šè¿‡æŒ‡é’ˆå¯ä»¥è·å–å®é™…åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œå“ªæ€•æ˜¯ä¸€ä¸ªæ•°ç»„å†…å­˜ç©ºé—´(åœ¨åˆ†é…è¿‡ç¨‹ä¸­ ç³»ç»Ÿä¼šè®°å½•åˆ†é…å†…å­˜çš„å¤§å°ç­‰ä¿¡æ¯ï¼Œæ­¤ä¿¡æ¯ä¿å­˜åœ¨ç»“æ„ä½“_CrtMemBlockHeaderä¸­ï¼Œå…·ä½“æƒ…å†µå¯å‚çœ‹VCå®‰è£…ç›®å½•ä¸‹CRT\\SRC\\DBGDEL.cpp) ï¼ˆ2ï¼‰. é’ˆå¯¹ç±»Classï¼Œä¸¤ç§æ–¹å¼ä½“ç°å‡ºå…·ä½“å·®å¼‚ 123456789101112131415161718 å½“ä½ é€šè¿‡ä¸‹åˆ—æ–¹å¼åˆ†é…ä¸€ä¸ªç±»å¯¹è±¡æ•°ç»„ï¼š class A &#123; private: char *m_cBuffer; int m_nLen; public: A()&#123; m_cBuffer = new char[m_nLen]; &#125; ~A() &#123; delete [] m_cBuffer; &#125; &#125;; A *a = new A[10]; delete a; //ä»…é‡Šæ”¾äº†aæŒ‡é’ˆæŒ‡å‘çš„å…¨éƒ¨å†…å­˜ç©ºé—´ ä½†æ˜¯åªè°ƒç”¨äº†a[0]å¯¹è±¡çš„ææ„å‡½æ•° å‰©ä¸‹çš„ä»a[1]åˆ°a[9]è¿™9ä¸ªç”¨æˆ·è‡ªè¡Œåˆ†é…çš„m_cBufferå¯¹åº”å†…å­˜ç©ºé—´å°†ä¸èƒ½é‡Šæ”¾ ä»è€Œé€ æˆå†…å­˜æ³„æ¼ delete [] a; //è°ƒç”¨ä½¿ç”¨ç±»å¯¹è±¡çš„ææ„å‡½æ•°é‡Šæ”¾ç”¨æˆ·è‡ªå·±åˆ†é…å†…å­˜ç©ºé—´å¹¶ä¸” é‡Šæ”¾äº†aæŒ‡é’ˆæŒ‡å‘çš„å…¨éƒ¨å†…å­˜ç©ºé—´æ‰€ä»¥æ€»ç»“ä¸‹å°±æ˜¯ï¼Œå¦‚æœpträ»£è¡¨ä¸€ä¸ªç”¨newç”³è¯·çš„å†…å­˜è¿”å›çš„å†…å­˜ç©ºé—´åœ°å€ï¼Œå³æ‰€è°“çš„æŒ‡é’ˆï¼Œé‚£ä¹ˆï¼š delete ptr ä»£è¡¨ç”¨æ¥é‡Šæ”¾å†…å­˜ï¼Œä¸”åªç”¨æ¥é‡Šæ”¾ptræŒ‡å‘çš„å†…å­˜ã€‚ delete[] rg ç”¨æ¥é‡Šæ”¾rgæŒ‡å‘çš„å†…å­˜ï¼Œï¼ï¼è¿˜é€ä¸€è°ƒç”¨æ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡çš„destructorï¼ï¼ å¯¹äºåƒint/char/long/int*/structç­‰ç­‰ç®€å•æ•°æ®ç±»å‹ï¼Œç”±äºå¯¹è±¡æ²¡æœ‰destructorï¼Œæ‰€ä»¥ç”¨delete å’Œdelete [] æ˜¯ä¸€æ ·çš„ï¼ä½†æ˜¯å¦‚æœæ˜¯C++å¯¹è±¡æ•°ç»„å°±ä¸åŒäº†ï¼ 3.å­ç±»ææ„æ—¶è¦è°ƒç”¨çˆ¶ç±»çš„ææ„å‡½æ•°å—ï¼Ÿææ„å‡½æ•°è°ƒç”¨çš„æ¬¡åºæ˜¯å…ˆæ´¾ç”Ÿç±»çš„ææ„ååŸºç±»çš„ææ„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨åŸºç±»çš„çš„ææ„è°ƒç”¨çš„æ—¶å€™,æ´¾ç”Ÿç±»çš„ä¿¡æ¯å·²ç»å…¨éƒ¨é”€æ¯äº†ã€‚å®šä¹‰ä¸€ä¸ªå¯¹è±¡æ—¶å…ˆè°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ã€ç„¶åè°ƒç”¨æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°ï¼›ææ„çš„æ—¶å€™æ°å¥½ç›¸åï¼šå…ˆè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ã€ç„¶åè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ã€‚ 4.å¤šæ€ï¼Œè™šå‡½æ•°ï¼Œçº¯è™šå‡½æ•°å¤šæ€ï¼šæ˜¯å¯¹äºä¸åŒå¯¹è±¡æ¥æ”¶ç›¸åŒæ¶ˆæ¯æ—¶äº§ç”Ÿä¸åŒçš„åŠ¨ä½œã€‚C++çš„å¤šæ€æ€§å…·ä½“ä½“ç°åœ¨è¿è¡Œå’Œç¼–è¯‘ä¸¤ä¸ªæ–¹é¢ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶çš„å¤šæ€æ€§é€šè¿‡ç»§æ‰¿å’Œè™šå‡½æ•°æ¥ä½“ç°ï¼› åœ¨ç¨‹åºç¼–è¯‘æ—¶å¤šæ€æ€§ä½“ç°åœ¨å‡½æ•°å’Œè¿ç®—ç¬¦çš„é‡è½½ä¸Šï¼› è™šå‡½æ•°ï¼šåœ¨åŸºç±»ä¸­å† ä»¥å…³é”®å­— virtual çš„æˆå‘˜å‡½æ•°ã€‚ å®ƒæä¾›äº†ä¸€ç§æ¥å£ç•Œé¢ã€‚å…è®¸åœ¨æ´¾ç”Ÿç±»ä¸­å¯¹åŸºç±»çš„è™šå‡½æ•°é‡æ–°å®šä¹‰ã€‚ çº¯è™šå‡½æ•°çš„ä½œç”¨ï¼šåœ¨åŸºç±»ä¸­ä¸ºå…¶æ´¾ç”Ÿç±»ä¿ç•™ä¸€ä¸ªå‡½æ•°çš„åå­—ï¼Œä»¥ä¾¿æ´¾ç”Ÿç±»æ ¹æ®éœ€è¦å¯¹å®ƒè¿›è¡Œå®šä¹‰ã€‚ä½œä¸ºæ¥å£è€Œå­˜åœ¨ çº¯è™šå‡½æ•°ä¸å…·å¤‡å‡½æ•°çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ä¸èƒ½ç›´æ¥è¢«è°ƒç”¨ã€‚ ä»åŸºç±»ç»§æ‰¿æ¥çš„çº¯è™šå‡½æ•°ï¼Œåœ¨æ´¾ç”Ÿç±»ä¸­ä»æ˜¯è™šå‡½æ•°ã€‚å¦‚æœä¸€ä¸ªç±»ä¸­è‡³å°‘æœ‰ä¸€ä¸ªçº¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»è¢«ç§°ä¸ºæŠ½è±¡ç±»ï¼ˆabstract classï¼‰ã€‚ æŠ½è±¡ç±»ä¸­ä¸ä»…åŒ…æ‹¬çº¯è™šå‡½æ•°ï¼Œä¹Ÿå¯åŒ…æ‹¬è™šå‡½æ•°ã€‚æŠ½è±¡ç±»å¿…é¡»ç”¨ä½œæ´¾ç”Ÿå…¶ä»–ç±»çš„åŸºç±»ï¼Œè€Œä¸èƒ½ç”¨äºç›´æ¥åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚ä½†ä»å¯ä½¿ç”¨æŒ‡å‘æŠ½è±¡ç±»çš„æŒ‡é’ˆæ”¯æŒè¿è¡Œæ—¶å¤šæ€æ€§ã€‚ 5.ä»€ä¹ˆæ˜¯â€œå¼•ç”¨â€ï¼Ÿç”³æ˜å’Œä½¿ç”¨â€œå¼•ç”¨â€è¦æ³¨æ„å“ªäº›é—®é¢˜ï¼Ÿç­”ï¼šå¼•ç”¨å°±æ˜¯æŸä¸ªç›®æ ‡å˜é‡çš„â€œåˆ«åâ€(alias)ï¼Œå¯¹åº”ç”¨çš„æ“ä½œä¸å¯¹å˜é‡ç›´æ¥æ“ä½œæ•ˆæœå®Œå…¨ç›¸åŒã€‚ç”³æ˜ä¸€ä¸ªå¼•ç”¨çš„æ—¶å€™ï¼Œåˆ‡è®°è¦å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚å¼•ç”¨å£°æ˜å®Œæ¯•åï¼Œç›¸å½“äºç›®æ ‡å˜é‡åæœ‰ä¸¤ä¸ªåç§°ï¼Œå³è¯¥ç›®æ ‡åŸåç§°å’Œå¼•ç”¨åï¼Œä¸èƒ½å†æŠŠè¯¥å¼•ç”¨åä½œä¸ºå…¶ä»–å˜é‡åçš„åˆ«åã€‚å£°æ˜ä¸€ä¸ªå¼•ç”¨ï¼Œä¸æ˜¯æ–°å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼Œå®ƒåªè¡¨ç¤ºè¯¥å¼•ç”¨åæ˜¯ç›®æ ‡å˜é‡åçš„ä¸€ä¸ªåˆ«åï¼Œå®ƒæœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå› æ­¤å¼•ç”¨æœ¬èº«ä¸å å­˜å‚¨å•å…ƒï¼Œç³»ç»Ÿä¹Ÿä¸ç»™å¼•ç”¨åˆ†é…å­˜å‚¨å•å…ƒã€‚ä¸èƒ½å»ºç«‹æ•°ç»„çš„å¼•ç”¨ã€‚ 6.å°†â€œå¼•ç”¨â€ä½œä¸ºå‡½æ•°å‚æ•°æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿï¼ˆ1ï¼‰ä¼ é€’å¼•ç”¨ç»™å‡½æ•°ä¸ä¼ é€’æŒ‡é’ˆçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚è¿™æ—¶ï¼Œè¢«è°ƒå‡½æ•°çš„å½¢å‚å°±æˆä¸ºåŸæ¥ä¸»è°ƒå‡½æ•°ä¸­çš„å®å‚å˜é‡æˆ–å¯¹è±¡çš„ä¸€ä¸ªåˆ«åæ¥ä½¿ç”¨ï¼Œæ‰€ä»¥åœ¨è¢«è°ƒå‡½æ•°ä¸­å¯¹å½¢å‚å˜é‡çš„æ“ä½œå°±æ˜¯å¯¹å…¶ç›¸åº”çš„ç›®æ ‡å¯¹è±¡ï¼ˆåœ¨ä¸»è°ƒå‡½æ•°ä¸­ï¼‰çš„æ“ä½œã€‚ ï¼ˆ2ï¼‰ä½¿ç”¨å¼•ç”¨ä¼ é€’å‡½æ•°çš„å‚æ•°ï¼Œåœ¨å†…å­˜ä¸­å¹¶æ²¡æœ‰äº§ç”Ÿå®å‚çš„å‰¯æœ¬ï¼Œå®ƒæ˜¯ç›´æ¥å¯¹å®å‚æ“ä½œï¼›è€Œä½¿ç”¨ä¸€èˆ¬å˜é‡ä¼ é€’å‡½æ•°çš„å‚æ•°ï¼Œå½“å‘ç”Ÿå‡½æ•°è°ƒç”¨æ—¶ï¼Œéœ€è¦ç»™å½¢å‚åˆ†é…å­˜å‚¨å•å…ƒï¼Œå½¢å‚å˜é‡æ˜¯å®å‚å˜é‡çš„å‰¯æœ¬ï¼›å¦‚æœä¼ é€’çš„æ˜¯å¯¹è±¡ï¼Œè¿˜å°†è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚å› æ­¤ï¼Œå½“å‚æ•°ä¼ é€’çš„æ•°æ®è¾ƒå¤§æ—¶ï¼Œç”¨å¼•ç”¨æ¯”ç”¨ä¸€èˆ¬å˜é‡ä¼ é€’å‚æ•°çš„æ•ˆç‡å’Œæ‰€å ç©ºé—´éƒ½å¥½ã€‚ ï¼ˆ3ï¼‰ä½¿ç”¨æŒ‡é’ˆä½œä¸ºå‡½æ•°çš„å‚æ•°è™½ç„¶ä¹Ÿèƒ½è¾¾åˆ°ä¸ä½¿ç”¨å¼•ç”¨çš„æ•ˆæœï¼Œä½†æ˜¯ï¼Œåœ¨è¢«è°ƒå‡½æ•°ä¸­åŒæ ·è¦ç»™å½¢å‚åˆ†é…å­˜å‚¨å•å…ƒï¼Œä¸”éœ€è¦é‡å¤ä½¿ç”¨â€*æŒ‡é’ˆå˜é‡åâ€çš„å½¢å¼è¿›è¡Œè¿ç®—ï¼Œè¿™å¾ˆå®¹æ˜“äº§ç”Ÿé”™è¯¯ä¸”ç¨‹åºçš„é˜…è¯»æ€§è¾ƒå·®ï¼›å¦ä¸€æ–¹é¢ï¼Œåœ¨ä¸»è°ƒå‡½æ•°çš„è°ƒç”¨ç‚¹å¤„ï¼Œå¿…é¡»ç”¨å˜é‡çš„åœ°å€ä½œä¸ºå®å‚ã€‚è€Œå¼•ç”¨æ›´å®¹æ˜“ä½¿ç”¨ï¼Œæ›´æ¸…æ™°ã€‚ 7.dynamic_castå’Œstatic_castçš„åŒºåˆ«static_castç›¸å½“äºä¼ ç»Ÿçš„Cè¯­è¨€é‡Œçš„å¼ºåˆ¶è½¬æ¢ï¼Œè¯¥è¿ç®—ç¬¦æŠŠexpressionè½¬æ¢ä¸ºnew_typeç±»å‹ï¼Œç”¨æ¥å¼ºè¿«éšå¼è½¬æ¢å¦‚non-constå¯¹è±¡è½¬ä¸ºconstå¯¹è±¡ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œç”¨äºéå¤šæ€çš„è½¬æ¢ï¼Œå¯ä»¥è½¬æ¢æŒ‡é’ˆåŠå…¶ä»–ï¼Œä½†æ²¡æœ‰è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥æ¥ä¿è¯è½¬æ¢çš„å®‰å…¨æ€§ã€‚å®ƒä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§ç”¨æ³•ï¼š 1 ç”¨äºç±»å±‚æ¬¡ç»“æ„ä¸­åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰å’Œæ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰ä¹‹é—´æŒ‡é’ˆæˆ–å¼•ç”¨çš„è½¬æ¢ã€‚è¿›è¡Œä¸Šè¡Œè½¬æ¢ï¼ˆæŠŠæ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆåŸºç±»è¡¨ç¤ºï¼‰æ˜¯å®‰å…¨çš„ï¼›è¿›è¡Œä¸‹è¡Œè½¬æ¢ï¼ˆæŠŠåŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆæ´¾ç”Ÿç±»è¡¨ç¤ºï¼‰æ—¶ï¼Œç”±äºæ²¡æœ‰åŠ¨æ€ç±»å‹æ£€æŸ¥ï¼Œæ‰€ä»¥æ˜¯ä¸å®‰å…¨çš„ã€‚ 2 ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼Œå¦‚æŠŠintè½¬æ¢æˆcharï¼ŒæŠŠintè½¬æ¢æˆenumã€‚ 3 æŠŠç©ºæŒ‡é’ˆè½¬æ¢æˆç›®æ ‡ç±»å‹çš„ç©ºæŒ‡é’ˆã€‚ 4 æŠŠä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼è½¬æ¢æˆvoidç±»å‹ã€‚ æ³¨æ„ï¼šstatic_castä¸èƒ½è½¬æ¢æ‰expressionçš„constã€volatileã€æˆ–è€…__unalignedå±æ€§ 12345678910111213141516171819202122232425262728åŸºæœ¬ç±»å‹æ•°æ®è½¬æ¢ä¸¾ä¾‹å¦‚ä¸‹ï¼šchar a = &#x27;a&#x27;;int b = static_cast&lt;char&gt;(a);//æ­£ç¡®ï¼Œå°†charå‹æ•°æ®è½¬æ¢æˆintå‹æ•°æ®double *c = new double;void *d = static_cast&lt;void*&gt;(c);//æ­£ç¡®ï¼Œå°†doubleæŒ‡é’ˆè½¬æ¢æˆvoidæŒ‡é’ˆint e = 10;const int f = static_cast&lt;const int&gt;(e);//æ­£ç¡®ï¼Œå°†intå‹æ•°æ®è½¬æ¢æˆconst intå‹æ•°æ®const int g = 20;int *h = static_cast&lt;int*&gt;(&amp;g);//ç¼–è¯‘é”™è¯¯ï¼Œstatic_castä¸èƒ½è½¬æ¢æ‰gçš„constå±æ€§ç±»ä¸Šè¡Œå’Œä¸‹è¡Œè½¬æ¢ï¼šclass Base&#123;&#125;;class Derived : public Base&#123;&#125;Base* pB = new Base();if(Derived* pD = static_cast&lt;Derived*&gt;(pB))&#123;&#125;//ä¸‹è¡Œè½¬æ¢æ˜¯ä¸å®‰å…¨çš„(åšå†³æŠµåˆ¶è¿™ç§æ–¹æ³•)Derived* pD = new Derived();if(Base* pB = static_cast&lt;Base*&gt;(pD))&#123;&#125;//ä¸Šè¡Œè½¬æ¢æ˜¯å®‰å…¨çš„ dynamic_castä¸»è¦ç”¨äºç±»å±‚æ¬¡é—´çš„ä¸Šè¡Œè½¬æ¢å’Œä¸‹è¡Œè½¬æ¢ï¼Œè¿˜å¯ä»¥ç”¨äºç±»ä¹‹é—´çš„äº¤å‰è½¬æ¢ï¼ˆcross castï¼‰ã€‚ åœ¨ç±»å±‚æ¬¡é—´è¿›è¡Œä¸Šè¡Œè½¬æ¢æ—¶ï¼Œdynamic_castå’Œstatic_castçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼›åœ¨è¿›è¡Œä¸‹è¡Œè½¬æ¢æ—¶ï¼Œdynamic_castå…·æœ‰ç±»å‹æ£€æŸ¥çš„åŠŸèƒ½ï¼Œæ¯”static_castæ›´å®‰å…¨ã€‚dynamic_castæ˜¯å”¯ä¸€æ— æ³•ç”±æ—§å¼è¯­æ³•æ‰§è¡Œçš„åŠ¨ä½œï¼Œä¹Ÿæ˜¯å”¯ä¸€å¯èƒ½è€—è´¹é‡å¤§è¿è¡Œæˆæœ¬çš„è½¬å‹åŠ¨ä½œã€‚å°½é‡å°‘ä½¿ç”¨è½¬å‹æ“ä½œï¼Œå°¤å…¶æ˜¯dynamic_castï¼Œè€—æ—¶è¾ƒé«˜ï¼Œä¼šå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ï¼Œå°½é‡ä½¿ç”¨å…¶ä»–æ–¹æ³•æ›¿ä»£ã€‚ 8.å°†â€œå¼•ç”¨â€ä½œä¸ºå‡½æ•°è¿”å›å€¼ç±»å‹çš„æ ¼å¼ã€å¥½å¤„å’Œéœ€è¦éµå®ˆçš„è§„åˆ™?æ ¼å¼ï¼šç±»å‹æ ‡è¯†ç¬¦ &amp;å‡½æ•°åï¼ˆå½¢å‚åˆ—è¡¨åŠç±»å‹è¯´æ˜ï¼‰{ //å‡½æ•°ä½“ } å¥½å¤„ï¼šåœ¨å†…å­˜ä¸­ä¸äº§ç”Ÿè¢«è¿”å›å€¼çš„å‰¯æœ¬ï¼›ï¼ˆæ³¨æ„ï¼šæ­£æ˜¯å› ä¸ºè¿™ç‚¹åŸå› ï¼Œæ‰€ä»¥è¿”å›ä¸€ä¸ªå±€éƒ¨å˜é‡çš„å¼•ç”¨æ˜¯ä¸å¯å–çš„ã€‚å› ä¸ºéšç€è¯¥å±€éƒ¨å˜é‡ç”Ÿå­˜æœŸçš„ç»“æŸï¼Œç›¸åº”çš„å¼•ç”¨ä¹Ÿä¼šå¤±æ•ˆï¼Œäº§ç”Ÿruntime error! æ³¨æ„äº‹é¡¹ï¼š ï¼ˆ1ï¼‰ä¸èƒ½è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ã€‚è¿™æ¡å¯ä»¥å‚ç…§Effective C++[1]çš„Item 31ã€‚ä¸»è¦åŸå› æ˜¯å±€éƒ¨å˜é‡ä¼šåœ¨å‡½æ•°è¿”å›åè¢«é”€æ¯ï¼Œå› æ­¤è¢«è¿”å›çš„å¼•ç”¨å°±æˆä¸ºäº†â€æ— æ‰€æŒ‡â€çš„å¼•ç”¨ï¼Œç¨‹åºä¼šè¿›å…¥æœªçŸ¥çŠ¶æ€ã€‚ ï¼ˆ2ï¼‰ä¸èƒ½è¿”å›å‡½æ•°å†…éƒ¨newåˆ†é…çš„å†…å­˜çš„å¼•ç”¨ã€‚è¿™æ¡å¯ä»¥å‚ç…§Effective C++[1]çš„Item 31ã€‚è™½ç„¶ä¸å­˜åœ¨å±€éƒ¨å˜é‡çš„è¢«åŠ¨é”€æ¯é—®é¢˜ï¼Œå¯å¯¹äºè¿™ç§æƒ…å†µï¼ˆè¿”å›å‡½æ•°å†…éƒ¨newåˆ†é…å†…å­˜çš„å¼•ç”¨ï¼‰ï¼Œåˆé¢ä¸´å…¶å®ƒå°´å°¬å±€é¢ã€‚ä¾‹å¦‚ï¼Œè¢«å‡½æ•°è¿”å›çš„å¼•ç”¨åªæ˜¯ä½œä¸ºä¸€ä¸ªä¸´æ—¶å˜é‡å‡ºç°ï¼Œè€Œæ²¡æœ‰è¢«èµ‹äºˆä¸€ä¸ªå®é™…çš„å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼•ç”¨æ‰€æŒ‡å‘çš„ç©ºé—´ï¼ˆç”±newåˆ†é…ï¼‰å°±æ— æ³•é‡Šæ”¾ï¼Œé€ æˆmemory leakã€‚ ï¼ˆ3ï¼‰å¯ä»¥è¿”å›ç±»æˆå‘˜çš„å¼•ç”¨ï¼Œä½†æœ€å¥½æ˜¯constã€‚è¿™æ¡åŸåˆ™å¯ä»¥å‚ç…§Effective C++[1]çš„Item 30ã€‚ä¸»è¦åŸå› æ˜¯å½“å¯¹è±¡çš„å±æ€§æ˜¯ä¸æŸç§ä¸šåŠ¡è§„åˆ™ï¼ˆbusiness ruleï¼‰ç›¸å…³è”çš„æ—¶å€™ï¼Œå…¶èµ‹å€¼å¸¸å¸¸ä¸æŸäº›å…¶å®ƒå±æ€§æˆ–è€…å¯¹è±¡çš„çŠ¶æ€æœ‰å…³ï¼Œå› æ­¤æœ‰å¿…è¦å°†èµ‹å€¼æ“ä½œå°è£…åœ¨ä¸€ä¸ªä¸šåŠ¡è§„åˆ™å½“ä¸­ã€‚å¦‚æœå…¶å®ƒå¯¹è±¡å¯ä»¥è·å¾—è¯¥å±æ€§çš„éå¸¸é‡å¼•ç”¨ï¼ˆæˆ–æŒ‡é’ˆï¼‰ï¼Œé‚£ä¹ˆå¯¹è¯¥å±æ€§çš„å•çº¯èµ‹å€¼å°±ä¼šç ´åä¸šåŠ¡è§„åˆ™çš„å®Œæ•´æ€§ã€‚ ï¼ˆ4ï¼‰æµæ“ä½œç¬¦é‡è½½è¿”å›å€¼ç”³æ˜ä¸ºâ€œå¼•ç”¨â€çš„ä½œç”¨ï¼š æµæ“ä½œç¬¦&lt;&lt;å’Œ&gt;&gt;ï¼Œè¿™ä¸¤ä¸ªæ“ä½œç¬¦å¸¸å¸¸å¸Œæœ›è¢«è¿ç»­ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šcout &lt;&lt; â€œhelloâ€ &lt;&lt; endl; å› æ­¤è¿™ä¸¤ä¸ªæ“ä½œç¬¦çš„è¿”å›å€¼åº”è¯¥æ˜¯ä¸€ä¸ªä»ç„¶æ”¯æŒè¿™ä¸¤ä¸ªæ“ä½œç¬¦çš„æµå¼•ç”¨ã€‚å¯é€‰çš„å…¶å®ƒæ–¹æ¡ˆåŒ…æ‹¬ï¼šè¿”å›ä¸€ä¸ªæµå¯¹è±¡å’Œè¿”å›ä¸€ä¸ªæµå¯¹è±¡æŒ‡é’ˆã€‚ä½†æ˜¯å¯¹äºè¿”å›ä¸€ä¸ªæµå¯¹è±¡ï¼Œç¨‹åºå¿…é¡»é‡æ–°ï¼ˆæ‹·è´ï¼‰æ„é€ ä¸€ä¸ªæ–°çš„æµå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿ç»­çš„ä¸¤ä¸ª&lt;&lt;æ“ä½œç¬¦å®é™…ä¸Šæ˜¯é’ˆå¯¹ä¸åŒå¯¹è±¡çš„ï¼è¿™æ— æ³•è®©äººæ¥å—ã€‚å¯¹äºè¿”å›ä¸€ä¸ªæµæŒ‡é’ˆåˆ™ä¸èƒ½è¿ç»­ä½¿ç”¨&lt;&lt;æ“ä½œç¬¦ã€‚å› æ­¤ï¼Œè¿”å›ä¸€ä¸ªæµå¯¹è±¡å¼•ç”¨æ˜¯æƒŸä¸€é€‰æ‹©ã€‚è¿™ä¸ªå”¯ä¸€é€‰æ‹©å¾ˆå…³é”®ï¼Œå®ƒè¯´æ˜äº†å¼•ç”¨çš„é‡è¦æ€§ä»¥åŠæ— å¯æ›¿ä»£æ€§ï¼Œä¹Ÿè®¸è¿™å°±æ˜¯C++è¯­è¨€ä¸­å¼•å…¥å¼•ç”¨è¿™ä¸ªæ¦‚å¿µçš„åŸå› å§ã€‚ èµ‹å€¼æ“ä½œç¬¦=ã€‚è¿™ä¸ªæ“ä½œç¬¦è±¡æµæ“ä½œç¬¦ä¸€æ ·ï¼Œæ˜¯å¯ä»¥è¿ç»­ä½¿ç”¨çš„ï¼Œä¾‹å¦‚ï¼šx = j = 10;æˆ–è€…(x=10)=100;èµ‹å€¼æ“ä½œç¬¦çš„è¿”å›å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œä»¥ä¾¿å¯ä»¥è¢«ç»§ç»­èµ‹å€¼ã€‚å› æ­¤å¼•ç”¨æˆäº†è¿™ä¸ªæ“ä½œç¬¦çš„æƒŸä¸€è¿”å›å€¼é€‰æ‹©ã€‚ 12345678910111213141516171819202122232425262728293031ï¼ƒinclude&lt;iostream.h&gt;int &amp;put(int n);int vals[10];int error=-1;void main()&#123;put(0)=10; //ä»¥put(0)å‡½æ•°å€¼ä½œä¸ºå·¦å€¼ï¼Œç­‰ä»·äºvals[0]=10; put(9)=20; //ä»¥put(9)å‡½æ•°å€¼ä½œä¸ºå·¦å€¼ï¼Œç­‰ä»·äºvals[9]=20; cout&lt;&lt;vals[0]; cout&lt;&lt;vals[9];&#125; int &amp;put(int n)&#123;if (n&gt;=0 &amp;&amp; n&lt;=9 ) return vals[n]; else &#123; cout&lt;&lt;&quot;subscript error&quot;; return error; &#125;&#125; ï¼ˆ5ï¼‰åœ¨å¦å¤–çš„ä¸€äº›æ“ä½œç¬¦ä¸­ï¼Œå´åƒä¸‡ä¸èƒ½è¿”å›å¼•ç”¨ï¼š+-*/ å››åˆ™è¿ç®—ç¬¦ã€‚å®ƒä»¬ä¸èƒ½è¿”å›å¼•ç”¨ï¼ŒEffective C++[1]çš„Item23è¯¦ç»†çš„è®¨è®ºäº†è¿™ä¸ªé—®é¢˜ã€‚ä¸»è¦åŸå› æ˜¯è¿™å››ä¸ªæ“ä½œç¬¦æ²¡æœ‰side effectï¼Œå› æ­¤ï¼Œå®ƒä»¬å¿…é¡»æ„é€ ä¸€ä¸ªå¯¹è±¡ä½œä¸ºè¿”å›å€¼ï¼Œå¯é€‰çš„æ–¹æ¡ˆåŒ…æ‹¬ï¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ã€è¿”å›ä¸€ä¸ªå±€éƒ¨å˜é‡çš„å¼•ç”¨ï¼Œè¿”å›ä¸€ä¸ªnewåˆ†é…çš„å¯¹è±¡çš„å¼•ç”¨ã€è¿”å›ä¸€ä¸ªé™æ€å¯¹è±¡å¼•ç”¨ã€‚æ ¹æ®å‰é¢æåˆ°çš„å¼•ç”¨ä½œä¸ºè¿”å›å€¼çš„ä¸‰ä¸ªè§„åˆ™ï¼Œç¬¬2ã€3ä¸¤ä¸ªæ–¹æ¡ˆéƒ½è¢«å¦å†³äº†ã€‚é™æ€å¯¹è±¡çš„å¼•ç”¨åˆå› ä¸º((a+b) == (c+d))ä¼šæ°¸è¿œä¸ºtrueè€Œå¯¼è‡´é”™è¯¯ã€‚æ‰€ä»¥å¯é€‰çš„åªå‰©ä¸‹è¿”å›ä¸€ä¸ªå¯¹è±¡äº†ã€‚ 9ã€ç»“æ„ä¸è”åˆæœ‰å’ŒåŒºåˆ«ï¼Ÿ(1). ç»“æ„å’Œè”åˆéƒ½æ˜¯ç”±å¤šä¸ªä¸åŒçš„æ•°æ®ç±»å‹æˆå‘˜ç»„æˆ, ä½†åœ¨ä»»ä½•åŒä¸€æ—¶åˆ», è”åˆä¸­åªå­˜æ”¾äº†ä¸€ä¸ªè¢«é€‰ä¸­çš„æˆå‘˜ï¼ˆæ‰€æœ‰æˆå‘˜å…±ç”¨ä¸€å—åœ°å€ç©ºé—´ï¼‰, è€Œç»“æ„çš„æ‰€æœ‰æˆå‘˜éƒ½å­˜åœ¨ï¼ˆä¸åŒæˆå‘˜çš„å­˜æ”¾åœ°å€ä¸åŒï¼‰ã€‚ (2). å¯¹äºè”åˆçš„ä¸åŒæˆå‘˜èµ‹å€¼, å°†ä¼šå¯¹å…¶å®ƒæˆå‘˜é‡å†™, åŸæ¥æˆå‘˜çš„å€¼å°±ä¸å­˜åœ¨äº†, è€Œå¯¹äºç»“æ„çš„ä¸åŒæˆå‘˜èµ‹å€¼æ˜¯äº’ä¸å½±å“çš„ã€‚ 10.é‡è½½ï¼ˆoverload)å’Œé‡å†™(overriedï¼Œæœ‰çš„ä¹¦ä¹Ÿå«åšâ€œè¦†ç›–â€ï¼‰çš„åŒºåˆ«ï¼Ÿå¸¸è€ƒçš„é¢˜ç›®ã€‚ä»å®šä¹‰ä¸Šæ¥è¯´ï¼š é‡è½½ï¼šæ˜¯æŒ‡å…è®¸å­˜åœ¨å¤šä¸ªåŒåå‡½æ•°ï¼Œè€Œè¿™äº›å‡½æ•°çš„å‚æ•°è¡¨ä¸åŒï¼ˆæˆ–è®¸å‚æ•°ä¸ªæ•°ä¸åŒï¼Œæˆ–è®¸å‚æ•°ç±»å‹ä¸åŒï¼Œæˆ–è®¸ä¸¤è€…éƒ½ä¸åŒï¼‰ã€‚ é‡å†™ï¼šæ˜¯æŒ‡å­ç±»é‡æ–°å®šä¹‰çˆ¶ç±»è™šå‡½æ•°çš„æ–¹æ³•ã€‚ ä»å®ç°åŸç†ä¸Šæ¥è¯´ï¼š é‡è½½ï¼šç¼–è¯‘å™¨æ ¹æ®å‡½æ•°ä¸åŒçš„å‚æ•°è¡¨ï¼Œå¯¹åŒåå‡½æ•°çš„åç§°åšä¿®é¥°ï¼Œç„¶åè¿™äº›åŒåå‡½æ•°å°±æˆäº†ä¸åŒçš„å‡½æ•°ï¼ˆè‡³å°‘å¯¹äºç¼–è¯‘å™¨æ¥è¯´æ˜¯è¿™æ ·çš„ï¼‰ã€‚å¦‚ï¼Œæœ‰ä¸¤ä¸ªåŒåå‡½æ•°ï¼šfunction func(p:integer):integer;å’Œfunction func(p:string):integer;ã€‚é‚£ä¹ˆç¼–è¯‘å™¨åšè¿‡ä¿®é¥°åçš„å‡½æ•°åç§°å¯èƒ½æ˜¯è¿™æ ·çš„ï¼šint_funcã€str_funcã€‚å¯¹äºè¿™ä¸¤ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œåœ¨ç¼–è¯‘å™¨é—´å°±å·²ç»ç¡®å®šäº†ï¼Œæ˜¯é™æ€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬çš„åœ°å€åœ¨ç¼–è¯‘æœŸå°±ç»‘å®šäº†ï¼ˆæ—©ç»‘å®šï¼‰ï¼Œå› æ­¤ï¼Œé‡è½½å’Œå¤šæ€æ— å…³ï¼ é‡å†™ï¼šå’Œå¤šæ€çœŸæ­£ç›¸å…³ã€‚å½“å­ç±»é‡æ–°å®šä¹‰äº†çˆ¶ç±»çš„è™šå‡½æ•°åï¼Œçˆ¶ç±»æŒ‡é’ˆæ ¹æ®èµ‹ç»™å®ƒçš„ä¸åŒçš„å­ç±»æŒ‡é’ˆï¼ŒåŠ¨æ€çš„è°ƒç”¨å±äºå­ç±»çš„è¯¥å‡½æ•°ï¼Œè¿™æ ·çš„å‡½æ•°è°ƒç”¨åœ¨ç¼–è¯‘æœŸé—´æ˜¯æ— æ³•ç¡®å®šçš„ï¼ˆè°ƒç”¨çš„å­ç±»çš„è™šå‡½æ•°çš„åœ°å€æ— æ³•ç»™å‡ºï¼‰ã€‚å› æ­¤ï¼Œè¿™æ ·çš„å‡½æ•°åœ°å€æ˜¯åœ¨è¿è¡ŒæœŸç»‘å®šçš„ï¼ˆæ™šç»‘å®šï¼‰ã€‚","categories":[{"name":"c++é¢è¯•","slug":"c-é¢è¯•","permalink":"https://marblemm.github.io/categories/c-%E9%9D%A2%E8%AF%95/"}],"tags":[]},{"title":"gitå‘½ä»¤æ•´ç†-å¯¼å›¾","slug":"gitå‘½ä»¤æ•´ç†-å¯¼å›¾","date":"2021-08-09T15:28:16.000Z","updated":"2021-08-09T15:30:36.829Z","comments":true,"path":"2021/08/09/gitå‘½ä»¤æ•´ç†-å¯¼å›¾/","link":"","permalink":"https://marblemm.github.io/2021/08/09/git%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86-%E5%AF%BC%E5%9B%BE/","excerpt":"","text":"gitå‘½ä»¤æ•´ç†-å¯¼å›¾","categories":[{"name":"git","slug":"git","permalink":"https://marblemm.github.io/categories/git/"}],"tags":[]},{"title":"gitå‘½ä»¤æ•´ç†-åˆ†æ”¯","slug":"gitå‘½ä»¤æ•´ç†-åˆ†æ”¯","date":"2021-08-09T15:21:59.000Z","updated":"2021-08-09T15:30:42.034Z","comments":true,"path":"2021/08/09/gitå‘½ä»¤æ•´ç†-åˆ†æ”¯/","link":"","permalink":"https://marblemm.github.io/2021/08/09/git%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86-%E5%88%86%E6%94%AF/","excerpt":"","text":"gitåˆ†æ”¯å‘½ä»¤git branch git branchå¯ä»¥ç”¨æ¥åˆ—å‡ºåˆ†æ”¯,åˆ›å»ºåˆ†æ”¯å’Œåˆ é™¤åˆ†æ”¯. git branch -vå¯ä»¥çœ‹è§æ¯ä¸€ä¸ªåˆ†æ”¯çš„æœ€åä¸€æ¬¡æäº¤. git branch: åˆ—å‡ºæœ¬åœ°æ‰€æœ‰åˆ†æ”¯,å½“å‰åˆ†æ”¯ä¼šè¢«æ˜Ÿå·æ ‡ç¤ºå‡º. git branch -a åŠ ä¸Š-aå‚æ•°åˆ—å‡ºæœ¬åœ°å’Œè¿œç¨‹æ‰€æœ‰åˆ†æ”¯ï¼Œè¿œç¨‹åˆ†æ”¯ä¼šç”¨çº¢è‰²è¡¨ç¤ºå‡ºæ¥ï¼ˆå¦‚æœä½ å¼€äº†é¢œè‰²æ”¯æŒçš„è¯ï¼‰ git branch -av git branch (branchname): åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯(å½“ä½ ç”¨è¿™ç§æ–¹å¼åˆ›å»ºåˆ†æ”¯çš„æ—¶å€™,åˆ†æ”¯æ˜¯åŸºäºä½ çš„ä¸Šä¸€æ¬¡æäº¤å»ºç«‹çš„). git branch -d (branchname): åˆ é™¤ä¸€ä¸ªåˆ†æ”¯.ï¼ˆå·²åˆå¹¶ï¼‰ git branch -D (branchname): åˆ é™¤ä¸€ä¸ªåˆ†æ”¯.ï¼ˆæœªåˆå¹¶ï¼‰ git push --delete origin [branch] åˆ é™¤è¿œç¨‹åˆ†æ”¯ git branch -m devel develop é‡å‘½åæœ¬åœ°åˆ†æ”¯ git checkout git checkout (branchname) åˆ‡æ¢åˆ°ä¸€ä¸ªåˆ†æ”¯. git checkout -b (branchname): åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯. è¿™ä¸ªå‘½ä»¤æ˜¯å°†git branch newbranchå’Œgit checkout newbranchåˆåœ¨ä¸€èµ·çš„ç»“æœ. checkoutè¿˜æœ‰å¦ä¸€ä¸ªä½œç”¨:æ›¿æ¢æœ¬åœ°æ”¹åŠ¨: git checkout --&lt;filename&gt; æ­¤å‘½ä»¤ä¼šä½¿ç”¨HEADä¸­çš„æœ€æ–°å†…å®¹æ›¿æ¢æ‰ä½ çš„å·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶.å·²æ·»åŠ åˆ°æš‚å­˜åŒºçš„æ”¹åŠ¨ä»¥åŠæ–°æ–‡ä»¶éƒ½ä¸ä¼šå—åˆ°å½±å“. æ³¨æ„:git checkout filenameä¼šåˆ é™¤è¯¥æ–‡ä»¶ä¸­æ‰€æœ‰æ²¡æœ‰æš‚å­˜å’Œæäº¤çš„æ”¹åŠ¨,è¿™ä¸ªæ“ä½œæ˜¯ä¸å¯é€†çš„. git merge æŠŠä¸€ä¸ªåˆ†æ”¯mergeè¿›å½“å‰çš„åˆ†æ”¯. git merge [alias]/[branch] æŠŠè¿œç¨‹åˆ†æ”¯mergeåˆ°å½“å‰åˆ†æ”¯. å¦‚æœå‡ºç°å†²çª,éœ€è¦æ‰‹åŠ¨ä¿®æ”¹,å¯ä»¥ç”¨git mergetool. è§£å†³å†²çªçš„æ—¶å€™å¯ä»¥ç”¨åˆ°git diff,è§£å†³å®Œä¹‹åç”¨git addæ·»åŠ ,å³è¡¨ç¤ºå†²çªå·²ç»è¢«resolved. git tag tag a point in history as import. ä¼šåœ¨ä¸€ä¸ªæäº¤ä¸Šå»ºç«‹æ°¸ä¹…æ€§çš„ä¹¦ç­¾,é€šå¸¸æ˜¯å‘å¸ƒä¸€ä¸ªreleaseç‰ˆæœ¬æˆ–è€…shipäº†ä»€ä¹ˆä¸œè¥¿ä¹‹ååŠ tag. æ¯”å¦‚: git tag v1.0 git tag -a v1.0, -aå‚æ•°ä¼šå…è®¸ä½ æ·»åŠ ä¸€äº›ä¿¡æ¯,å³make an annotated tag. å½“ä½ è¿è¡Œgit tag -aå‘½ä»¤çš„æ—¶å€™,Gitä¼šæ‰“å¼€ä¸€ä¸ªç¼–è¾‘å™¨è®©ä½ è¾“å…¥tagä¿¡æ¯. æˆ‘ä»¬å¯ä»¥åˆ©ç”¨commit SHAæ¥ç»™ä¸€ä¸ªè¿‡å»çš„æäº¤æ‰“tag: git tag -a v0.9 XXXX pushçš„æ—¶å€™æ˜¯ä¸åŒ…å«tagçš„,å¦‚æœæƒ³åŒ…å«,å¯ä»¥åœ¨pushæ—¶åŠ ä¸Š--tagså‚æ•°. fetchçš„æ—¶å€™,branch HEADå¯ä»¥reachçš„tagsæ˜¯è‡ªåŠ¨è¢«fetchä¸‹æ¥çš„, tags that arenâ€™t reachable from branch heads will be skipped.å¦‚æœæƒ³ç¡®ä¿æ‰€æœ‰çš„tagséƒ½è¢«åŒ…å«è¿›æ¥,éœ€è¦åŠ ä¸Š--tagsé€‰é¡¹. git remote list, add and delete remote repository aliases. å› ä¸ºä¸éœ€è¦æ¯æ¬¡éƒ½ç”¨å®Œæ•´çš„url,æ‰€ä»¥Gitä¸ºæ¯ä¸€ä¸ªremote repoçš„urléƒ½å»ºç«‹ä¸€ä¸ªåˆ«å,ç„¶åç”¨git remoteæ¥ç®¡ç†è¿™ä¸ªlist. git remote: åˆ—å‡ºremote aliases. å¦‚æœä½ cloneä¸€ä¸ªproject,Gitä¼šè‡ªåŠ¨å°†åŸæ¥çš„urlæ·»åŠ è¿›æ¥,åˆ«åå°±å«åš:origin. git remote -v:å¯ä»¥çœ‹è§æ¯ä¸€ä¸ªåˆ«åå¯¹åº”çš„å®é™…url. git remote add [alias] [url]: æ·»åŠ ä¸€ä¸ªæ–°çš„remote repo. git remote rm [alias]: åˆ é™¤ä¸€ä¸ªå­˜åœ¨çš„remote alias. git remote rename [old-alias] [new-alias]: é‡å‘½å. git remote set-url [alias] [url] é€šè¿‡å‘½ä»¤æ›´æ–°è¿œç¨‹url. å¯ä»¥åŠ ä¸Šâ€”pushå’Œfetchå‚æ•°,ä¸ºåŒä¸€ä¸ªåˆ«åsetä¸åŒçš„å­˜å–åœ°å€. ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€æ–¹æ³•ï¼š ä»¥ä¸‹å‡ä»¥é¡¹ç›®git_testä¸ºä¾‹ï¼š è€åœ°å€ï¼šhttp://192.168.1.12:9797/john/git_test.git æ–°åœ°å€ï¼šhttp://192.168.100.235:9797/john/git_test.git è¿œç¨‹ä»“åº“åç§°ï¼š origin æ–¹æ³•ä¸€ é€šè¿‡å‘½ä»¤ç›´æ¥ä¿®æ”¹è¿œç¨‹åœ°å€ è¿›å…¥git_testæ ¹ç›®å½•git remote æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“ï¼Œ git remote xxx æŸ¥çœ‹æŒ‡å®šè¿œç¨‹ä»“åº“åœ°å€ git remote set-url origin http://192.168.100.235:9797/john/git_test.git æ–¹æ³•äºŒ é€šè¿‡å‘½ä»¤å…ˆåˆ é™¤å†æ·»åŠ è¿œç¨‹ä»“åº“ è¿›å…¥git_testæ ¹ç›®å½• git remote æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“ï¼Œ git remote xxx æŸ¥çœ‹æŒ‡å®šè¿œç¨‹ä»“åº“åœ°å€ git remote rm origin git remote add origin http://192.168.100.235:9797/john/git_test.git æ–¹æ³•ä¸‰ ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶ è¿›å…¥git_test/.git ä¿®æ”¹ config ä¸­çš„ [remote â€œoriginâ€]ä¸‹é¢çš„urlå³å¯ git fetch download new branches and data from a remote repository. å¯ä»¥git fetch [alias]å–æŸä¸€ä¸ªè¿œç¨‹repo,ä¹Ÿå¯ä»¥git fetch --allå–åˆ°å…¨éƒ¨repo fetchå°†ä¼šå–åˆ°æ‰€æœ‰ä½ æœ¬åœ°æ²¡æœ‰çš„æ•°æ®,æ‰€æœ‰å–ä¸‹æ¥çš„åˆ†æ”¯å¯ä»¥è¢«å«åšremote branches,å®ƒä»¬å’Œæœ¬åœ°åˆ†æ”¯ä¸€æ ·(å¯ä»¥çœ‹diff,logç­‰,ä¹Ÿå¯ä»¥mergeåˆ°å…¶ä»–åˆ†æ”¯),ä½†æ˜¯Gitä¸å…è®¸ä½ checkoutåˆ°å®ƒä»¬. git pull fetch from a remote repo and try to merge into the current branch. pull == fetch + merge FETCH_HEAD git pullä¼šé¦–å…ˆæ‰§è¡Œgit fetch,ç„¶åæ‰§è¡Œgit merge,æŠŠå–æ¥çš„åˆ†æ”¯çš„head mergeåˆ°å½“å‰åˆ†æ”¯.è¿™ä¸ªmergeæ“ä½œä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„commit. å¦‚æœä½¿ç”¨--rebaseå‚æ•°,å®ƒä¼šæ‰§è¡Œgit rebaseæ¥å–ä»£åŸæ¥çš„git merge. git rebase --rebaseä¸ä¼šäº§ç”Ÿåˆå¹¶çš„æäº¤,å®ƒä¼šå°†æœ¬åœ°çš„æ‰€æœ‰æäº¤ä¸´æ—¶ä¿å­˜ä¸ºè¡¥ä¸(patch),æ”¾åœ¨â€.git/rebaseâ€ç›®å½•ä¸­,ç„¶åå°†å½“å‰åˆ†æ”¯æ›´æ–°åˆ°æœ€æ–°çš„åˆ†æ”¯å°–ç«¯,æœ€åæŠŠä¿å­˜çš„è¡¥ä¸åº”ç”¨åˆ°åˆ†æ”¯ä¸Š. rebaseçš„è¿‡ç¨‹ä¸­,ä¹Ÿè®¸ä¼šå‡ºç°å†²çª,Gitä¼šåœæ­¢rebaseå¹¶è®©ä½ è§£å†³å†²çª,åœ¨è§£å†³å®Œå†²çªä¹‹å,ç”¨git addå»æ›´æ–°è¿™äº›å†…å®¹,ç„¶åæ— éœ€æ‰§è¡Œcommit,åªéœ€è¦: git rebase --continueå°±ä¼šç»§ç»­æ‰“ä½™ä¸‹çš„è¡¥ä¸. git rebase --abortå°†ä¼šç»ˆæ­¢rebase,å½“å‰åˆ†æ”¯å°†ä¼šå›åˆ°rebaseä¹‹å‰çš„çŠ¶æ€. git push push your new branches and data to a remote repository. git push [alias] [branch] å°†ä¼šæŠŠå½“å‰åˆ†æ”¯mergeåˆ°aliasä¸Šçš„[branch]åˆ†æ”¯.å¦‚æœåˆ†æ”¯å·²ç»å­˜åœ¨,å°†ä¼šæ›´æ–°,å¦‚æœä¸å­˜åœ¨,å°†ä¼šæ·»åŠ è¿™ä¸ªåˆ†æ”¯. å¦‚æœæœ‰å¤šä¸ªäººå‘åŒä¸€ä¸ªremote repo pushä»£ç , Gitä¼šé¦–å…ˆåœ¨ä½ è¯•å›¾pushçš„åˆ†æ”¯ä¸Šè¿è¡Œgit log,æ£€æŸ¥å®ƒçš„å†å²ä¸­æ˜¯å¦èƒ½çœ‹åˆ°serverä¸Šçš„branchç°åœ¨çš„tip,å¦‚æœæœ¬åœ°å†å²ä¸­ä¸èƒ½çœ‹åˆ°serverçš„tip,è¯´æ˜æœ¬åœ°çš„ä»£ç ä¸æ˜¯æœ€æ–°çš„,Gitä¼šæ‹’ç»ä½ çš„push,è®©ä½ å…ˆfetch,merge,ä¹‹åå†push,è¿™æ ·å°±ä¿è¯äº†æ‰€æœ‰äººçš„æ”¹åŠ¨éƒ½ä¼šè¢«è€ƒè™‘è¿›æ¥. git push --delete origin develop åˆ é™¤è¿œç¨‹developåˆ†æ”¯ git reflog git reflogæ˜¯å¯¹reflogè¿›è¡Œç®¡ç†çš„å‘½ä»¤,reflogæ˜¯gitç”¨æ¥è®°å½•å¼•ç”¨å˜åŒ–çš„ä¸€ç§æœºåˆ¶,æ¯”å¦‚è®°å½•åˆ†æ”¯çš„å˜åŒ–æˆ–è€…æ˜¯HEADå¼•ç”¨çš„å˜åŒ–. å½“git reflogä¸æŒ‡å®šå¼•ç”¨çš„æ—¶å€™,é»˜è®¤åˆ—å‡ºHEADçš„reflog. HEAD@&#123;0&#125;ä»£è¡¨HEADå½“å‰çš„å€¼,HEAD@&#123;3&#125;ä»£è¡¨HEADåœ¨3æ¬¡å˜åŒ–ä¹‹å‰çš„å€¼. gitä¼šå°†å˜åŒ–è®°å½•åˆ°HEADå¯¹åº”çš„reflogæ–‡ä»¶ä¸­,å…¶è·¯å¾„ä¸º.git/logs/HEAD, åˆ†æ”¯çš„reflogæ–‡ä»¶éƒ½æ”¾åœ¨.git/logs/refsç›®å½•ä¸‹çš„å­ç›®å½•ä¸­.","categories":[{"name":"git","slug":"git","permalink":"https://marblemm.github.io/categories/git/"}],"tags":[]},{"title":"gitå‘½ä»¤æ•´ç†-æäº¤","slug":"gitå‘½ä»¤æ•´ç†-æäº¤","date":"2021-08-08T03:15:12.000Z","updated":"2021-08-09T15:30:32.139Z","comments":true,"path":"2021/08/08/gitå‘½ä»¤æ•´ç†-æäº¤/","link":"","permalink":"https://marblemm.github.io/2021/08/08/git%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86-%E6%8F%90%E4%BA%A4/","excerpt":"","text":"git å¸¸ç”¨å‘½ä»¤æ•´ç†git init åœ¨æœ¬åœ°æ–°å»ºä¸€ä¸ªrepo,è¿›å…¥ä¸€ä¸ªé¡¹ç›®ç›®å½•,æ‰§è¡Œgit init,ä¼šåˆå§‹åŒ–ä¸€ä¸ªrepo,å¹¶åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª.gitæ–‡ä»¶å¤¹. git clone è·å–ä¸€ä¸ªurlå¯¹åº”çš„è¿œç¨‹Git repo, åˆ›å»ºä¸€ä¸ªlocal copy. ä¸€èˆ¬çš„æ ¼å¼æ˜¯git clone [url]. cloneä¸‹æ¥çš„repoä¼šä»¥urlæœ€åä¸€ä¸ªæ–œçº¿åé¢çš„åç§°å‘½å,åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹,å¦‚æœæƒ³è¦æŒ‡å®šç‰¹å®šçš„åç§°,å¯ä»¥git clone [url] newnameæŒ‡å®š. git status æŸ¥è¯¢repoçš„çŠ¶æ€. git status -s: -sè¡¨ç¤ºshort, -sçš„è¾“å‡ºæ ‡è®°ä¼šæœ‰ä¸¤åˆ—,ç¬¬ä¸€åˆ—æ˜¯å¯¹stagingåŒºåŸŸè€Œè¨€,ç¬¬äºŒåˆ—æ˜¯å¯¹workingç›®å½•è€Œè¨€. git log show commit history of a branch. git log --oneline --number: æ¯æ¡logåªæ˜¾ç¤ºä¸€è¡Œ,æ˜¾ç¤ºnumberæ¡. git log --oneline --graph:å¯ä»¥å›¾å½¢åŒ–åœ°è¡¨ç¤ºå‡ºåˆ†æ”¯åˆå¹¶å†å². git log branchnameå¯ä»¥æ˜¾ç¤ºç‰¹å®šåˆ†æ”¯çš„log. git log --oneline branch1 ^branch2,å¯ä»¥æŸ¥çœ‹åœ¨åˆ†æ”¯1,å´ä¸åœ¨åˆ†æ”¯2ä¸­çš„æäº¤.^è¡¨ç¤ºæ’é™¤è¿™ä¸ªåˆ†æ”¯(Windowä¸‹å¯èƒ½è¦ç»™^branch2åŠ ä¸Šå¼•å·). git log --decorateä¼šæ˜¾ç¤ºå‡ºtagä¿¡æ¯. git log --author=[author name] å¯ä»¥æŒ‡å®šä½œè€…çš„æäº¤å†å². git log --since --before --until --after æ ¹æ®æäº¤æ—¶é—´ç­›é€‰log. --no-mergeså¯ä»¥å°†mergeçš„commitsæ’é™¤åœ¨å¤–. git log --grep æ ¹æ®commitä¿¡æ¯è¿‡æ»¤log: git log --grep=keywords é»˜è®¤æƒ…å†µä¸‹, git log --grep --authoræ˜¯ORçš„å…³ç³»,å³æ»¡è¶³ä¸€æ¡å³è¢«è¿”å›,å¦‚æœä½ æƒ³è®©å®ƒä»¬æ˜¯ANDçš„å…³ç³»,å¯ä»¥åŠ ä¸Š--all-matchçš„option. git log -S: filter by introduced diff. æ¯”å¦‚: git log -SmethodName (æ³¨æ„Så’Œåé¢çš„è¯ä¹‹é—´æ²¡æœ‰ç­‰å·åˆ†éš”). git log -p: show patch introduced at each commit. æ¯ä¸€ä¸ªæäº¤éƒ½æ˜¯ä¸€ä¸ªå¿«ç…§(snapshot),Gitä¼šæŠŠæ¯æ¬¡æäº¤çš„diffè®¡ç®—å‡ºæ¥,ä½œä¸ºä¸€ä¸ªpatchæ˜¾ç¤ºç»™ä½ çœ‹. å¦ä¸€ç§æ–¹æ³•æ˜¯git show [SHA]. git log --stat: show diffstat of changes introduced at each commit. åŒæ ·æ˜¯ç”¨æ¥çœ‹æ”¹åŠ¨çš„ç›¸å¯¹ä¿¡æ¯çš„,--statæ¯”-pçš„è¾“å‡ºæ›´ç®€å•ä¸€äº›. git add åœ¨æäº¤ä¹‹å‰,Gitæœ‰ä¸€ä¸ªæš‚å­˜åŒº(staging area),å¯ä»¥æ”¾å…¥æ–°æ·»åŠ çš„æ–‡ä»¶æˆ–è€…åŠ å…¥æ–°çš„æ”¹åŠ¨. commitæ—¶æäº¤çš„æ”¹åŠ¨æ˜¯ä¸Šä¸€æ¬¡åŠ å…¥åˆ°staging areaä¸­çš„æ”¹åŠ¨,è€Œä¸æ˜¯æˆ‘ä»¬diskä¸Šçš„æ”¹åŠ¨. git add . ä¼šé€’å½’åœ°æ·»åŠ å½“å‰å·¥ä½œç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶. git diff ä¸åŠ å‚æ•°çš„git diff: show diff of unstaged changes. æ­¤å‘½ä»¤æ¯”è¾ƒçš„æ˜¯å·¥ä½œç›®å½•ä¸­å½“å‰æ–‡ä»¶å’Œæš‚å­˜åŒºåŸŸå¿«ç…§ä¹‹é—´çš„å·®å¼‚,ä¹Ÿå°±æ˜¯ä¿®æ”¹ä¹‹åè¿˜æ²¡æœ‰æš‚å­˜èµ·æ¥çš„å˜åŒ–å†…å®¹. è‹¥è¦çœ‹å·²ç»æš‚å­˜èµ·æ¥çš„æ–‡ä»¶å’Œä¸Šæ¬¡æäº¤æ—¶çš„å¿«ç…§ä¹‹é—´çš„å·®å¼‚,å¯ä»¥ç”¨: git diff --cached å‘½ä»¤. show diff of staged changes. (Git 1.6.1 åŠæ›´é«˜ç‰ˆæœ¬è¿˜å…è®¸ä½¿ç”¨ git diff --stagedï¼Œæ•ˆæœæ˜¯ç›¸åŒçš„). git diff HEAD show diff of all staged or unstated changes. ä¹Ÿå³æ¯”è¾ƒwoking directoryå’Œä¸Šæ¬¡æäº¤ä¹‹é—´æ‰€æœ‰çš„æ”¹åŠ¨. å¦‚æœæƒ³çœ‹è‡ªä»æŸä¸ªç‰ˆæœ¬ä¹‹åéƒ½æ”¹åŠ¨äº†ä»€ä¹ˆ,å¯ä»¥ç”¨: git diff [version tag] è·Ÿlogå‘½ä»¤ä¸€æ ·,diffä¹Ÿå¯ä»¥åŠ ä¸Š--statå‚æ•°æ¥ç®€åŒ–è¾“å‡º. git diff [branchA] [branchB]å¯ä»¥ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªåˆ†æ”¯. å®ƒå®é™…ä¸Šä¼šè¿”å›ä¸€ä¸ªç”±Aåˆ°Bçš„patch,ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœ. ä¸€èˆ¬æˆ‘ä»¬æƒ³è¦çš„ç»“æœæ˜¯ä¸¤ä¸ªåˆ†æ”¯åˆ†å¼€ä»¥åå„è‡ªçš„æ”¹åŠ¨éƒ½æ˜¯ä»€ä¹ˆ,æ˜¯ç”±å‘½ä»¤: git diff [branchA]â€¦[branchB]ç»™å‡ºçš„. å®é™…ä¸Šå®ƒæ˜¯:git diff $(git merge-base [branchA] [branchB]) [branchB]çš„ç»“æœ. git commit æäº¤å·²ç»è¢«addè¿›æ¥çš„æ”¹åŠ¨. git commit -m â€œthe commit message&quot; git commit -a ä¼šå…ˆæŠŠæ‰€æœ‰å·²ç»trackçš„æ–‡ä»¶çš„æ”¹åŠ¨addè¿›æ¥,ç„¶åæäº¤(æœ‰ç‚¹åƒsvnçš„ä¸€æ¬¡æäº¤,ä¸ç”¨å…ˆæš‚å­˜). å¯¹äºæ²¡æœ‰trackçš„æ–‡ä»¶,è¿˜æ˜¯éœ€è¦git addä¸€ä¸‹. git commit --amend å¢è¡¥æäº¤. ä¼šä½¿ç”¨ä¸å½“å‰æäº¤èŠ‚ç‚¹ç›¸åŒçš„çˆ¶èŠ‚ç‚¹è¿›è¡Œä¸€æ¬¡æ–°çš„æäº¤,æ—§çš„æäº¤å°†ä¼šè¢«å–æ¶ˆ. git reset undo changes and commits. è¿™é‡Œçš„HEADå…³é”®å­—æŒ‡çš„æ˜¯å½“å‰åˆ†æ”¯æœ€æœ«æ¢¢æœ€æ–°çš„ä¸€ä¸ªæäº¤.ä¹Ÿå°±æ˜¯ç‰ˆæœ¬åº“ä¸­è¯¥åˆ†æ”¯ä¸Šçš„æœ€æ–°ç‰ˆæœ¬. git reset HEAD: unstage files from index and reset pointer to HEAD è¿™ä¸ªå‘½ä»¤ç”¨æ¥æŠŠä¸å°å¿ƒaddè¿›å»çš„æ–‡ä»¶ä»stagedçŠ¶æ€å–å‡ºæ¥,å¯ä»¥å•ç‹¬é’ˆå¯¹æŸä¸€ä¸ªæ–‡ä»¶æ“ä½œ: git reset HEAD -- filename, è¿™ä¸ª- - ä¹Ÿå¯ä»¥ä¸åŠ . git reset --soft move HEAD to specific commit reference, index and staging are untouched. git reset --hard unstage files AND undo any changes in the working directory since last commit. ä½¿ç”¨git reset â€”hard HEADè¿›è¡Œreset,å³ä¸Šæ¬¡æäº¤ä¹‹å,æ‰€æœ‰stagedçš„æ”¹åŠ¨å’Œå·¥ä½œç›®å½•çš„æ”¹åŠ¨éƒ½ä¼šæ¶ˆå¤±,è¿˜åŸåˆ°ä¸Šæ¬¡æäº¤çš„çŠ¶æ€. è¿™é‡Œçš„HEADå¯ä»¥è¢«å†™æˆä»»ä½•ä¸€æ¬¡æäº¤çš„SHA-1. ä¸å¸¦softå’Œhardå‚æ•°çš„git reset,å®é™…ä¸Šå¸¦çš„æ˜¯é»˜è®¤å‚æ•°mixed. æ€»ç»“: git reset --mixed id,æ˜¯å°†gitçš„HEADå˜äº†(ä¹Ÿå°±æ˜¯æäº¤è®°å½•å˜äº†),ä½†æ–‡ä»¶å¹¶æ²¡æœ‰æ”¹å˜ï¼Œ(ä¹Ÿå°±æ˜¯working treeå¹¶æ²¡æœ‰æ”¹å˜). å–æ¶ˆäº†commitå’Œaddçš„å†…å®¹. git reset --soft id. å®é™…ä¸Šï¼Œæ˜¯git reset â€“mixed id å,åˆåšäº†ä¸€æ¬¡git add.å³å–æ¶ˆäº†commitçš„å†…å®¹. git reset --hard id.æ˜¯å°†gitçš„HEADå˜äº†,æ–‡ä»¶ä¹Ÿå˜äº†. æŒ‰æ”¹åŠ¨èŒƒå›´æ’åºå¦‚ä¸‹: soft (commit) &lt; mixed (commit + add) &lt; hard (commit + add + local working) git revert åè½¬æ’¤é”€æäº¤.åªè¦æŠŠå‡ºé”™çš„æäº¤(commit)çš„åå­—(reference)ä½œä¸ºå‚æ•°ä¼ ç»™å‘½ä»¤å°±å¯ä»¥äº†. git revert HEAD: æ’¤é”€æœ€è¿‘çš„ä¸€ä¸ªæäº¤. git revertä¼šåˆ›å»ºä¸€ä¸ªåå‘çš„æ–°æäº¤,å¯ä»¥é€šè¿‡å‚æ•°-næ¥å‘Šè¯‰Gitå…ˆä¸è¦æäº¤. git rm git rm file: ä»stagingåŒºç§»é™¤æ–‡ä»¶,åŒæ—¶ä¹Ÿç§»é™¤å‡ºå·¥ä½œç›®å½•. git rm --cached: ä»stagingåŒºç§»é™¤æ–‡ä»¶,ä½†ç•™åœ¨å·¥ä½œç›®å½•ä¸­. git rm --cachedä»åŠŸèƒ½ä¸Šç­‰åŒäºgit reset HEAD,æ¸…é™¤äº†ç¼“å­˜åŒº,ä½†ä¸åŠ¨å·¥ä½œç›®å½•æ ‘. git clean git cleanæ˜¯ä»å·¥ä½œç›®å½•ä¸­ç§»é™¤æ²¡æœ‰trackçš„æ–‡ä»¶. é€šå¸¸çš„å‚æ•°æ˜¯git clean -df: -dè¡¨ç¤ºåŒæ—¶ç§»é™¤ç›®å½•,-fè¡¨ç¤ºforce,å› ä¸ºåœ¨gitçš„é…ç½®æ–‡ä»¶ä¸­, clean.requireForce=true,å¦‚æœä¸åŠ -f,cleanå°†ä¼šæ‹’ç»æ‰§è¡Œ. git mv git rm - - cached orig; mv orig new; git add new git stash æŠŠå½“å‰çš„æ”¹åŠ¨å‹å…¥ä¸€ä¸ªæ ˆ. git stashå°†ä¼šæŠŠå½“å‰ç›®å½•å’Œindexä¸­çš„æ‰€æœ‰æ”¹åŠ¨(ä½†ä¸åŒ…æ‹¬æœªtrackçš„æ–‡ä»¶)å‹å…¥ä¸€ä¸ªæ ˆ,ç„¶åç•™ç»™ä½ ä¸€ä¸ªcleançš„å·¥ä½œçŠ¶æ€,å³å¤„äºä¸Šä¸€æ¬¡æœ€æ–°æäº¤å¤„. git stash listä¼šæ˜¾ç¤ºè¿™ä¸ªæ ˆçš„list. git stash apply:å–å‡ºstashä¸­çš„ä¸Šä¸€ä¸ªé¡¹ç›®(stash@&#123;0&#125;),å¹¶ä¸”åº”ç”¨äºå½“å‰çš„å·¥ä½œç›®å½•. ä¹Ÿå¯ä»¥æŒ‡å®šåˆ«çš„é¡¹ç›®,æ¯”å¦‚git stash apply stash@&#123;1&#125;. å¦‚æœä½ åœ¨åº”ç”¨stashä¸­é¡¹ç›®çš„åŒæ—¶æƒ³è¦åˆ é™¤å®ƒ,å¯ä»¥ç”¨git stash pop åˆ é™¤stashä¸­çš„é¡¹ç›®: git stash drop: åˆ é™¤ä¸Šä¸€ä¸ª,ä¹Ÿå¯æŒ‡å®šå‚æ•°åˆ é™¤æŒ‡å®šçš„ä¸€ä¸ªé¡¹ç›®. git stash clear: åˆ é™¤æ‰€æœ‰é¡¹ç›®.","categories":[{"name":"git","slug":"git","permalink":"https://marblemm.github.io/categories/git/"}],"tags":[]},{"title":"gitå‘½ä»¤æ•´ç†-é…ç½®","slug":"gitå‘½ä»¤æ•´ç†-é…ç½®","date":"2021-08-08T02:49:54.000Z","updated":"2021-08-09T15:26:03.785Z","comments":true,"path":"2021/08/08/gitå‘½ä»¤æ•´ç†-é…ç½®/","link":"","permalink":"https://marblemm.github.io/2021/08/08/git%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86-%E9%85%8D%E7%BD%AE/","excerpt":"","text":"git config æŸ¥çœ‹é…ç½®ä¿¡æ¯123456789101112131415161. æŸ¥çœ‹gité…ç½®ä¿¡æ¯ï¼Œåˆ—è¡¨ä¸­å¯ä»¥æŸ¥çœ‹gitçš„è®¾ç½®é€‰é¡¹$ git config --list 2.æŸ¥çœ‹gitç”¨æˆ·åã€å¯†ç ã€é‚®ç®±çš„é…ç½®$ git config user.name$ git config user.email3.è®¾ç½®gitç”¨æˆ·åã€å¯†ç ã€é‚®ç®±çš„é…ç½®$ git config user.name &quot;freedom&quot;$ git config user.password &quot;123456&quot;$ git config user.email &quot;1548429568@qq.com&quot;è®¾ç½®å…¨å±€æ¨¡å¼ï¼ˆæ¨èï¼‰git config --global user.name [username]git config --global user.email [email] è®¾ç½®è®°ä½å¯†ç ï¼ˆé»˜è®¤15åˆ†é’Ÿï¼‰12345678git config --global credential.helper cacheå¦‚æœæƒ³è‡ªå·±è®¾ç½®æ—¶é—´ï¼Œå¯ä»¥è¿™æ ·åšï¼šgit config credential.helper &#x27;cache --timeout=3600&#x27;è¿™æ ·å°±è®¾ç½®ä¸€ä¸ªå°æ—¶ä¹‹åå¤±æ•ˆé•¿æœŸå­˜å‚¨å¯†ç ï¼šgit config --global credential.helper store gitå¿½ç•¥é¡¹gitegnoreé…ç½®åœ¨gitä¸­å¦‚æœæƒ³å¿½ç•¥æ‰æŸä¸ªæ–‡ä»¶ï¼Œ ä¸è®©è¿™ä¸ªæ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬åº“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¿®æ”¹ .gitignore æ–‡ä»¶çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–‡ä»¶æ¯ä¸€è¡Œä¿å­˜äº†ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™ ä¾‹å¦‚ 12345678# æ­¤ä¸ºæ³¨é‡Š â€“ å°†è¢« Git å¿½ç•¥*.a # å¿½ç•¥æ‰€æœ‰ .a ç»“å°¾çš„æ–‡ä»¶!lib.a # ä½† lib.a é™¤å¤–/TODO # ä»…ä»…å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ TODO æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ subdir/TODObuild/ # å¿½ç•¥ build/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶doc/*.txt # ä¼šå¿½ç•¥ doc/notes.txt ä½†ä¸åŒ…æ‹¬ doc/server/arch.txt å¦å¤– git æä¾›äº†ä¸€ä¸ªå…¨å±€çš„ .gitignoreä½ å¯ä»¥åœ¨ä½ çš„ç”¨æˆ·ç›®å½•ä¸‹åˆ›å»º ~/.gitignoreglobal æ–‡ä»¶ï¼Œä»¥åŒæ ·çš„è§„åˆ™æ¥åˆ’å®šå“ªäº›æ–‡ä»¶æ˜¯ä¸éœ€è¦ç‰ˆæœ¬æ§åˆ¶çš„ã€‚éœ€è¦æ‰§è¡Œgit config â€“global core.excludesfile ~/.gitignoreglobalæ¥ä½¿å¾—å®ƒç”Ÿæ•ˆã€‚ å¦å¤– git è¿˜æä¾›äº†å¦ä¸€ç§ exclude çš„æ–¹å¼æ¥åšåŒæ ·çš„äº‹æƒ…ï¼Œä¸åŒçš„æ˜¯ .gitignore è¿™ä¸ªæ–‡ä»¶æœ¬èº«ä¼šæäº¤åˆ°ç‰ˆæœ¬åº“ä¸­å»ã€‚ç”¨æ¥ä¿å­˜çš„æ˜¯å…¬å…±çš„éœ€è¦æ’é™¤çš„æ–‡ä»¶ã€‚è€Œ .git/info/exclude è¿™é‡Œè®¾ç½®çš„ åˆ™æ˜¯ä½ è‡ªå·±æœ¬åœ°éœ€è¦æ’é™¤çš„æ–‡ä»¶ã€‚ ä»–ä¸ä¼šå½±å“åˆ°å…¶ä»–äººã€‚ä¹Ÿä¸ä¼šæäº¤åˆ°ç‰ˆæœ¬åº“ä¸­å»ã€‚ ä½†æ˜¯æœ‰æ—¶å€™åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œçªç„¶å¿ƒè¡€æ¥æ½®æƒ³æŠŠæŸäº›ç›®å½•æˆ–æ–‡ä»¶åŠ å…¥å¿½ç•¥è§„åˆ™ï¼ŒæŒ‰ç…§ä¸Šè¿°æ–¹æ³•å®šä¹‰åå‘ç°å¹¶æœªç”Ÿæ•ˆï¼ŒåŸå› æ˜¯.gitignoreåªèƒ½å¿½ç•¥é‚£äº›åŸæ¥æ²¡æœ‰è¢«trackçš„æ–‡ä»¶ï¼Œå¦‚æœæŸäº›æ–‡ä»¶å·²ç»è¢«çº³å…¥äº†ç‰ˆæœ¬ç®¡ç†ä¸­ï¼Œåˆ™ä¿®æ”¹.gitignoreæ˜¯æ— æ•ˆçš„ã€‚é‚£ä¹ˆè§£å†³æ–¹æ³•å°±æ˜¯å…ˆæŠŠæœ¬åœ°ç¼“å­˜åˆ é™¤ï¼ˆæ”¹å˜æˆæœªtrackçŠ¶æ€ï¼‰ï¼Œç„¶åå†æäº¤,æ‰€ä»¥é¡¹ç›®åˆ›å»ºçš„æ—¶å€™å°±æŠŠignoreæ–‡ä»¶åŠ ä¸Šï¼Œå¦‚æœæ²¡åŠ ä¸Šï¼Œæ­¤æ—¶ä¹Ÿå¯ä»¥æŠŠè¦å¿½ç•¥çš„æ–‡ä»¶å…ˆåˆ é™¤ï¼Œç„¶åæŠŠignoreåŠ ä¸Šè¦å¿½ç•¥çš„æ–‡ä»¶ï¼Œæäº¤åˆ°æœåŠ¡å™¨ï¼Œæ­¤åå†æäº¤æ—¶ï¼Œè¦å¿½ç•¥çš„æ–‡ä»¶å°±ä¸ä¼šæäº¤ä¸Šå»äº†","categories":[{"name":"git","slug":"git","permalink":"https://marblemm.github.io/categories/git/"}],"tags":[]},{"title":"ä»æ–°ç”µè„‘æ ¹æ®hexoéƒ¨ç½²åˆ°github","slug":"ä»æ–°ç”µè„‘æ ¹æ®hexoéƒ¨ç½²åˆ°github","date":"2021-08-04T14:07:48.000Z","updated":"2021-08-09T15:19:26.007Z","comments":true,"path":"2021/08/04/ä»æ–°ç”µè„‘æ ¹æ®hexoéƒ¨ç½²åˆ°github/","link":"","permalink":"https://marblemm.github.io/2021/08/04/%E4%BB%8E%E6%96%B0%E7%94%B5%E8%84%91%E6%A0%B9%E6%8D%AEhexo%E9%83%A8%E7%BD%B2%E5%88%B0github/","excerpt":"","text":"marblemm.github.ioä¸ªäººåšå®¢ http://marblemm.github.io hexoéƒ¨ç½²è¯´æ˜å‡†å¤‡ç¯å¢ƒ1ã€å®‰è£…git 2ã€è®¾ç½®ssh keygithubè®¾ç½®æ·»åŠ SSH 3ã€å®‰è£…nodejs â€”â€”-windowsï¼šnodejsé€‰æ‹©LTSç‰ˆæœ¬å°±è¡Œäº†ã€‚ éªŒè¯ç¯å¢ƒæ‰“å¼€cmdçª—å£ï¼Œè¾“å…¥å‘½ä»¤ 123git --versionnode -vnpm -v å¦‚æœå‡ºç°ï¼Œç±»ä¼¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯´æ˜ç¯å¢ƒæ­£ç¡® 4ã€ å®‰è£…hexoå‰é¢gitå’Œnodejså®‰è£…å¥½åï¼Œå°±å¯ä»¥å®‰è£…hexoäº†ï¼Œä½ å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹blogï¼Œç„¶åcdåˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼ˆæˆ–è€…åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ç›´æ¥å³é”®git bashæ‰“å¼€ï¼‰ã€‚è¾“å…¥å‘½ä»¤ 12npm install -g cnpm --registry=https://registry.npm.taobao.org #ä½¿ç”¨æ·˜å®é•œåƒï¼Œå›½å†…é€Ÿåº¦ä¼šæ¯”è¾ƒå¿«npm install hexo-cli -g #å®‰è£…hexo ç„¶åç”¨hexo -væŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬ï¼Œè‡³æ­¤å°±å…¨éƒ¨å®‰è£…å®Œäº†ã€‚ æœ¬åœ°å‘å¸ƒ123hexo g #ç”Ÿæˆé™æ€ä¸»é¡µhexo s #å¯åŠ¨æœåŠ¡hexo d #éƒ¨ç½²é™æ€é¡µé¢æ¨é€åˆ°GitHubä»“åº“","categories":[{"name":"git","slug":"git","permalink":"https://marblemm.github.io/categories/git/"}],"tags":[]},{"title":"c++ å¼€æºé¡¹ç›®-å…¥é—¨","slug":"cppå¼€æºé¡¹ç›®-å…¥é—¨","date":"2021-08-04T13:16:23.537Z","updated":"2021-08-27T14:43:43.727Z","comments":true,"path":"2021/08/04/cppå¼€æºé¡¹ç›®-å…¥é—¨/","link":"","permalink":"https://marblemm.github.io/2021/08/04/cpp%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E5%85%A5%E9%97%A8/","excerpt":"","text":"CPlusPlusThingsCPlusPlusThings æ˜¯å›½äººå¼€æºä¸€ä¸ª C++ å­¦ä¹ é¡¹ç›®ã€‚å®ƒç³»ç»Ÿåœ°å°† C++ å­¦ä¹ åˆ†ä¸ºäº†ã€åŸºç¡€è¿›é˜¶ã€‘ã€ã€å®æˆ˜ç³»åˆ—ã€‘ã€ã€C++2.0 æ–°ç‰¹æ€§ã€‘ã€ã€è®¾è®¡æ¨¡å¼ã€‘å’Œã€STL æºç å‰–æã€‘ã€ã€å¹¶å‘ç¼–ç¨‹ã€‘ã€ã€C++ æƒ¯ç”¨æ³•ã€‘ã€ã€å­¦ä¹ è¯¾ç¨‹ã€‘ã€ã€å·¥å…·ã€‘ã€ã€æ‹“å±•ã€‘ã€‚ ä½œä¸ºä¸€ä¸ªå…¨é¢ç³»ç»Ÿçš„ C++ å­¦ä¹ é¡¹ç›®ï¼ŒCPlusPlusThings æ˜¯ä¼˜ç§€çš„ï¼Œå®ƒåˆç†åœ°å®‰æ’äº† 10 Days çš„å®æˆ˜éƒ¨åˆ†ï¼Œåœ¨å®æˆ˜ä¸­äº†è§£è¯­æ³•å’Œå‡½æ•°ç”¨æ³•ï¼Œå”¯ä¸€ä¸è¶³çš„æ˜¯ï¼Œåœ¨æ³¨é‡Šéƒ¨åˆ†æœ‰äº›ä¸å°½äººæ„ï¼Œå¯¹éƒ¨åˆ†æ–°æ‰‹ç¨‹åºå‘˜å¹¶ä¸æ˜¯å¾ˆå‹å¥½GitHub åœ°å€ MyTinySTLå½“ä½ å­¦ä¹ å®Œ C++ çš„â€œä¹¦æœ¬â€çŸ¥è¯†åï¼Œæ˜¯ä¸æ˜¯æœ‰äº›æ‰‹ç—’äº†å‘¢ï¼ŸMyTinySTL è¿™ä¸ªæ³¨é‡Šè¯¦ç»†ã€å®è·µå¤¯å®åŸºç¡€çš„é¡¹ç›®ä¾¿æ˜¯ä½  C++ å­¦ä¹ ä¹‹æ—…çš„ä¸‹ä¸€ç«™ã€‚ä½œä¸ºæ–°æ‰‹ç»ƒä¹ ç”¨é€”ï¼ŒMyTinySTL çš„ä½œè€… Alinshans ç”¨ C++11 é‡æ–°å¤å†™äº†ä¸€ä¸ªå°å‹ STLï¼ˆå®¹å™¨åº“ï¼‹ç®—æ³•åº“ï¼‰ã€‚ä»£ç ç»“æ„æ¸…æ™°è§„èŒƒã€åŒ…å«ä¸­æ–‡æ–‡æ¡£ä¸æ³¨é‡Šï¼Œå¹¶ä¸”è‡ªå¸¦ä¸€ä¸ªç®€å•çš„æµ‹è¯•æ¡†æ¶ï¼Œé€‚åˆ C++ æ–°æ‰‹æ¥å®è·µä¸€ç•ªã€‚GitHub åœ°å€ calculatorå¾®è½¯å¼€æºçš„ Windows ç³»ç»Ÿé¢„è£…çš„è®¡ç®—å™¨å·¥å…·ã€‚è¯¥å·¥å…·æä¾›æ ‡å‡†ã€ç§‘å­¦ã€ç¨‹åºå‘˜è®¡ç®—å™¨çš„åŠŸèƒ½ï¼Œä»¥åŠå„ç§åº¦é‡å•ä½å’Œè´§å¸ä¹‹é—´çš„è½¬æ¢åŠŸèƒ½ã€‚å¿«æ¥çœ‹çœ‹å¾®è½¯å·¥ç¨‹å¸ˆç¼–å†™çš„ä»£ç å§ï¼å­¦ä¹ å¤§å‚çš„ç¼–ç è§„èŒƒã€é¡¹ç›®ç»“æ„ä¹‹ç±»çš„ï¼Œæé«˜é˜…è¯»æºç çš„èƒ½åŠ›ã€‚è‹±æ–‡çš„é¡¹ç›®ä¸”æ²¡æœ‰è®²è§£éƒ¨åˆ†ï¼Œéœ€è¦é€šè¿‡é˜…è¯»æºç å­¦ä¹ ï¼Œéš¾åº¦è¾ƒé«˜ã€‚GitHub åœ°å€ TinytetrisTinytetris æ˜¯ä¸€ä¸ªç”¨ C++ ç¼–å†™çš„ç»ˆç«¯ç‰ˆä¿„ç½—æ–¯æ–¹å—æ¸¸æˆã€‚å®ƒæä¾›äº†ä¸¤ä¸ªç‰ˆæœ¬çš„æºç ï¼Œåˆ†ä¸ºæ³¨é‡Šç‰ˆå’Œåº“ç‰ˆï¼Œæ³¨é‡Šè¾ƒå¤šæ˜“äºç†è§£å’Œå­¦ä¹ ã€‚GitHub åœ°å€ Googleå¼€æºä»£ç è§„èŒƒGitHub åœ°å€ ç°ä»£ C++ï¼šmodern-cpp-tutorialmodern-cpp-tutorial æ˜¯ç°ä»£ C++ æ•™ç¨‹ï¼Œå®ƒçš„ç›®çš„æ˜¯æä¾›å…³äºç°ä»£ C++ï¼ˆ2020 å¹´å‰ï¼‰çš„ç›¸å…³ç‰¹æ€§çš„å…¨é¢ä»‹ç»ã€‚é™¤äº†ä»‹ç»äº†ä»£ç ä¹‹å¤–ï¼Œå®ƒè¿˜å°½å¯èƒ½ç®€å•åœ°ä»‹ç»äº†å…¶æŠ€æœ¯éœ€æ±‚çš„å†å²èƒŒæ™¯ï¼Œè¿™å¯¹ç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™äº›ç‰¹æ€§æä¾›äº†å¾ˆå¤§çš„å¸®åŠ©ã€‚ GitHub åœ°å€","categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"}],"tags":[]}],"categories":[{"name":"c++","slug":"c","permalink":"https://marblemm.github.io/categories/c/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://marblemm.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"},{"name":"c++é¢è¯•","slug":"c-é¢è¯•","permalink":"https://marblemm.github.io/categories/c-%E9%9D%A2%E8%AF%95/"},{"name":"ä¹¦ç±","slug":"ä¹¦ç±","permalink":"https://marblemm.github.io/categories/%E4%B9%A6%E7%B1%8D/"},{"name":"git","slug":"git","permalink":"https://marblemm.github.io/categories/git/"}],"tags":[]}